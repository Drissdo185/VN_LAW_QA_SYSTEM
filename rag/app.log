[2025-03-09 09:58:02,622] INFO [__main__] Starting application
[2025-03-09 09:58:02,625] INFO [__main__] Initializing configurations
[2025-03-09 09:58:02,625] INFO [__main__] Configurations initialized successfully
[2025-03-09 09:58:02,626] INFO [__main__] Selected LLM provider: openai
[2025-03-09 09:58:02,626] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 09:58:02,626] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 09:58:02,626] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 09:58:02,626] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 09:58:03,269] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 09:58:03,520] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 09:58:03,524] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 09:58:03,525] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 09:58:03,525] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 09:58:03,527] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 09:58:05,138] INFO [__main__] Starting application
[2025-03-09 09:58:05,139] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 09:58:05,140] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 09:58:05,140] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 09:58:05,140] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 09:58:05,140] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 09:58:05,723] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 09:58:06,029] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 09:58:06,030] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 09:58:06,030] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 09:58:06,030] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 09:58:06,032] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 09:58:09,532] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 09:58:09,922] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 09:58:10,436] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 09:58:10,437] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 09:58:11,158] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 09:58:11,648] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 09:58:11,653] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 09:58:11,653] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 09:58:12,811] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 09:58:12,811] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 09:58:12,811] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 09:58:13,005] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 09:58:13,005] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 09:58:13,005] INFO [__main__] Initializing web search integration
[2025-03-09 09:58:13,005] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 09:58:13,005] INFO [__main__] Components initialized successfully
[2025-03-09 09:58:14,338] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 09:58:14,339] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 09:58:14,339] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 09:58:14,339] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 09:58:14,377] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 09:58:14,377] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 09:58:14,377] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 09:58:14,377] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 09:58:14,377] INFO [__main__] Initializing web search integration
[2025-03-09 09:58:14,377] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 09:58:14,377] INFO [__main__] Components initialized successfully
[2025-03-09 09:58:17,598] INFO [__main__] Starting application
[2025-03-09 09:58:17,604] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 09:58:17,607] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 09:58:17,609] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 09:58:17,609] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 09:58:17,610] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 09:58:17,708] INFO [__main__] Starting application
[2025-03-09 09:58:17,710] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 09:58:17,710] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 09:58:17,710] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 09:58:17,710] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 09:58:17,711] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 09:58:18,097] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 09:58:18,320] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 09:58:18,334] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 09:58:18,339] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 09:58:18,340] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 09:58:18,341] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 09:58:18,345] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 09:58:18,575] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 09:58:18,580] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 09:58:18,580] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 09:58:18,581] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 09:58:18,584] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 09:58:23,316] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 09:58:23,549] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 09:58:23,559] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 09:58:23,560] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 09:58:24,984] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 09:58:25,778] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 09:58:25,780] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 09:58:25,780] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 09:58:25,781] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 09:58:25,781] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 09:58:25,781] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 09:58:25,781] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 09:58:25,853] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 09:58:25,853] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 09:58:25,854] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 09:58:25,854] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 09:58:25,854] INFO [__main__] Initializing web search integration
[2025-03-09 09:58:25,854] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 09:58:25,854] INFO [__main__] Components initialized successfully
[2025-03-09 09:58:28,127] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 09:58:28,127] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 09:58:28,127] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 09:58:28,128] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 09:58:28,184] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 09:58:28,184] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 09:58:28,184] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 09:58:28,184] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 09:58:28,184] INFO [__main__] Initializing web search integration
[2025-03-09 09:58:28,184] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 09:58:28,184] INFO [__main__] Components initialized successfully
[2025-03-09 09:58:28,185] INFO [__main__] Processing new question: Vào 1 ngày đẹp trời chủ nhất, bạn Đạt đi uống 1 thùng bia và lái xe máy SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?
[2025-03-09 09:58:28,185] INFO [__main__] Processing question: Vào 1 ngày đẹp trời chủ nhất, bạn Đạt đi uống 1 thùng bia và lái xe máy SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?
[2025-03-09 09:58:28,185] INFO [reasoning.auto_rag] Question validated as traffic-related via keyword: phạt
[2025-03-09 09:58:28,185] INFO [reasoning.auto_rag] Iteration 1: Retrieving documents for query: Vào 1 ngày đẹp trời chủ nhất, bạn Đạt đi uống 1 thùng bia và lái xe máy SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?
[2025-03-09 09:58:28,187] INFO [reasoning.auto_rag] Tokenized query: vào 1 ngày đẹp trời chủ nhất , bạn đạt đi uống 1 thùng bia và lái xe_máy sh 350i của ý không mang theo giấy_tờ thì bị phạt như thế_nào ?
[2025-03-09 09:58:28,187] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 09:58:28,187] INFO [retrieval.retriever] Original query: 'Vào 1 ngày đẹp trời chủ nhất, bạn Đạt đi uống 1 thùng bia và lái xe máy SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?'
[2025-03-09 09:58:28,187] INFO [retrieval.retriever] Tokenized query: 'vào 1 ngày đẹp trời chủ nhất , bạn đạt đi uống 1 thùng bia và lái xe_máy sh 350i của ý không mang theo giấy_tờ thì bị phạt như thế_nào ?'
[2025-03-09 09:58:29,132] INFO [retrieval.retriever] Retrieved 5 documents for query
[2025-03-09 09:58:29,132] INFO [retrieval.retriever] Top result score: 0.6497311592102051
[2025-03-09 09:58:29,133] INFO [retrieval.retriever] Score range: 0.5 to 0.6497311592102051
[2025-03-09 09:58:29,133] INFO [reasoning.auto_rag] DocumentRetriever returned 5 documents
[2025-03-09 09:58:29,133] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 09:58:29,134] INFO [reasoning.auto_rag] Doc 1 score: 0.6497311592102051
[2025-03-09 09:58:29,134] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 400.000 đồng đến 600.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 400.000 đồng đến 600.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo chứng nhận bảo hiểm bắt buộc trách nhiệm dân sự của chủ xe cơ giới còn hiệu lực'}
[2025-03-09 09:58:29,134] INFO [reasoning.auto_rag] Doc 2 score: 0.6274877786636353
[2025-03-09 09:58:29,134] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo giấy chứng nhận kiểm định an toàn kỹ thuật và bảo vệ môi trường'}
[2025-03-09 09:58:29,134] INFO [reasoning.auto_rag] Doc 3 score: 0.5641801357269287
[2025-03-09 09:58:29,135] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo chứng nhận đăng ký xe'}
[2025-03-09 09:58:29,135] INFO [reasoning.auto_rag] Context length: 997 characters
[2025-03-09 09:58:29,139] INFO [reasoning.auto_rag] Input tokens: 901
[2025-03-09 09:58:34,702] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 09:58:34,708] INFO [reasoning.auto_rag] Output tokens: 753
[2025-03-09 09:58:34,708] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 09:58:34,709] INFO [reasoning.auto_rag] Need more information, next query: Tìm hiểu mức phạt khi lái xe máy SH 350i không mang theo giấy tờ và mức phạt khi lái xe sau khi uống bia
[2025-03-09 09:58:34,709] INFO [reasoning.auto_rag] Iteration 2: Retrieving documents for query: Tìm hiểu mức phạt khi lái xe máy SH 350i không mang theo giấy tờ và mức phạt khi lái xe sau khi uống bia
[2025-03-09 09:58:34,710] INFO [reasoning.auto_rag] Tokenized query: tìm_hiểu mức phạt khi lái xe_máy sh 350i không mang theo giấy_tờ và mức phạt khi lái_xe sau khi uống bia
[2025-03-09 09:58:34,710] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 09:58:34,711] INFO [retrieval.retriever] Original query: 'Tìm hiểu mức phạt khi lái xe máy SH 350i không mang theo giấy tờ và mức phạt khi lái xe sau khi uống bia'
[2025-03-09 09:58:34,711] INFO [retrieval.retriever] Tokenized query: 'tìm_hiểu mức phạt khi lái xe_máy sh 350i không mang theo giấy_tờ và mức phạt khi lái_xe sau khi uống bia'
[2025-03-09 09:58:35,343] INFO [retrieval.retriever] Retrieved 5 documents for query
[2025-03-09 09:58:35,343] INFO [retrieval.retriever] Top result score: 0.9273756742477417
[2025-03-09 09:58:35,344] INFO [retrieval.retriever] Score range: 0.5 to 0.9273756742477417
[2025-03-09 09:58:35,344] INFO [reasoning.auto_rag] DocumentRetriever returned 5 documents
[2025-03-09 09:58:35,344] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 09:58:35,344] INFO [reasoning.auto_rag] Doc 1 score: 0.9273756742477417
[2025-03-09 09:58:35,345] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo giấy chứng nhận kiểm định an toàn kỹ thuật và bảo vệ môi trường'}
[2025-03-09 09:58:35,345] INFO [reasoning.auto_rag] Doc 2 score: 0.9089117050170898
[2025-03-09 09:58:35,345] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo chứng nhận đăng ký xe'}
[2025-03-09 09:58:35,345] INFO [reasoning.auto_rag] Doc 3 score: 0.8001713752746582
[2025-03-09 09:58:35,346] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo giấy phép lái xe'}
[2025-03-09 09:58:35,346] INFO [reasoning.auto_rag] Context length: 1997 characters
[2025-03-09 09:58:35,349] INFO [reasoning.auto_rag] Input tokens: 1394
[2025-03-09 09:58:40,948] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 09:58:40,951] INFO [reasoning.auto_rag] Output tokens: 785
[2025-03-09 09:58:40,952] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 09:58:40,952] INFO [reasoning.auto_rag] Need more information, next query: Tìm hiểu về mức phạt khi lái xe máy mà không mang theo giấy tờ
[2025-03-09 09:58:40,953] WARNING [reasoning.auto_rag] Exiting loop without sufficient information
[2025-03-09 09:58:40,954] INFO [utils] Function process_question completed in 12.77 seconds
[2025-03-09 09:58:40,955] INFO [__main__] Question processed in 12.77 seconds
[2025-03-09 09:58:40,957] INFO [__main__] Needs web search: True
[2025-03-09 09:58:40,957] INFO [__main__] Web search prompt triggered
[2025-03-09 09:58:40,958] INFO [__main__] Displaying results
[2025-03-09 09:58:40,960] INFO [__main__] Response generated using: Qwen2.5-14B (vLLM)
[2025-03-09 09:58:40,974] INFO [__main__] Cleaning up components
[2025-03-09 09:58:40,975] INFO [retrieval.vector_store] Closing Weaviate client connection
[2025-03-09 09:58:40,987] INFO [retrieval.vector_store] Weaviate client connection closed
[2025-03-09 09:58:40,989] INFO [__main__] Displaying web search prompt
[2025-03-09 10:02:52,136] INFO [__main__] Starting application
[2025-03-09 10:02:52,138] INFO [__main__] Initializing configurations
[2025-03-09 10:02:52,138] INFO [__main__] Configurations initialized successfully
[2025-03-09 10:02:52,139] INFO [__main__] Selected LLM provider: openai
[2025-03-09 10:02:52,139] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 10:02:52,139] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:02:52,139] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:02:52,139] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:02:52,523] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:02:52,718] INFO [__main__] Starting application
[2025-03-09 10:02:52,719] INFO [__main__] Selected LLM provider: openai
[2025-03-09 10:02:52,720] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 10:02:52,720] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:02:52,720] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:02:52,720] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:02:52,773] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:02:52,775] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:02:52,776] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:02:52,776] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:02:52,778] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:02:53,287] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:02:53,575] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:02:53,579] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:02:53,579] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:02:53,580] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:02:53,583] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:02:58,696] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:02:59,272] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:02:59,421] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:02:59,421] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:02:59,895] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:03:00,397] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:03:00,402] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:03:00,402] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:03:01,377] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:03:01,377] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:03:01,377] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 10:03:01,531] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 10:03:01,531] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:03:01,531] INFO [__main__] Initializing web search integration
[2025-03-09 10:03:01,532] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:03:01,532] INFO [__main__] Components initialized successfully
[2025-03-09 10:03:02,783] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:03:02,783] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:03:02,783] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 10:03:02,783] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 10:03:02,783] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:03:02,783] INFO [__main__] Initializing web search integration
[2025-03-09 10:03:02,784] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:03:02,784] INFO [__main__] Components initialized successfully
[2025-03-09 10:03:32,582] INFO [__main__] Starting application
[2025-03-09 10:03:32,586] INFO [__main__] Selected LLM provider: openai
[2025-03-09 10:03:32,587] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 10:03:32,588] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:03:32,589] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:03:32,590] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:03:32,696] INFO [__main__] Starting application
[2025-03-09 10:03:32,698] INFO [__main__] Selected LLM provider: openai
[2025-03-09 10:03:32,698] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 10:03:32,699] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:03:32,699] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:03:32,700] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:03:33,400] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:03:33,445] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:03:33,712] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:03:33,715] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:03:33,717] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:03:33,717] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:03:33,717] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:03:33,717] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:03:33,717] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:03:33,718] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:03:33,725] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:03:33,726] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:03:38,331] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:03:38,569] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:03:38,576] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:03:38,576] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:03:38,628] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:03:38,848] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:03:38,853] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:03:38,853] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:03:40,617] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:03:40,617] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:03:40,617] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 10:03:40,618] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 10:03:40,618] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:03:40,618] INFO [__main__] Initializing web search integration
[2025-03-09 10:03:40,618] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:03:40,618] INFO [__main__] Components initialized successfully
[2025-03-09 10:03:40,618] INFO [__main__] Processing new question: Vào 1 ngày đẹp trời chủ nhất, bạn Đạt đi uống 1 thùng bia và lái xe máy SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?
[2025-03-09 10:03:40,619] INFO [__main__] Processing question: Vào 1 ngày đẹp trời chủ nhất, bạn Đạt đi uống 1 thùng bia và lái xe máy SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?
[2025-03-09 10:03:40,619] INFO [reasoning.auto_rag] Question validated as traffic-related via keyword: phạt
[2025-03-09 10:03:40,619] INFO [reasoning.auto_rag] Iteration 1: Retrieving documents for query: Vào 1 ngày đẹp trời chủ nhất, bạn Đạt đi uống 1 thùng bia và lái xe máy SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?
[2025-03-09 10:03:40,620] INFO [reasoning.auto_rag] Tokenized query: vào 1 ngày đẹp trời chủ nhất , bạn đạt đi uống 1 thùng bia và lái xe_máy sh 350i của ý không mang theo giấy_tờ thì bị phạt như thế_nào ?
[2025-03-09 10:03:40,621] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 10:03:40,621] INFO [retrieval.retriever] Original query: 'Vào 1 ngày đẹp trời chủ nhất, bạn Đạt đi uống 1 thùng bia và lái xe máy SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?'
[2025-03-09 10:03:40,621] INFO [retrieval.retriever] Tokenized query: 'vào 1 ngày đẹp trời chủ nhất , bạn đạt đi uống 1 thùng bia và lái xe_máy sh 350i của ý không mang theo giấy_tờ thì bị phạt như thế_nào ?'
[2025-03-09 10:03:41,013] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:03:41,013] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:03:41,013] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 10:03:41,013] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 10:03:41,014] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:03:41,014] INFO [__main__] Initializing web search integration
[2025-03-09 10:03:41,014] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:03:41,014] INFO [__main__] Components initialized successfully
[2025-03-09 10:03:42,221] INFO [retrieval.retriever] Retrieved 5 documents for query
[2025-03-09 10:03:42,222] INFO [retrieval.retriever] Top result score: 0.6497311592102051
[2025-03-09 10:03:42,222] INFO [retrieval.retriever] Score range: 0.5 to 0.6497311592102051
[2025-03-09 10:03:42,223] INFO [reasoning.auto_rag] DocumentRetriever returned 5 documents
[2025-03-09 10:03:42,223] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 10:03:42,223] INFO [reasoning.auto_rag] Doc 1 score: 0.6497311592102051
[2025-03-09 10:03:42,224] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 400.000 đồng đến 600.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 400.000 đồng đến 600.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo chứng nhận bảo hiểm bắt buộc trách nhiệm dân sự của chủ xe cơ giới còn hiệu lực'}
[2025-03-09 10:03:42,225] INFO [reasoning.auto_rag] Doc 2 score: 0.6274877786636353
[2025-03-09 10:03:42,225] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo giấy chứng nhận kiểm định an toàn kỹ thuật và bảo vệ môi trường'}
[2025-03-09 10:03:42,225] INFO [reasoning.auto_rag] Doc 3 score: 0.5641801357269287
[2025-03-09 10:03:42,226] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo chứng nhận đăng ký xe'}
[2025-03-09 10:03:42,226] INFO [reasoning.auto_rag] Context length: 997 characters
[2025-03-09 10:03:42,230] INFO [reasoning.auto_rag] Input tokens: 589
[2025-03-09 10:03:45,272] INFO [httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-03-09 10:03:45,286] INFO [reasoning.auto_rag] Output tokens: 180
[2025-03-09 10:03:45,287] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 10:03:45,287] INFO [reasoning.auto_rag] Need more information, next query: Cần tìm thông tin về mức phạt cho việc không mang theo giấy tờ khi lái xe máy, bao gồm các loại giấy tờ cần thiết và mức phạt tương ứng.
[2025-03-09 10:03:45,287] INFO [reasoning.auto_rag] Iteration 2: Retrieving documents for query: Cần tìm thông tin về mức phạt cho việc không mang theo giấy tờ khi lái xe máy, bao gồm các loại giấy tờ cần thiết và mức phạt tương ứng.
[2025-03-09 10:03:45,289] INFO [reasoning.auto_rag] Tokenized query: cần tìm thông_tin về mức phạt cho việc không mang theo giấy_tờ khi lái xe_máy , bao_gồm các loại giấy_tờ cần_thiết và mức phạt tương_ứng .
[2025-03-09 10:03:45,289] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 10:03:45,291] INFO [retrieval.retriever] Original query: 'Cần tìm thông tin về mức phạt cho việc không mang theo giấy tờ khi lái xe máy, bao gồm các loại giấy tờ cần thiết và mức phạt tương ứng.'
[2025-03-09 10:03:45,293] INFO [retrieval.retriever] Tokenized query: 'cần tìm thông_tin về mức phạt cho việc không mang theo giấy_tờ khi lái xe_máy , bao_gồm các loại giấy_tờ cần_thiết và mức phạt tương_ứng .'
[2025-03-09 10:03:45,949] INFO [retrieval.retriever] Retrieved 5 documents for query
[2025-03-09 10:03:45,949] INFO [retrieval.retriever] Top result score: 0.940696120262146
[2025-03-09 10:03:45,949] INFO [retrieval.retriever] Score range: 0.7836892008781433 to 0.940696120262146
[2025-03-09 10:03:45,949] INFO [reasoning.auto_rag] DocumentRetriever returned 5 documents
[2025-03-09 10:03:45,950] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 10:03:45,950] INFO [reasoning.auto_rag] Doc 1 score: 0.940696120262146
[2025-03-09 10:03:45,950] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo chứng nhận đăng ký xe'}
[2025-03-09 10:03:45,950] INFO [reasoning.auto_rag] Doc 2 score: 0.9365239143371582
[2025-03-09 10:03:45,951] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo giấy phép lái xe'}
[2025-03-09 10:03:45,951] INFO [reasoning.auto_rag] Doc 3 score: 0.8895315527915955
[2025-03-09 10:03:45,951] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo giấy chứng nhận kiểm định an toàn kỹ thuật và bảo vệ môi trường'}
[2025-03-09 10:03:45,951] INFO [reasoning.auto_rag] Context length: 2033 characters
[2025-03-09 10:03:45,953] INFO [reasoning.auto_rag] Input tokens: 916
[2025-03-09 10:03:48,561] INFO [httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-03-09 10:03:48,565] INFO [reasoning.auto_rag] Output tokens: 181
[2025-03-09 10:03:48,565] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 10:03:48,565] INFO [reasoning.auto_rag] Need more information, next query: Cần tìm thông tin về mức phạt cho việc không mang theo giấy tờ khi lái xe máy, đặc biệt là đối với xe máy SH 350i.
[2025-03-09 10:03:48,565] WARNING [reasoning.auto_rag] Exiting loop without sufficient information
[2025-03-09 10:03:48,566] INFO [utils] Function process_question completed in 7.95 seconds
[2025-03-09 10:03:48,566] INFO [__main__] Question processed in 7.95 seconds
[2025-03-09 10:03:48,567] INFO [__main__] Needs web search: True
[2025-03-09 10:03:48,567] INFO [__main__] Web search prompt triggered
[2025-03-09 10:03:48,567] INFO [__main__] Displaying results
[2025-03-09 10:03:48,568] INFO [__main__] Response generated using: OpenAI GPT-4o mini
[2025-03-09 10:03:48,579] INFO [__main__] Cleaning up components
[2025-03-09 10:03:48,582] INFO [retrieval.vector_store] Closing Weaviate client connection
[2025-03-09 10:03:48,597] INFO [retrieval.vector_store] Weaviate client connection closed
[2025-03-09 10:03:48,598] INFO [__main__] Displaying web search prompt
[2025-03-09 10:04:49,306] INFO [__main__] Starting application
[2025-03-09 10:04:49,309] INFO [__main__] Initializing configurations
[2025-03-09 10:04:49,309] INFO [__main__] Configurations initialized successfully
[2025-03-09 10:04:49,310] INFO [__main__] Selected LLM provider: openai
[2025-03-09 10:04:49,310] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 10:04:49,310] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:04:49,311] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:04:49,311] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:04:50,003] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:04:50,309] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:04:50,311] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:04:50,311] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:04:50,311] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:04:50,314] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:04:54,079] INFO [__main__] Starting application
[2025-03-09 10:04:54,080] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:04:54,080] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:04:54,080] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:04:54,080] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:04:54,080] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:04:54,434] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:04:54,665] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:04:54,670] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:04:54,670] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:04:54,670] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:04:54,671] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:04:56,257] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:04:56,657] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:04:56,760] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:04:56,760] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:04:59,131] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:04:59,131] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:04:59,131] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 10:04:59,313] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 10:04:59,313] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:04:59,314] INFO [__main__] Initializing web search integration
[2025-03-09 10:04:59,314] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:04:59,315] INFO [__main__] Components initialized successfully
[2025-03-09 10:05:01,998] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:05:02,524] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:05:02,526] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:05:02,526] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:05:06,107] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:05:06,107] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:05:06,107] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:05:06,107] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:05:06,143] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:05:06,143] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:05:06,143] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:05:06,143] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:05:06,143] INFO [__main__] Initializing web search integration
[2025-03-09 10:05:06,143] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:05:06,143] INFO [__main__] Components initialized successfully
[2025-03-09 10:05:14,558] INFO [__main__] Starting application
[2025-03-09 10:05:14,563] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:05:14,564] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:05:14,566] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:05:14,567] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:05:14,567] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:05:14,670] INFO [__main__] Starting application
[2025-03-09 10:05:14,671] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:05:14,671] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:05:14,671] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:05:14,671] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:05:14,672] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:05:14,984] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:05:15,195] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:05:15,214] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:05:15,217] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:05:15,218] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:05:15,218] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:05:15,221] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:05:15,416] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:05:15,419] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:05:15,419] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:05:15,420] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:05:15,422] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:05:20,322] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:05:20,627] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:05:20,830] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:05:20,834] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:05:20,834] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:05:21,114] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:05:21,119] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:05:21,119] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:05:22,869] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:05:22,869] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:05:22,869] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:05:22,869] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:05:22,911] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:05:22,911] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:05:22,911] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:05:22,911] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:05:22,911] INFO [__main__] Initializing web search integration
[2025-03-09 10:05:22,912] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:05:22,912] INFO [__main__] Components initialized successfully
[2025-03-09 10:05:23,781] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:05:23,781] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:05:23,781] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:05:23,781] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:05:23,997] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:05:23,997] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:05:23,997] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:05:23,997] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:05:23,997] INFO [__main__] Initializing web search integration
[2025-03-09 10:05:23,997] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:05:23,997] INFO [__main__] Components initialized successfully
[2025-03-09 10:05:23,998] INFO [__main__] Processing new question: Vào 1 ngày đẹp trời chủ nhat, bạn Đạt đi uống 1 thùng bia và lái xe máy SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?
[2025-03-09 10:05:23,999] INFO [__main__] Processing question: Vào 1 ngày đẹp trời chủ nhat, bạn Đạt đi uống 1 thùng bia và lái xe máy SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?
[2025-03-09 10:05:23,999] INFO [reasoning.auto_rag] Question validated as traffic-related via keyword: phạt
[2025-03-09 10:05:23,999] INFO [reasoning.auto_rag] Iteration 1: Retrieving documents for query: Vào 1 ngày đẹp trời chủ nhat, bạn Đạt đi uống 1 thùng bia và lái xe máy SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?
[2025-03-09 10:05:24,000] INFO [reasoning.auto_rag] Tokenized query: vào 1 ngày đẹp trời chủ nhat , bạn đạt đi uống 1 thùng bia và lái xe_máy sh 350i của ý không mang theo giấy_tờ thì bị phạt như thế_nào ?
[2025-03-09 10:05:24,000] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 10:05:24,001] INFO [retrieval.retriever] Original query: 'Vào 1 ngày đẹp trời chủ nhat, bạn Đạt đi uống 1 thùng bia và lái xe máy SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?'
[2025-03-09 10:05:24,001] INFO [retrieval.retriever] Tokenized query: 'vào 1 ngày đẹp trời chủ nhat , bạn đạt đi uống 1 thùng bia và lái xe_máy sh 350i của ý không mang theo giấy_tờ thì bị phạt như thế_nào ?'
[2025-03-09 10:05:24,724] INFO [retrieval.retriever] Retrieved 5 documents for query
[2025-03-09 10:05:24,724] INFO [retrieval.retriever] Top result score: 0.6497281789779663
[2025-03-09 10:05:24,725] INFO [retrieval.retriever] Score range: 0.5 to 0.6497281789779663
[2025-03-09 10:05:24,725] INFO [reasoning.auto_rag] DocumentRetriever returned 5 documents
[2025-03-09 10:05:24,726] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 10:05:24,727] INFO [reasoning.auto_rag] Doc 1 score: 0.6497281789779663
[2025-03-09 10:05:24,727] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 400.000 đồng đến 600.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 400.000 đồng đến 600.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo chứng nhận bảo hiểm bắt buộc trách nhiệm dân sự của chủ xe cơ giới còn hiệu lực'}
[2025-03-09 10:05:24,728] INFO [reasoning.auto_rag] Doc 2 score: 0.6272439956665039
[2025-03-09 10:05:24,728] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo giấy chứng nhận kiểm định an toàn kỹ thuật và bảo vệ môi trường'}
[2025-03-09 10:05:24,728] INFO [reasoning.auto_rag] Doc 3 score: 0.5646719932556152
[2025-03-09 10:05:24,728] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo chứng nhận đăng ký xe'}
[2025-03-09 10:05:24,728] INFO [reasoning.auto_rag] Context length: 997 characters
[2025-03-09 10:05:24,731] INFO [reasoning.auto_rag] Input tokens: 901
[2025-03-09 10:05:30,244] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:05:30,247] INFO [reasoning.auto_rag] Output tokens: 773
[2025-03-09 10:05:30,247] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 10:05:30,248] INFO [reasoning.auto_rag] Need more information, next query: Tìm hiểu mức phạt đối với việc lái xe máy mà không mang theo giấy tờ
[2025-03-09 10:05:30,248] INFO [reasoning.auto_rag] Iteration 2: Retrieving documents for query: Tìm hiểu mức phạt đối với việc lái xe máy mà không mang theo giấy tờ
[2025-03-09 10:05:30,249] INFO [reasoning.auto_rag] Tokenized query: tìm_hiểu mức phạt đối_với việc lái xe_máy mà không mang theo giấy_tờ
[2025-03-09 10:05:30,249] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 10:05:30,249] INFO [retrieval.retriever] Original query: 'Tìm hiểu mức phạt đối với việc lái xe máy mà không mang theo giấy tờ'
[2025-03-09 10:05:30,250] INFO [retrieval.retriever] Tokenized query: 'tìm_hiểu mức phạt đối_với việc lái xe_máy mà không mang theo giấy_tờ'
[2025-03-09 10:05:30,822] INFO [retrieval.retriever] Retrieved 5 documents for query
[2025-03-09 10:05:30,822] INFO [retrieval.retriever] Top result score: 0.9984968900680542
[2025-03-09 10:05:30,822] INFO [retrieval.retriever] Score range: 0.7629006505012512 to 0.9984968900680542
[2025-03-09 10:05:30,823] INFO [reasoning.auto_rag] DocumentRetriever returned 5 documents
[2025-03-09 10:05:30,823] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 10:05:30,823] INFO [reasoning.auto_rag] Doc 1 score: 0.9984968900680542
[2025-03-09 10:05:30,823] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo chứng nhận đăng ký xe'}
[2025-03-09 10:05:30,823] INFO [reasoning.auto_rag] Doc 2 score: 0.9157842397689819
[2025-03-09 10:05:30,823] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo giấy phép lái xe'}
[2025-03-09 10:05:30,823] INFO [reasoning.auto_rag] Doc 3 score: 0.8713008165359497
[2025-03-09 10:05:30,823] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 400.000 đồng đến 600.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 400.000 đồng đến 600.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo chứng nhận bảo hiểm bắt buộc trách nhiệm dân sự của chủ xe cơ giới còn hiệu lực'}
[2025-03-09 10:05:30,824] INFO [reasoning.auto_rag] Context length: 2033 characters
[2025-03-09 10:05:30,826] INFO [reasoning.auto_rag] Input tokens: 1408
[2025-03-09 10:05:36,322] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:05:36,325] INFO [reasoning.auto_rag] Output tokens: 779
[2025-03-09 10:05:36,326] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 10:05:36,326] INFO [reasoning.auto_rag] Need more information, next query: Tìm hiểu về mức phạt khi lái xe máy mà không mang theo giấy tờ
[2025-03-09 10:05:36,327] WARNING [reasoning.auto_rag] Exiting loop without sufficient information
[2025-03-09 10:05:36,327] INFO [utils] Function process_question completed in 12.33 seconds
[2025-03-09 10:05:36,328] INFO [__main__] Question processed in 12.33 seconds
[2025-03-09 10:05:36,330] INFO [__main__] Needs web search: True
[2025-03-09 10:05:36,330] INFO [__main__] Web search prompt triggered
[2025-03-09 10:05:36,330] INFO [__main__] Displaying results
[2025-03-09 10:05:36,332] INFO [__main__] Response generated using: Qwen2.5-14B (vLLM)
[2025-03-09 10:05:36,344] INFO [__main__] Cleaning up components
[2025-03-09 10:05:36,346] INFO [retrieval.vector_store] Closing Weaviate client connection
[2025-03-09 10:05:36,352] INFO [retrieval.vector_store] Weaviate client connection closed
[2025-03-09 10:05:36,352] INFO [__main__] Displaying web search prompt
[2025-03-09 10:06:07,731] INFO [__main__] Starting application
[2025-03-09 10:06:07,734] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:06:07,735] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:06:07,735] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:06:07,737] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:06:07,737] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:06:07,873] INFO [__main__] Starting application
[2025-03-09 10:06:07,876] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:06:07,876] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:06:07,876] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:06:07,876] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:06:07,876] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:06:08,318] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:06:08,427] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:06:08,549] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:06:08,552] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:06:08,552] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:06:08,553] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:06:08,556] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:06:08,668] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:06:08,673] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:06:08,674] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:06:08,674] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:06:08,674] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:06:13,292] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:06:13,521] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:06:13,528] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:06:13,528] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:06:15,203] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:06:15,705] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:06:15,706] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:06:15,706] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:06:15,706] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:06:15,795] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:06:15,795] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:06:15,795] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:06:15,795] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:06:15,795] INFO [__main__] Initializing web search integration
[2025-03-09 10:06:15,796] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:06:15,796] INFO [__main__] Components initialized successfully
[2025-03-09 10:06:16,132] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:06:16,137] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:06:16,137] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:06:18,202] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:06:18,202] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:06:18,202] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:06:18,202] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:06:18,239] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:06:18,239] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:06:18,239] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:06:18,240] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:06:18,240] INFO [__main__] Initializing web search integration
[2025-03-09 10:06:18,240] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:06:18,240] INFO [__main__] Components initialized successfully
[2025-03-09 10:06:18,241] INFO [__main__] Processing new question: Vào 1 ngày đẹp trời chủ nhat, bạn Đạt đi uống 1 thùng bia và lái xe SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?
[2025-03-09 10:06:18,242] INFO [__main__] Processing question: Vào 1 ngày đẹp trời chủ nhat, bạn Đạt đi uống 1 thùng bia và lái xe SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?
[2025-03-09 10:06:18,242] INFO [reasoning.auto_rag] Question validated as traffic-related via keyword: phạt
[2025-03-09 10:06:18,242] INFO [reasoning.auto_rag] Iteration 1: Retrieving documents for query: Vào 1 ngày đẹp trời chủ nhat, bạn Đạt đi uống 1 thùng bia và lái xe SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?
[2025-03-09 10:06:18,243] INFO [reasoning.auto_rag] Tokenized query: vào 1 ngày đẹp trời chủ nhat , bạn đạt đi uống 1 thùng bia và lái_xe sh 350i của ý không mang theo giấy_tờ thì bị phạt như thế_nào ?
[2025-03-09 10:06:18,243] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 10:06:18,243] INFO [retrieval.retriever] Original query: 'Vào 1 ngày đẹp trời chủ nhat, bạn Đạt đi uống 1 thùng bia và lái xe SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?'
[2025-03-09 10:06:18,243] INFO [retrieval.retriever] Tokenized query: 'vào 1 ngày đẹp trời chủ nhat , bạn đạt đi uống 1 thùng bia và lái_xe sh 350i của ý không mang theo giấy_tờ thì bị phạt như thế_nào ?'
[2025-03-09 10:06:19,398] INFO [retrieval.retriever] Retrieved 5 documents for query
[2025-03-09 10:06:19,398] INFO [retrieval.retriever] Top result score: 0.6462551355361938
[2025-03-09 10:06:19,399] INFO [retrieval.retriever] Score range: 0.5 to 0.6462551355361938
[2025-03-09 10:06:19,400] INFO [reasoning.auto_rag] DocumentRetriever returned 5 documents
[2025-03-09 10:06:19,400] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 10:06:19,400] INFO [reasoning.auto_rag] Doc 1 score: 0.6462551355361938
[2025-03-09 10:06:19,400] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 400.000 đồng đến 600.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 400.000 đồng đến 600.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo chứng nhận bảo hiểm bắt buộc trách nhiệm dân sự của chủ xe cơ giới còn hiệu lực'}
[2025-03-09 10:06:19,401] INFO [reasoning.auto_rag] Doc 2 score: 0.6420122981071472
[2025-03-09 10:06:19,401] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo giấy chứng nhận kiểm định an toàn kỹ thuật và bảo vệ môi trường'}
[2025-03-09 10:06:19,401] INFO [reasoning.auto_rag] Doc 3 score: 0.5938114523887634
[2025-03-09 10:06:19,402] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo chứng nhận đăng ký xe'}
[2025-03-09 10:06:19,402] INFO [reasoning.auto_rag] Context length: 997 characters
[2025-03-09 10:06:19,403] INFO [reasoning.auto_rag] Input tokens: 899
[2025-03-09 10:06:25,060] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:06:25,064] INFO [reasoning.auto_rag] Output tokens: 750
[2025-03-09 10:06:25,064] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 10:06:25,064] INFO [reasoning.auto_rag] Need more information, next query: Tìm hiểu về mức phạt khi lái xe máy SH 350i không mang theo giấy tờ và đã uống bia
[2025-03-09 10:06:25,064] INFO [reasoning.auto_rag] Iteration 2: Retrieving documents for query: Tìm hiểu về mức phạt khi lái xe máy SH 350i không mang theo giấy tờ và đã uống bia
[2025-03-09 10:06:25,065] INFO [reasoning.auto_rag] Tokenized query: tìm_hiểu về mức phạt khi lái xe_máy sh 350i không mang theo giấy_tờ và đã uống bia
[2025-03-09 10:06:25,065] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 10:06:25,066] INFO [retrieval.retriever] Original query: 'Tìm hiểu về mức phạt khi lái xe máy SH 350i không mang theo giấy tờ và đã uống bia'
[2025-03-09 10:06:25,067] INFO [retrieval.retriever] Tokenized query: 'tìm_hiểu về mức phạt khi lái xe_máy sh 350i không mang theo giấy_tờ và đã uống bia'
[2025-03-09 10:06:25,619] INFO [retrieval.retriever] Retrieved 5 documents for query
[2025-03-09 10:06:25,619] INFO [retrieval.retriever] Top result score: 0.927406907081604
[2025-03-09 10:06:25,619] INFO [retrieval.retriever] Score range: 0.5305532813072205 to 0.927406907081604
[2025-03-09 10:06:25,619] INFO [reasoning.auto_rag] DocumentRetriever returned 5 documents
[2025-03-09 10:06:25,619] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 10:06:25,619] INFO [reasoning.auto_rag] Doc 1 score: 0.927406907081604
[2025-03-09 10:06:25,620] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo giấy chứng nhận kiểm định an toàn kỹ thuật và bảo vệ môi trường'}
[2025-03-09 10:06:25,620] INFO [reasoning.auto_rag] Doc 2 score: 0.8850917816162109
[2025-03-09 10:06:25,620] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo chứng nhận đăng ký xe'}
[2025-03-09 10:06:25,620] INFO [reasoning.auto_rag] Doc 3 score: 0.7712247967720032
[2025-03-09 10:06:25,621] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo giấy phép lái xe'}
[2025-03-09 10:06:25,621] INFO [reasoning.auto_rag] Context length: 1986 characters
[2025-03-09 10:06:25,623] INFO [reasoning.auto_rag] Input tokens: 1385
[2025-03-09 10:06:31,175] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:06:31,177] INFO [reasoning.auto_rag] Output tokens: 771
[2025-03-09 10:06:31,178] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 10:06:31,178] INFO [reasoning.auto_rag] Need more information, next query: Tìm hiểu về mức phạt khi lái xe máy sau khi uống bia và không mang theo giấy tờ
[2025-03-09 10:06:31,178] WARNING [reasoning.auto_rag] Exiting loop without sufficient information
[2025-03-09 10:06:31,178] INFO [utils] Function process_question completed in 12.94 seconds
[2025-03-09 10:06:31,179] INFO [__main__] Question processed in 12.94 seconds
[2025-03-09 10:06:31,180] INFO [__main__] Needs web search: True
[2025-03-09 10:06:31,180] INFO [__main__] Web search prompt triggered
[2025-03-09 10:06:31,180] INFO [__main__] Displaying results
[2025-03-09 10:06:31,181] INFO [__main__] Response generated using: Qwen2.5-14B (vLLM)
[2025-03-09 10:06:31,187] INFO [__main__] Cleaning up components
[2025-03-09 10:06:31,188] INFO [retrieval.vector_store] Closing Weaviate client connection
[2025-03-09 10:06:31,191] INFO [retrieval.vector_store] Weaviate client connection closed
[2025-03-09 10:06:31,192] INFO [__main__] Displaying web search prompt
[2025-03-09 10:06:38,455] INFO [__main__] Starting application
[2025-03-09 10:06:38,456] INFO [__main__] Selected LLM provider: openai
[2025-03-09 10:06:38,456] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 10:06:38,456] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:06:38,456] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:06:38,456] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:06:38,989] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:06:39,264] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:06:39,267] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:06:39,267] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:06:39,267] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:06:39,269] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:06:45,006] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:06:45,520] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:06:45,534] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:06:45,535] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:06:47,568] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:06:47,568] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:06:47,568] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 10:06:47,568] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 10:06:47,568] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:06:47,568] INFO [__main__] Initializing web search integration
[2025-03-09 10:06:47,568] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:06:47,568] INFO [__main__] Components initialized successfully
[2025-03-09 10:06:54,028] INFO [__main__] Starting application
[2025-03-09 10:06:54,029] INFO [__main__] Selected LLM provider: openai
[2025-03-09 10:06:54,029] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 10:06:54,029] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:06:54,029] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:06:54,030] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:06:54,425] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:06:54,653] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:06:54,662] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:06:54,662] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:06:54,662] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:06:54,664] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:07:01,495] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:07:01,993] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:07:02,008] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:07:02,008] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:07:03,977] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:07:03,977] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:07:03,977] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 10:07:03,977] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 10:07:03,977] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:07:03,977] INFO [__main__] Initializing web search integration
[2025-03-09 10:07:03,978] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:07:03,978] INFO [__main__] Components initialized successfully
[2025-03-09 10:07:29,749] INFO [__main__] Starting application
[2025-03-09 10:07:29,755] INFO [__main__] Selected LLM provider: openai
[2025-03-09 10:07:29,757] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 10:07:29,759] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:07:29,760] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:07:29,761] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:07:30,261] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:07:30,498] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:07:30,503] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:07:30,503] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:07:30,504] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:07:30,506] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:07:35,485] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:07:35,790] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:07:35,794] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:07:35,794] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:07:37,811] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:07:37,811] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:07:37,811] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 10:07:37,811] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 10:07:37,811] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:07:37,811] INFO [__main__] Initializing web search integration
[2025-03-09 10:07:37,812] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:07:37,812] INFO [__main__] Components initialized successfully
[2025-03-09 10:08:04,675] INFO [__main__] Starting application
[2025-03-09 10:08:04,678] INFO [__main__] Selected LLM provider: openai
[2025-03-09 10:08:04,679] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 10:08:04,680] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:08:04,680] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:08:04,680] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:08:04,755] INFO [__main__] Starting application
[2025-03-09 10:08:04,757] INFO [__main__] Selected LLM provider: openai
[2025-03-09 10:08:04,757] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 10:08:04,757] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:08:04,757] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:08:04,757] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:08:05,078] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:08:05,124] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:08:05,306] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:08:05,311] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:08:05,311] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:08:05,312] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:08:05,315] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:08:05,369] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:08:05,374] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:08:05,374] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:08:05,375] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:08:05,377] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:08:09,835] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:08:09,894] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:08:10,065] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:08:10,068] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:08:10,068] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:08:10,126] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:08:10,139] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:08:10,141] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:08:12,328] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:08:12,328] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:08:12,328] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 10:08:12,328] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 10:08:12,329] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:08:12,329] INFO [__main__] Initializing web search integration
[2025-03-09 10:08:12,329] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:08:12,329] INFO [__main__] Components initialized successfully
[2025-03-09 10:08:12,330] INFO [__main__] Processing new question: Đạt uống rất nhiều bia, và lái xe SH 350i không mang giấy tờ, Đạt sẽ bị xử phạt làm sao 
[2025-03-09 10:08:12,330] INFO [__main__] Processing question: Đạt uống rất nhiều bia, và lái xe SH 350i không mang giấy tờ, Đạt sẽ bị xử phạt làm sao 
[2025-03-09 10:08:12,330] INFO [reasoning.auto_rag] Question validated as traffic-related via keyword: phạt
[2025-03-09 10:08:12,330] INFO [reasoning.auto_rag] Iteration 1: Retrieving documents for query: Đạt uống rất nhiều bia, và lái xe SH 350i không mang giấy tờ, Đạt sẽ bị xử phạt làm sao 
[2025-03-09 10:08:12,330] INFO [reasoning.auto_rag] Tokenized query: đạt uống rất nhiều bia , và lái_xe sh 350i không mang giấy_tờ , đạt sẽ bị xử_phạt làm_sao
[2025-03-09 10:08:12,330] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 10:08:12,331] INFO [retrieval.retriever] Original query: 'Đạt uống rất nhiều bia, và lái xe SH 350i không mang giấy tờ, Đạt sẽ bị xử phạt làm sao '
[2025-03-09 10:08:12,331] INFO [retrieval.retriever] Tokenized query: 'đạt uống rất nhiều bia , và lái_xe sh 350i không mang giấy_tờ , đạt sẽ bị xử_phạt làm_sao'
[2025-03-09 10:08:12,786] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:08:12,786] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:08:12,786] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 10:08:12,786] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 10:08:12,786] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:08:12,786] INFO [__main__] Initializing web search integration
[2025-03-09 10:08:12,787] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:08:12,787] INFO [__main__] Components initialized successfully
[2025-03-09 10:08:14,411] INFO [retrieval.retriever] Retrieved 5 documents for query
[2025-03-09 10:08:14,412] INFO [retrieval.retriever] Top result score: 0.8383281230926514
[2025-03-09 10:08:14,412] INFO [retrieval.retriever] Score range: 0.5224271416664124 to 0.8383281230926514
[2025-03-09 10:08:14,412] INFO [reasoning.auto_rag] DocumentRetriever returned 5 documents
[2025-03-09 10:08:14,412] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 10:08:14,412] INFO [reasoning.auto_rag] Doc 1 score: 0.8383281230926514
[2025-03-09 10:08:14,412] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo giấy chứng nhận kiểm định an toàn kỹ thuật và bảo vệ môi trường'}
[2025-03-09 10:08:14,412] INFO [reasoning.auto_rag] Doc 2 score: 0.7883746027946472
[2025-03-09 10:08:14,413] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo chứng nhận đăng ký xe'}
[2025-03-09 10:08:14,414] INFO [reasoning.auto_rag] Doc 3 score: 0.6704548001289368
[2025-03-09 10:08:14,415] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo giấy phép lái xe'}
[2025-03-09 10:08:14,417] INFO [reasoning.auto_rag] Context length: 998 characters
[2025-03-09 10:08:14,424] INFO [reasoning.auto_rag] Input tokens: 579
[2025-03-09 10:08:17,129] INFO [httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-03-09 10:08:17,170] INFO [reasoning.auto_rag] Output tokens: 159
[2025-03-09 10:08:17,170] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 10:08:17,171] INFO [reasoning.auto_rag] Need more information, next query: Tìm kiếm thông tin về mức phạt cho việc lái xe máy khi không mang giấy tờ và mức phạt cho việc lái xe sau khi uống rượu bia.
[2025-03-09 10:08:17,171] INFO [reasoning.auto_rag] Iteration 2: Retrieving documents for query: Tìm kiếm thông tin về mức phạt cho việc lái xe máy khi không mang giấy tờ và mức phạt cho việc lái xe sau khi uống rượu bia.
[2025-03-09 10:08:17,172] INFO [reasoning.auto_rag] Tokenized query: tìm_kiếm thông_tin về mức phạt cho việc lái xe_máy khi không mang giấy_tờ và mức phạt cho việc lái_xe sau khi uống rượu_bia .
[2025-03-09 10:08:17,174] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 10:08:17,176] INFO [retrieval.retriever] Original query: 'Tìm kiếm thông tin về mức phạt cho việc lái xe máy khi không mang giấy tờ và mức phạt cho việc lái xe sau khi uống rượu bia.'
[2025-03-09 10:08:17,178] INFO [retrieval.retriever] Tokenized query: 'tìm_kiếm thông_tin về mức phạt cho việc lái xe_máy khi không mang giấy_tờ và mức phạt cho việc lái_xe sau khi uống rượu_bia .'
[2025-03-09 10:08:17,746] INFO [retrieval.retriever] Retrieved 5 documents for query
[2025-03-09 10:08:17,746] INFO [retrieval.retriever] Top result score: 0.7135981321334839
[2025-03-09 10:08:17,746] INFO [retrieval.retriever] Score range: 0.5674363374710083 to 0.7135981321334839
[2025-03-09 10:08:17,747] INFO [reasoning.auto_rag] DocumentRetriever returned 5 documents
[2025-03-09 10:08:17,747] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 10:08:17,747] INFO [reasoning.auto_rag] Doc 1 score: 0.7135981321334839
[2025-03-09 10:08:17,747] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo giấy chứng nhận kiểm định an toàn kỹ thuật và bảo vệ môi trường'}
[2025-03-09 10:08:17,747] INFO [reasoning.auto_rag] Doc 2 score: 0.6543304920196533
[2025-03-09 10:08:17,748] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo chứng nhận đăng ký xe'}
[2025-03-09 10:08:17,749] INFO [reasoning.auto_rag] Doc 3 score: 0.6004427671432495
[2025-03-09 10:08:17,749] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo giấy phép lái xe'}
[2025-03-09 10:08:17,750] INFO [reasoning.auto_rag] Context length: 2034 characters
[2025-03-09 10:08:17,753] INFO [reasoning.auto_rag] Input tokens: 906
[2025-03-09 10:08:20,283] INFO [httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-03-09 10:08:20,288] INFO [reasoning.auto_rag] Output tokens: 182
[2025-03-09 10:08:20,289] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 10:08:20,289] INFO [reasoning.auto_rag] Need more information, next query: Cần tìm thông tin về mức phạt cho việc lái xe máy không mang giấy tờ và mức phạt cho việc lái xe khi đã uống rượu bia.
[2025-03-09 10:08:20,289] WARNING [reasoning.auto_rag] Exiting loop without sufficient information
[2025-03-09 10:08:20,289] INFO [utils] Function process_question completed in 7.96 seconds
[2025-03-09 10:08:20,290] INFO [__main__] Question processed in 7.96 seconds
[2025-03-09 10:08:20,291] INFO [__main__] Needs web search: True
[2025-03-09 10:08:20,292] INFO [__main__] Web search prompt triggered
[2025-03-09 10:08:20,292] INFO [__main__] Displaying results
[2025-03-09 10:08:20,292] INFO [__main__] Response generated using: OpenAI GPT-4o mini
[2025-03-09 10:08:20,298] INFO [__main__] Cleaning up components
[2025-03-09 10:08:20,298] INFO [retrieval.vector_store] Closing Weaviate client connection
[2025-03-09 10:08:20,307] INFO [retrieval.vector_store] Weaviate client connection closed
[2025-03-09 10:08:20,308] INFO [__main__] Displaying web search prompt
[2025-03-09 10:09:08,446] INFO [__main__] Starting application
[2025-03-09 10:09:08,448] INFO [__main__] Initializing configurations
[2025-03-09 10:09:08,448] INFO [__main__] Configurations initialized successfully
[2025-03-09 10:09:08,449] INFO [__main__] Selected LLM provider: openai
[2025-03-09 10:09:08,449] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 10:09:08,450] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:09:08,450] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:09:08,450] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:09:08,892] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:09:09,180] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:09:09,181] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:09:09,182] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:09:09,182] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:09:09,184] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:09:14,039] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:09:14,264] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:09:14,479] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:09:14,479] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:09:16,636] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:09:16,636] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:09:16,636] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 10:09:16,824] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 10:09:16,825] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:09:16,825] INFO [__main__] Initializing web search integration
[2025-03-09 10:09:16,825] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:09:16,826] INFO [__main__] Components initialized successfully
[2025-03-09 10:09:25,696] INFO [__main__] Starting application
[2025-03-09 10:09:25,697] INFO [__main__] Selected LLM provider: openai
[2025-03-09 10:09:25,697] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 10:09:25,697] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:09:25,697] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:09:25,698] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:09:26,283] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:09:26,590] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:09:26,593] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:09:26,593] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:09:26,593] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:09:26,596] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:09:31,776] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:09:32,387] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:09:32,392] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:09:32,392] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:09:34,987] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:09:34,987] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:09:34,987] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 10:09:34,987] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 10:09:34,987] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:09:34,987] INFO [__main__] Initializing web search integration
[2025-03-09 10:09:34,987] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:09:34,987] INFO [__main__] Components initialized successfully
[2025-03-09 10:09:56,920] INFO [__main__] Starting application
[2025-03-09 10:09:56,922] INFO [__main__] Selected LLM provider: openai
[2025-03-09 10:09:56,922] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 10:09:56,923] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:09:56,923] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:09:56,923] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:09:57,515] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:09:57,821] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:09:57,822] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:09:57,822] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:09:57,822] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:09:57,823] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:10:03,047] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:10:03,455] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:10:03,458] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:10:03,458] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:10:06,191] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:10:06,191] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:10:06,191] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 10:10:06,191] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 10:10:06,191] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:10:06,191] INFO [__main__] Initializing web search integration
[2025-03-09 10:10:06,191] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:10:06,191] INFO [__main__] Components initialized successfully
[2025-03-09 10:10:12,707] INFO [__main__] Starting application
[2025-03-09 10:10:12,709] INFO [__main__] Selected LLM provider: openai
[2025-03-09 10:10:12,709] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 10:10:12,709] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:10:12,709] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:10:12,709] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:10:13,102] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:10:13,326] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:10:13,331] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:10:13,332] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:10:13,332] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:10:13,334] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:10:13,498] INFO [__main__] Starting application
[2025-03-09 10:10:13,499] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:10:13,500] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:10:13,500] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:10:13,501] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:10:13,501] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:10:14,077] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:10:14,321] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:10:14,326] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:10:14,326] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:10:14,327] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:10:14,331] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:10:17,803] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:10:18,028] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:10:18,032] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:10:18,032] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:10:19,125] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:10:19,429] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:10:19,443] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:10:19,443] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:10:20,167] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:10:20,167] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:10:20,168] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 10:10:20,168] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 10:10:20,168] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:10:20,168] INFO [__main__] Initializing web search integration
[2025-03-09 10:10:20,168] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:10:20,168] INFO [__main__] Components initialized successfully
[2025-03-09 10:10:21,638] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:10:21,638] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:10:21,638] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:10:21,638] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:10:21,679] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:10:21,679] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:10:21,679] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:10:21,679] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:10:21,679] INFO [__main__] Initializing web search integration
[2025-03-09 10:10:21,680] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:10:21,680] INFO [__main__] Components initialized successfully
[2025-03-09 10:10:56,149] INFO [__main__] Starting application
[2025-03-09 10:10:56,155] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:10:56,156] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:10:56,156] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:10:56,157] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:10:56,157] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:10:56,254] INFO [__main__] Starting application
[2025-03-09 10:10:56,255] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:10:56,256] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:10:56,256] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:10:56,257] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:10:56,257] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:10:56,805] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:10:56,838] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:10:57,112] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:10:57,116] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:10:57,120] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:10:57,120] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:10:57,120] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:10:57,121] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:10:57,121] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:10:57,123] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:10:57,128] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:10:57,128] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:11:01,555] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:11:01,823] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:11:01,828] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:11:01,828] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:11:02,239] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:11:02,568] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:11:02,571] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:11:02,571] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:11:03,937] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:11:03,937] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:11:03,937] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:11:03,937] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:11:03,979] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:11:03,979] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:11:03,979] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:11:03,979] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:11:03,979] INFO [__main__] Initializing web search integration
[2025-03-09 10:11:03,979] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:11:03,979] INFO [__main__] Components initialized successfully
[2025-03-09 10:11:08,398] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:11:08,399] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:11:08,399] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:11:08,399] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:11:08,433] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:11:08,434] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:11:08,434] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:11:08,434] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:11:08,434] INFO [__main__] Initializing web search integration
[2025-03-09 10:11:08,434] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:11:08,434] INFO [__main__] Components initialized successfully
[2025-03-09 10:11:08,434] INFO [__main__] Processing new question: Vào 1 ngày đẹp trời, Đạt lái xe SH 350i bằng 1 bánh để lấy số với người yêu. Đạt sẽ bị phạt bao nhiêu tiền 
[2025-03-09 10:11:08,435] INFO [__main__] Processing question: Vào 1 ngày đẹp trời, Đạt lái xe SH 350i bằng 1 bánh để lấy số với người yêu. Đạt sẽ bị phạt bao nhiêu tiền 
[2025-03-09 10:11:08,435] INFO [reasoning.auto_rag] Question validated as traffic-related via keyword: phạt
[2025-03-09 10:11:08,435] INFO [reasoning.auto_rag] Iteration 1: Retrieving documents for query: Vào 1 ngày đẹp trời, Đạt lái xe SH 350i bằng 1 bánh để lấy số với người yêu. Đạt sẽ bị phạt bao nhiêu tiền 
[2025-03-09 10:11:08,436] INFO [reasoning.auto_rag] Tokenized query: vào 1 ngày đẹp trời , đạt lái_xe sh 350i bằng 1 bánh để lấy số với người_yêu . đạt sẽ bị phạt bao_nhiêu tiền
[2025-03-09 10:11:08,436] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 10:11:08,437] INFO [retrieval.retriever] Original query: 'Vào 1 ngày đẹp trời, Đạt lái xe SH 350i bằng 1 bánh để lấy số với người yêu. Đạt sẽ bị phạt bao nhiêu tiền '
[2025-03-09 10:11:08,437] INFO [retrieval.retriever] Tokenized query: 'vào 1 ngày đẹp trời , đạt lái_xe sh 350i bằng 1 bánh để lấy số với người_yêu . đạt sẽ bị phạt bao_nhiêu tiền'
[2025-03-09 10:11:09,317] INFO [retrieval.retriever] Retrieved 2 documents for query
[2025-03-09 10:11:09,317] INFO [retrieval.retriever] Top result score: 1.0
[2025-03-09 10:11:09,317] INFO [retrieval.retriever] Score range: 0.6956424713134766 to 1.0
[2025-03-09 10:11:09,317] INFO [reasoning.auto_rag] DocumentRetriever returned 2 documents
[2025-03-09 10:11:09,317] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 10:11:09,318] INFO [reasoning.auto_rag] Doc 1 score: 1.0
[2025-03-09 10:11:09,318] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Tịch thu phương tiện', 'violation_type': 'lái_xe_nguy_hiểm', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Tịch thu phương tiện\nNội dung vi phạm: Điều khiển xe chạy bằng một bánh đối với xe hai bánh, chạy bằng hai bánh đối với xe ba bánh'}
[2025-03-09 10:11:09,319] INFO [reasoning.auto_rag] Doc 2 score: 0.6956424713134766
[2025-03-09 10:11:09,319] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng', 'violation_type': 'lái_xe_nguy_hiểm', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng\nNội dung vi phạm: Điều khiển xe chạy bằng một bánh đối với xe hai bánh, chạy bằng hai bánh đối với xe ba bánh'}
[2025-03-09 10:11:09,320] INFO [reasoning.auto_rag] Context length: 412 characters
[2025-03-09 10:11:09,323] INFO [reasoning.auto_rag] Input tokens: 622
[2025-03-09 10:11:14,751] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:11:14,755] INFO [reasoning.auto_rag] Output tokens: 901
[2025-03-09 10:11:14,755] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 10:11:14,755] INFO [reasoning.auto_rag] Need more information, next query: Mức phạt tiền khi điều khiển xe chạy bằng một bánh đối với xe hai bánh
[2025-03-09 10:11:14,755] INFO [reasoning.auto_rag] Iteration 2: Retrieving documents for query: Mức phạt tiền khi điều khiển xe chạy bằng một bánh đối với xe hai bánh
[2025-03-09 10:11:14,756] INFO [reasoning.auto_rag] Tokenized query: mức phạt tiền khi điều_khiển xe chạy bằng một bánh đối_với xe hai bánh
[2025-03-09 10:11:14,756] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 10:11:14,757] INFO [retrieval.retriever] Original query: 'Mức phạt tiền khi điều khiển xe chạy bằng một bánh đối với xe hai bánh'
[2025-03-09 10:11:14,757] INFO [retrieval.retriever] Tokenized query: 'mức phạt tiền khi điều_khiển xe chạy bằng một bánh đối_với xe hai bánh'
[2025-03-09 10:11:15,307] INFO [retrieval.retriever] Retrieved 2 documents for query
[2025-03-09 10:11:15,307] INFO [retrieval.retriever] Top result score: 1.0
[2025-03-09 10:11:15,307] INFO [retrieval.retriever] Score range: 0.7134513258934021 to 1.0
[2025-03-09 10:11:15,307] INFO [reasoning.auto_rag] DocumentRetriever returned 2 documents
[2025-03-09 10:11:15,308] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 10:11:15,308] INFO [reasoning.auto_rag] Doc 1 score: 1.0
[2025-03-09 10:11:15,309] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Tịch thu phương tiện', 'violation_type': 'lái_xe_nguy_hiểm', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Tịch thu phương tiện\nNội dung vi phạm: Điều khiển xe chạy bằng một bánh đối với xe hai bánh, chạy bằng hai bánh đối với xe ba bánh'}
[2025-03-09 10:11:15,309] INFO [reasoning.auto_rag] Doc 2 score: 0.7134513258934021
[2025-03-09 10:11:15,309] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng', 'violation_type': 'lái_xe_nguy_hiểm', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng\nNội dung vi phạm: Điều khiển xe chạy bằng một bánh đối với xe hai bánh, chạy bằng hai bánh đối với xe ba bánh'}
[2025-03-09 10:11:15,310] INFO [reasoning.auto_rag] Context length: 826 characters
[2025-03-09 10:11:15,311] INFO [reasoning.auto_rag] Input tokens: 838
[2025-03-09 10:11:20,768] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:11:20,771] INFO [reasoning.auto_rag] Output tokens: 872
[2025-03-09 10:11:20,771] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 10:11:20,771] INFO [reasoning.auto_rag] Need more information, next query: Tìm mức phạt tiền khi điều khiển xe chạy bằng một bánh đối với xe hai bánh
[2025-03-09 10:11:20,771] WARNING [reasoning.auto_rag] Exiting loop without sufficient information
[2025-03-09 10:11:20,772] INFO [utils] Function process_question completed in 12.34 seconds
[2025-03-09 10:11:20,773] INFO [__main__] Question processed in 12.34 seconds
[2025-03-09 10:11:20,773] INFO [__main__] Needs web search: True
[2025-03-09 10:11:20,773] INFO [__main__] Web search prompt triggered
[2025-03-09 10:11:20,773] INFO [__main__] Displaying results
[2025-03-09 10:11:20,774] INFO [__main__] Response generated using: Qwen2.5-14B (vLLM)
[2025-03-09 10:11:20,778] INFO [__main__] Cleaning up components
[2025-03-09 10:11:20,778] INFO [retrieval.vector_store] Closing Weaviate client connection
[2025-03-09 10:11:20,783] INFO [retrieval.vector_store] Weaviate client connection closed
[2025-03-09 10:11:20,783] INFO [__main__] Displaying web search prompt
[2025-03-09 10:12:30,140] INFO [__main__] Starting application
[2025-03-09 10:12:30,141] INFO [__main__] Selected LLM provider: openai
[2025-03-09 10:12:30,141] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 10:12:30,141] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:12:30,141] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:12:30,141] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:12:30,723] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:12:31,015] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:12:31,017] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:12:31,017] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:12:31,017] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:12:31,019] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:12:32,085] INFO [__main__] Starting application
[2025-03-09 10:12:32,086] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:12:32,087] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:12:32,088] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:12:32,088] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:12:32,088] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:12:32,448] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:12:32,664] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:12:32,667] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:12:32,667] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:12:32,667] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:12:32,668] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:12:36,287] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:12:36,852] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:12:36,855] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:12:36,855] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:12:37,991] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:12:38,498] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:12:38,504] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:12:38,504] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:12:39,150] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:12:39,150] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:12:39,150] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 10:12:39,151] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 10:12:39,151] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:12:39,151] INFO [__main__] Initializing web search integration
[2025-03-09 10:12:39,151] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:12:39,151] INFO [__main__] Components initialized successfully
[2025-03-09 10:12:40,938] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:12:40,939] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:12:40,939] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:12:40,939] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:12:40,970] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:12:40,970] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:12:40,971] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:12:40,971] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:12:40,971] INFO [__main__] Initializing web search integration
[2025-03-09 10:12:40,971] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:12:40,971] INFO [__main__] Components initialized successfully
[2025-03-09 10:13:12,064] INFO [__main__] Starting application
[2025-03-09 10:13:12,072] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:13:12,072] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:13:12,072] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:13:12,073] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:13:12,073] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:13:12,174] INFO [__main__] Starting application
[2025-03-09 10:13:12,176] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:13:12,177] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:13:12,177] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:13:12,177] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:13:12,177] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:13:12,545] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:13:12,730] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:13:12,775] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:13:12,789] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:13:12,790] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:13:12,790] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:13:12,795] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:13:12,972] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:13:12,977] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:13:12,977] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:13:12,977] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:13:12,978] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:13:17,617] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:13:17,871] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:13:17,874] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:13:17,875] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:13:19,253] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:13:20,048] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:13:20,050] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:13:20,050] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:13:20,050] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:13:20,050] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:13:20,050] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:13:20,051] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:13:20,086] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:13:20,086] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:13:20,086] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:13:20,086] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:13:20,086] INFO [__main__] Initializing web search integration
[2025-03-09 10:13:20,087] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:13:20,087] INFO [__main__] Components initialized successfully
[2025-03-09 10:13:20,087] INFO [__main__] Processing new question: Đạt lái xe gắn máy chở người yêu bằng 1 bánh thì sẽ bị phạt ra sao ?
[2025-03-09 10:13:20,088] INFO [__main__] Processing question: Đạt lái xe gắn máy chở người yêu bằng 1 bánh thì sẽ bị phạt ra sao ?
[2025-03-09 10:13:20,088] INFO [reasoning.auto_rag] Question validated as traffic-related via keyword: phạt
[2025-03-09 10:13:20,088] INFO [reasoning.auto_rag] Iteration 1: Retrieving documents for query: Đạt lái xe gắn máy chở người yêu bằng 1 bánh thì sẽ bị phạt ra sao ?
[2025-03-09 10:13:20,089] INFO [reasoning.auto_rag] Tokenized query: đạt lái xe gắn_máy chở người_yêu bằng 1 bánh thì sẽ bị phạt ra sao ?
[2025-03-09 10:13:20,089] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 10:13:20,089] INFO [retrieval.retriever] Original query: 'Đạt lái xe gắn máy chở người yêu bằng 1 bánh thì sẽ bị phạt ra sao ?'
[2025-03-09 10:13:20,089] INFO [retrieval.retriever] Tokenized query: 'đạt lái xe gắn_máy chở người_yêu bằng 1 bánh thì sẽ bị phạt ra sao ?'
[2025-03-09 10:13:20,987] INFO [retrieval.retriever] Retrieved 2 documents for query
[2025-03-09 10:13:20,988] INFO [retrieval.retriever] Top result score: 0.8076084852218628
[2025-03-09 10:13:20,988] INFO [retrieval.retriever] Score range: 0.7591887712478638 to 0.8076084852218628
[2025-03-09 10:13:20,988] INFO [reasoning.auto_rag] DocumentRetriever returned 2 documents
[2025-03-09 10:13:20,988] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 10:13:20,989] INFO [reasoning.auto_rag] Doc 1 score: 0.8076084852218628
[2025-03-09 10:13:20,990] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Tịch thu phương tiện', 'violation_type': 'lái_xe_nguy_hiểm', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Tịch thu phương tiện\nNội dung vi phạm: Điều khiển xe chạy bằng một bánh đối với xe hai bánh, chạy bằng hai bánh đối với xe ba bánh'}
[2025-03-09 10:13:20,990] INFO [reasoning.auto_rag] Doc 2 score: 0.7591887712478638
[2025-03-09 10:13:20,990] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng', 'violation_type': 'lái_xe_nguy_hiểm', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng\nNội dung vi phạm: Điều khiển xe chạy bằng một bánh đối với xe hai bánh, chạy bằng hai bánh đối với xe ba bánh'}
[2025-03-09 10:13:20,991] INFO [reasoning.auto_rag] Context length: 412 characters
[2025-03-09 10:13:20,993] INFO [reasoning.auto_rag] Input tokens: 597
[2025-03-09 10:13:22,402] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:13:22,402] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:13:22,402] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:13:22,402] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:13:22,433] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:13:22,434] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:13:22,434] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:13:22,434] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:13:22,434] INFO [__main__] Initializing web search integration
[2025-03-09 10:13:22,434] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:13:22,434] INFO [__main__] Components initialized successfully
[2025-03-09 10:13:26,721] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:13:26,724] INFO [reasoning.auto_rag] Output tokens: 963
[2025-03-09 10:13:26,724] INFO [reasoning.auto_rag] Decision: Đã đủ thông tin
[2025-03-09 10:13:26,725] INFO [reasoning.auto_rag] Found sufficient information, returning final answer
[2025-03-09 10:13:26,725] INFO [utils] Function process_question completed in 6.64 seconds
[2025-03-09 10:13:26,726] INFO [__main__] Question processed in 6.64 seconds
[2025-03-09 10:13:26,727] INFO [__main__] Needs web search: False
[2025-03-09 10:13:26,727] INFO [__main__] Displaying results
[2025-03-09 10:13:26,728] INFO [__main__] Response generated using: Qwen2.5-14B (vLLM)
[2025-03-09 10:13:26,737] INFO [__main__] Cleaning up components
[2025-03-09 10:13:26,738] INFO [retrieval.vector_store] Closing Weaviate client connection
[2025-03-09 10:13:26,741] INFO [retrieval.vector_store] Weaviate client connection closed
[2025-03-09 10:14:40,034] INFO [__main__] Starting application
[2025-03-09 10:14:40,041] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:14:40,043] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:14:40,062] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:14:40,064] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:14:40,066] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:14:40,164] INFO [__main__] Starting application
[2025-03-09 10:14:40,168] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:14:40,169] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:14:40,169] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:14:40,169] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:14:40,170] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:14:41,065] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:14:41,069] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:14:41,372] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:14:41,374] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:14:41,376] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:14:41,377] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:14:41,377] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:14:41,378] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:14:41,379] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:14:41,381] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:14:41,385] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:14:41,390] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:14:46,033] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:14:46,287] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:14:46,295] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:14:46,295] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:14:46,299] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:14:46,596] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:14:46,600] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:14:46,600] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:14:48,238] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:14:48,238] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:14:48,238] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:14:48,238] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:14:48,285] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:14:48,285] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:14:48,285] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:14:48,285] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:14:48,285] INFO [__main__] Initializing web search integration
[2025-03-09 10:14:48,286] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:14:48,286] INFO [__main__] Components initialized successfully
[2025-03-09 10:14:49,147] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:14:49,147] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:14:49,147] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:14:49,147] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:14:49,311] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:14:49,311] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:14:49,311] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:14:49,311] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:14:49,311] INFO [__main__] Initializing web search integration
[2025-03-09 10:14:49,312] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:14:49,312] INFO [__main__] Components initialized successfully
[2025-03-09 10:14:49,313] INFO [__main__] Processing new question: Người yêu Đạt thích Đạt chạy xe SH 350i, Đạt trộm xe SH 305i không giấy tờ, thì Đạt sẽ chịu những hình phạt gì ?
[2025-03-09 10:14:49,318] INFO [__main__] Processing question: Người yêu Đạt thích Đạt chạy xe SH 350i, Đạt trộm xe SH 305i không giấy tờ, thì Đạt sẽ chịu những hình phạt gì ?
[2025-03-09 10:14:49,319] INFO [reasoning.auto_rag] Question validated as traffic-related via keyword: phạt
[2025-03-09 10:14:49,319] INFO [reasoning.auto_rag] Iteration 1: Retrieving documents for query: Người yêu Đạt thích Đạt chạy xe SH 350i, Đạt trộm xe SH 305i không giấy tờ, thì Đạt sẽ chịu những hình phạt gì ?
[2025-03-09 10:14:49,319] INFO [reasoning.auto_rag] Tokenized query: người_yêu đạt thích đạt chạy xe sh 350i , đạt trộm xe sh 305i không giấy_tờ , thì đạt sẽ chịu những hình_phạt gì ?
[2025-03-09 10:14:49,320] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 10:14:49,320] INFO [retrieval.retriever] Original query: 'Người yêu Đạt thích Đạt chạy xe SH 350i, Đạt trộm xe SH 305i không giấy tờ, thì Đạt sẽ chịu những hình phạt gì ?'
[2025-03-09 10:14:49,320] INFO [retrieval.retriever] Tokenized query: 'người_yêu đạt thích đạt chạy xe sh 350i , đạt trộm xe sh 305i không giấy_tờ , thì đạt sẽ chịu những hình_phạt gì ?'
[2025-03-09 10:14:49,987] INFO [retrieval.retriever] Retrieved 5 documents for query
[2025-03-09 10:14:49,987] INFO [retrieval.retriever] Top result score: 0.6353543996810913
[2025-03-09 10:14:49,987] INFO [retrieval.retriever] Score range: 0.46421319246292114 to 0.6353543996810913
[2025-03-09 10:14:49,987] INFO [reasoning.auto_rag] DocumentRetriever returned 5 documents
[2025-03-09 10:14:49,988] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 10:14:49,988] INFO [reasoning.auto_rag] Doc 1 score: 0.6353543996810913
[2025-03-09 10:14:49,988] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo chứng nhận đăng ký xe'}
[2025-03-09 10:14:49,988] INFO [reasoning.auto_rag] Doc 2 score: 0.5566648840904236
[2025-03-09 10:14:49,988] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo giấy chứng nhận kiểm định an toàn kỹ thuật và bảo vệ môi trường'}
[2025-03-09 10:14:49,988] INFO [reasoning.auto_rag] Doc 3 score: 0.5316565632820129
[2025-03-09 10:14:49,988] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo giấy phép lái xe'}
[2025-03-09 10:14:49,989] INFO [reasoning.auto_rag] Context length: 904 characters
[2025-03-09 10:14:49,990] INFO [reasoning.auto_rag] Input tokens: 855
[2025-03-09 10:14:55,621] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:14:55,624] INFO [reasoning.auto_rag] Output tokens: 765
[2025-03-09 10:14:55,624] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 10:14:55,624] INFO [reasoning.auto_rag] Need more information, next query: Tìm hiểu về mức phạt cho hành vi trộm cắp xe máy tại Việt Nam
[2025-03-09 10:14:55,625] INFO [reasoning.auto_rag] Iteration 2: Retrieving documents for query: Tìm hiểu về mức phạt cho hành vi trộm cắp xe máy tại Việt Nam
[2025-03-09 10:14:55,625] INFO [reasoning.auto_rag] Tokenized query: tìm_hiểu về mức phạt cho hành_vi trộm_cắp xe_máy tại việt_nam
[2025-03-09 10:14:55,625] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 10:14:55,626] INFO [retrieval.retriever] Original query: 'Tìm hiểu về mức phạt cho hành vi trộm cắp xe máy tại Việt Nam'
[2025-03-09 10:14:55,626] INFO [retrieval.retriever] Tokenized query: 'tìm_hiểu về mức phạt cho hành_vi trộm_cắp xe_máy tại việt_nam'
[2025-03-09 10:14:56,205] INFO [retrieval.retriever] Retrieved 3 documents for query
[2025-03-09 10:14:56,206] INFO [retrieval.retriever] Top result score: 0.7887262105941772
[2025-03-09 10:14:56,206] INFO [retrieval.retriever] Score range: 0.5 to 0.7887262105941772
[2025-03-09 10:14:56,206] INFO [reasoning.auto_rag] DocumentRetriever returned 3 documents
[2025-03-09 10:14:56,206] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 10:14:56,206] INFO [reasoning.auto_rag] Doc 1 score: 0.7887262105941772
[2025-03-09 10:14:56,206] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'ô tô', 'fine_amount': 'Tịch thu phương tiện', 'violation_type': 'lái_xe_nguy_hiểm', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Tịch thu phương tiện\nNội dung vi phạm: Đối với người điều khiển xe tái phạm hành vi điều khiển xe lạng lách, đánh võng quy định tại khoản 12 Điều 6'}
[2025-03-09 10:14:56,206] INFO [reasoning.auto_rag] Doc 2 score: 0.5031846761703491
[2025-03-09 10:14:56,206] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 30.000.000 đồng đến 40.000.000 đồng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 30.000.000 đồng đến 40.000.000 đồng\nNội dung vi phạm: Không chấp hành yêu cầu kiểm tra về chất ma túy hoặc chất kích thích khác mà pháp luật cấm sử dụng của người thi hành công vụ'}
[2025-03-09 10:14:56,207] INFO [reasoning.auto_rag] Doc 3 score: 0.5
[2025-03-09 10:14:56,207] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Phạt tiền từ 8.000.000 đồng đến 10.000.000 đồng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Phạt tiền từ 8.000.000 đồng đến 10.000.000 đồng\nNội dung vi phạm: Không chấp hành yêu cầu kiểm tra về nồng độ cồn của người thi hành công vụ'}
[2025-03-09 10:14:56,207] INFO [reasoning.auto_rag] Context length: 1534 characters
[2025-03-09 10:14:56,208] INFO [reasoning.auto_rag] Input tokens: 1167
[2025-03-09 10:15:01,955] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:15:01,958] INFO [reasoning.auto_rag] Output tokens: 848
[2025-03-09 10:15:01,958] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 10:15:01,958] INFO [reasoning.auto_rag] Need more information, next query: Tìm hiểu về mức phạt đối với hành vi trộm cắp xe máy
[2025-03-09 10:15:01,958] WARNING [reasoning.auto_rag] Exiting loop without sufficient information
[2025-03-09 10:15:01,958] INFO [utils] Function process_question completed in 12.64 seconds
[2025-03-09 10:15:01,959] INFO [__main__] Question processed in 12.64 seconds
[2025-03-09 10:15:01,960] INFO [__main__] Needs web search: True
[2025-03-09 10:15:01,960] INFO [__main__] Web search prompt triggered
[2025-03-09 10:15:01,960] INFO [__main__] Displaying results
[2025-03-09 10:15:01,961] INFO [__main__] Response generated using: Qwen2.5-14B (vLLM)
[2025-03-09 10:15:01,966] INFO [__main__] Cleaning up components
[2025-03-09 10:15:01,967] INFO [retrieval.vector_store] Closing Weaviate client connection
[2025-03-09 10:15:01,971] INFO [retrieval.vector_store] Weaviate client connection closed
[2025-03-09 10:15:01,971] INFO [__main__] Displaying web search prompt
[2025-03-09 10:16:16,029] INFO [__main__] Starting application
[2025-03-09 10:16:16,037] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:16:16,038] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:16:16,038] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:16:16,039] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:16:16,039] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:16:16,168] INFO [__main__] Starting application
[2025-03-09 10:16:16,171] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:16:16,171] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:16:16,171] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:16:16,171] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:16:16,171] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:16:16,503] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:16:16,741] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:16:16,743] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:16:16,747] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:16:16,747] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:16:16,747] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:16:16,753] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:16:16,989] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:16:16,996] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:16:16,996] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:16:16,997] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:16:17,001] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:16:22,085] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:16:22,886] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:16:22,893] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:16:22,893] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:16:23,253] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:16:23,590] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:16:23,594] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:16:23,594] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:16:24,886] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:16:24,886] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:16:24,886] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:16:24,886] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:16:24,917] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:16:24,917] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:16:24,917] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:16:24,917] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:16:24,917] INFO [__main__] Initializing web search integration
[2025-03-09 10:16:24,917] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:16:24,917] INFO [__main__] Components initialized successfully
[2025-03-09 10:16:24,918] INFO [__main__] Processing new question: Đạt ăn trộm được xe gắn máy xịn, để chở người yêu đi chơi, nếu bị bắt hình phạt sẽ như thế nào?
[2025-03-09 10:16:24,919] INFO [__main__] Processing question: Đạt ăn trộm được xe gắn máy xịn, để chở người yêu đi chơi, nếu bị bắt hình phạt sẽ như thế nào?
[2025-03-09 10:16:24,919] INFO [reasoning.auto_rag] Question validated as traffic-related via keyword: phạt
[2025-03-09 10:16:24,919] INFO [reasoning.auto_rag] Iteration 1: Retrieving documents for query: Đạt ăn trộm được xe gắn máy xịn, để chở người yêu đi chơi, nếu bị bắt hình phạt sẽ như thế nào?
[2025-03-09 10:16:24,920] INFO [reasoning.auto_rag] Tokenized query: đạt ăn_trộm được xe gắn_máy xịn , để chở người_yêu đi chơi , nếu bị bắt hình_phạt sẽ như thế_nào ?
[2025-03-09 10:16:24,920] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 10:16:24,920] INFO [retrieval.retriever] Original query: 'Đạt ăn trộm được xe gắn máy xịn, để chở người yêu đi chơi, nếu bị bắt hình phạt sẽ như thế nào?'
[2025-03-09 10:16:24,920] INFO [retrieval.retriever] Tokenized query: 'đạt ăn_trộm được xe gắn_máy xịn , để chở người_yêu đi chơi , nếu bị bắt hình_phạt sẽ như thế_nào ?'
[2025-03-09 10:16:25,973] INFO [retrieval.retriever] Retrieved 3 documents for query
[2025-03-09 10:16:25,975] INFO [retrieval.retriever] Top result score: 0.6918342113494873
[2025-03-09 10:16:25,976] INFO [retrieval.retriever] Score range: 0.5228497385978699 to 0.6918342113494873
[2025-03-09 10:16:25,976] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:16:25,976] INFO [reasoning.auto_rag] DocumentRetriever returned 3 documents
[2025-03-09 10:16:25,976] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:16:25,976] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 10:16:25,976] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:16:25,977] INFO [reasoning.auto_rag] Doc 1 score: 0.6918342113494873
[2025-03-09 10:16:25,977] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:16:25,977] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'ô tô chở khách', 'fine_amount': 'Phạt tiền từ 1.000.000 đồng đến 2.000.000 đồng', 'violation_type': 'an_toàn', 'original_text': 'Loại phương tiện: ô tô chở khách\nMức phạt: Phạt tiền từ 1.000.000 đồng đến 2.000.000 đồng\nNội dung vi phạm: Không lắp thiết bị ghi nhận hình ảnh người lái xe hoặc làm sai lệch dữ liệu'}
[2025-03-09 10:16:25,977] INFO [reasoning.auto_rag] Doc 2 score: 0.5499253273010254
[2025-03-09 10:16:25,978] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 800.000 đồng đến 1.000.000 đồng', 'violation_type': 'chở_người', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 800.000 đồng đến 1.000.000 đồng\nNội dung vi phạm: Chở người trên xe được kéo, trừ người điều khiển'}
[2025-03-09 10:16:25,978] INFO [reasoning.auto_rag] Doc 3 score: 0.5228497385978699
[2025-03-09 10:16:25,978] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Phạt tiền từ 600.000 đồng đến 800.000 đồng', 'violation_type': 'lái_xe_nguy_hiểm', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Phạt tiền từ 600.000 đồng đến 800.000 đồng\nNội dung vi phạm: Người đang điều khiển xe hoặc chở người ngồi trên xe bám, kéo, đẩy xe khác, vật khác'}
[2025-03-09 10:16:25,978] INFO [reasoning.auto_rag] Context length: 555 characters
[2025-03-09 10:16:25,979] INFO [reasoning.auto_rag] Input tokens: 673
[2025-03-09 10:16:26,014] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:16:26,014] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:16:26,014] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:16:26,014] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:16:26,015] INFO [__main__] Initializing web search integration
[2025-03-09 10:16:26,015] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:16:26,016] INFO [__main__] Components initialized successfully
[2025-03-09 10:16:31,556] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:16:31,559] INFO [reasoning.auto_rag] Output tokens: 846
[2025-03-09 10:16:31,560] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 10:16:31,560] INFO [reasoning.auto_rag] Need more information, next query: Tìm hiểu về mức phạt đối với hành vi ăn trộm xe gắn máy theo luật hình sự Việt Nam
[2025-03-09 10:16:31,560] INFO [reasoning.auto_rag] Iteration 2: Retrieving documents for query: Tìm hiểu về mức phạt đối với hành vi ăn trộm xe gắn máy theo luật hình sự Việt Nam
[2025-03-09 10:16:31,560] INFO [reasoning.auto_rag] Tokenized query: tìm_hiểu về mức phạt đối_với hành_vi ăn_trộm xe gắn_máy theo luật hình_sự việt_nam
[2025-03-09 10:16:31,560] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 10:16:31,561] INFO [retrieval.retriever] Original query: 'Tìm hiểu về mức phạt đối với hành vi ăn trộm xe gắn máy theo luật hình sự Việt Nam'
[2025-03-09 10:16:31,561] INFO [retrieval.retriever] Tokenized query: 'tìm_hiểu về mức phạt đối_với hành_vi ăn_trộm xe gắn_máy theo luật hình_sự việt_nam'
[2025-03-09 10:16:32,181] INFO [retrieval.retriever] Retrieved 3 documents for query
[2025-03-09 10:16:32,181] INFO [retrieval.retriever] Top result score: 0.6553373336791992
[2025-03-09 10:16:32,181] INFO [retrieval.retriever] Score range: 0.5 to 0.6553373336791992
[2025-03-09 10:16:32,182] INFO [reasoning.auto_rag] DocumentRetriever returned 3 documents
[2025-03-09 10:16:32,182] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 10:16:32,182] INFO [reasoning.auto_rag] Doc 1 score: 0.6553373336791992
[2025-03-09 10:16:32,182] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'ô tô', 'fine_amount': 'Tịch thu phương tiện', 'violation_type': 'lái_xe_nguy_hiểm', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Tịch thu phương tiện\nNội dung vi phạm: Đối với người điều khiển xe tái phạm hành vi điều khiển xe lạng lách, đánh võng quy định tại khoản 12 Điều 6'}
[2025-03-09 10:16:32,183] INFO [reasoning.auto_rag] Doc 2 score: 0.5
[2025-03-09 10:16:32,183] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Tịch thu phương tiện', 'violation_type': 'lái_xe_nguy_hiểm', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Tịch thu phương tiện\nNội dung vi phạm: Điều khiển xe chạy bằng một bánh đối với xe hai bánh, chạy bằng hai bánh đối với xe ba bánh'}
[2025-03-09 10:16:32,183] INFO [reasoning.auto_rag] Doc 3 score: 0.5
[2025-03-09 10:16:32,184] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 2.000.000 đồng đến 3.000.000 đồng', 'violation_type': 'khác', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 2.000.000 đồng đến 3.000.000 đồng\nNội dung vi phạm: Dán, lắp phù hiệu, biểu trưng nhận diện tương tự của cơ quan nhà nước, cơ quan ngoại giao...'}
[2025-03-09 10:16:32,184] INFO [reasoning.auto_rag] Context length: 1140 characters
[2025-03-09 10:16:32,185] INFO [reasoning.auto_rag] Input tokens: 968
[2025-03-09 10:16:37,700] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:16:37,703] INFO [reasoning.auto_rag] Output tokens: 882
[2025-03-09 10:16:37,703] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 10:16:37,704] INFO [reasoning.auto_rag] Need more information, next query: Tìm hiểu mức phạt đối với hành vi trộm cắp xe gắn máy Lưu ý: Câu trả lời cuối cùng chỉ được đưa ra khi đã có đầy đủ thông tin. Trong trường hợp này, chúng ta cần tìm hiểu thêm về mức phạt đối với hành vi trộm cắp xe gắn máy. Ở đây, tôi không thể đưa ra câu trả lời cuối cùng vì không có thông tin cụ thể về mức phạt đối với hành vi trộm cắp xe gắn máy trong tài liệu đã cung cấp. Ở đây, tôi chỉ có thể đưa ra câu trả lời dựa trên thông tin hiện có, và đó là không có thông tin cụ thể về mức phạt đối với hành vi trộm cắp xe gắn máy trong tài liệu đã cung cấp. Ở đây, tôi cần thêm thông tin để trả lời câu hỏi một cách chính xác. Ở đây, tôi cần tìm hiểu thêm về mức phạt đối với hành vi trộm cắp xe gắn máy. Ở đây, tôi cần tìm hiểu thêm về mức phạt đối với hành vi trộm cắp xe gắn máy. Ở đây, tôi cần tìm hiểu thêm về mức phạt đối với hành vi trộm cắp xe gắn máy. Ở đây, tôi cần tìm hiểu thêm về mức phạt đối với hành vi trộm cắp xe gắn máy. Ở đây, tôi cần tìm hiểu thêm về mức phạt đối với hành vi trộm cắp xe gắn máy. Ở đây, tôi cần tìm hiểu thêm về mức phạt đối với hành vi trộm cắp xe gắn máy. Ở đây, tôi cần tìm hiểu thêm về mức phạt đối với hành vi trộm cắp xe gắn máy
[2025-03-09 10:16:37,704] WARNING [reasoning.auto_rag] Exiting loop without sufficient information
[2025-03-09 10:16:37,704] INFO [utils] Function process_question completed in 12.79 seconds
[2025-03-09 10:16:37,705] INFO [__main__] Question processed in 12.79 seconds
[2025-03-09 10:16:37,705] INFO [__main__] Needs web search: True
[2025-03-09 10:16:37,706] INFO [__main__] Web search prompt triggered
[2025-03-09 10:16:37,706] INFO [__main__] Displaying results
[2025-03-09 10:16:37,707] INFO [__main__] Response generated using: Qwen2.5-14B (vLLM)
[2025-03-09 10:16:37,711] INFO [__main__] Cleaning up components
[2025-03-09 10:16:37,711] INFO [retrieval.vector_store] Closing Weaviate client connection
[2025-03-09 10:16:37,717] INFO [retrieval.vector_store] Weaviate client connection closed
[2025-03-09 10:16:37,717] INFO [__main__] Displaying web search prompt
[2025-03-09 10:17:00,935] INFO [__main__] Starting application
[2025-03-09 10:17:00,943] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:17:00,944] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:17:00,944] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:17:00,945] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:17:00,945] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:17:01,390] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:17:01,624] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:17:01,633] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:17:01,633] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:17:01,633] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:17:01,636] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:17:07,403] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:17:08,011] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:17:08,015] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:17:08,015] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:17:10,075] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:17:10,075] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:17:10,075] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:17:10,075] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:17:10,121] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:17:10,121] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:17:10,121] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:17:10,122] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:17:10,122] INFO [__main__] Initializing web search integration
[2025-03-09 10:17:10,122] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:17:10,122] INFO [__main__] Components initialized successfully
[2025-03-09 10:17:10,124] INFO [__main__] Displaying web search prompt
[2025-03-09 10:17:37,933] INFO [__main__] Starting application
[2025-03-09 10:17:37,934] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:17:37,934] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:17:37,935] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:17:37,935] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:17:37,935] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:17:37,955] INFO [__main__] Starting application
[2025-03-09 10:17:37,957] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:17:37,958] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:17:37,959] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:17:37,960] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:17:37,960] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:17:38,528] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:17:38,531] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:17:38,804] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:17:38,806] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:17:38,809] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:17:38,810] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:17:38,810] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:17:38,811] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:17:38,812] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:17:38,814] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:17:38,819] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:17:38,820] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:17:43,236] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:17:43,545] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:17:43,554] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:17:43,554] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:17:43,852] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:17:44,185] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:17:44,188] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:17:44,188] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:17:45,814] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:17:45,814] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:17:45,814] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:17:45,814] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:17:45,847] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:17:45,847] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:17:45,847] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:17:45,847] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:17:45,847] INFO [__main__] Initializing web search integration
[2025-03-09 10:17:45,847] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:17:45,847] INFO [__main__] Components initialized successfully
[2025-03-09 10:17:46,638] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:17:46,638] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:17:46,638] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:17:46,639] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:17:46,672] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:17:46,672] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:17:46,672] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:17:46,672] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:17:46,672] INFO [__main__] Initializing web search integration
[2025-03-09 10:17:46,672] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:17:46,672] INFO [__main__] Components initialized successfully
[2025-03-09 10:17:46,673] INFO [__main__] Processing new question: Đạt chạy xe SH chở người yêu đi chơi nhưng quên mang giấy tờ, thì sẽ bị phạt những gì ?
[2025-03-09 10:17:46,674] INFO [__main__] Processing question: Đạt chạy xe SH chở người yêu đi chơi nhưng quên mang giấy tờ, thì sẽ bị phạt những gì ?
[2025-03-09 10:17:46,674] INFO [reasoning.auto_rag] Question validated as traffic-related via keyword: phạt
[2025-03-09 10:17:46,674] INFO [reasoning.auto_rag] Iteration 1: Retrieving documents for query: Đạt chạy xe SH chở người yêu đi chơi nhưng quên mang giấy tờ, thì sẽ bị phạt những gì ?
[2025-03-09 10:17:46,674] INFO [reasoning.auto_rag] Tokenized query: đạt chạy xe sh chở người_yêu đi chơi nhưng quên mang giấy_tờ , thì sẽ bị phạt những gì ?
[2025-03-09 10:17:46,674] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 10:17:46,675] INFO [retrieval.retriever] Original query: 'Đạt chạy xe SH chở người yêu đi chơi nhưng quên mang giấy tờ, thì sẽ bị phạt những gì ?'
[2025-03-09 10:17:46,675] INFO [retrieval.retriever] Tokenized query: 'đạt chạy xe sh chở người_yêu đi chơi nhưng quên mang giấy_tờ , thì sẽ bị phạt những gì ?'
[2025-03-09 10:17:47,519] INFO [retrieval.retriever] Retrieved 5 documents for query
[2025-03-09 10:17:47,519] INFO [retrieval.retriever] Top result score: 0.832750141620636
[2025-03-09 10:17:47,520] INFO [retrieval.retriever] Score range: 0.7136579155921936 to 0.832750141620636
[2025-03-09 10:17:47,520] INFO [reasoning.auto_rag] DocumentRetriever returned 5 documents
[2025-03-09 10:17:47,521] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 10:17:47,521] INFO [reasoning.auto_rag] Doc 1 score: 0.832750141620636
[2025-03-09 10:17:47,521] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'ô tô chở khách', 'fine_amount': 'Phạt tiền từ 1.000.000 đồng đến 2.000.000 đồng', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô chở khách\nMức phạt: Phạt tiền từ 1.000.000 đồng đến 2.000.000 đồng\nNội dung vi phạm: Sử dụng hợp đồng vận tải bằng văn bản giấy không có/không mang theo danh sách hành khách'}
[2025-03-09 10:17:47,521] INFO [reasoning.auto_rag] Doc 2 score: 0.7923314571380615
[2025-03-09 10:17:47,521] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'ô tô chở hàng', 'fine_amount': 'Phạt tiền từ 800.000 đồng đến 1.000.000 đồng', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô chở hàng\nMức phạt: Phạt tiền từ 800.000 đồng đến 1.000.000 đồng\nNội dung vi phạm: Không có/không mang theo giấy vận tải, không có thiết bị truy cập giấy vận tải điện tử'}
[2025-03-09 10:17:47,522] INFO [reasoning.auto_rag] Doc 3 score: 0.7808178663253784
[2025-03-09 10:17:47,522] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 8.000.000 đồng đến 10.000.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 8.000.000 đồng đến 10.000.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Có giấy phép lái xe quốc tế do các nước tham gia Công ước 1968 cấp nhưng không mang theo giấy phép lái xe quốc gia phù hợp'}
[2025-03-09 10:17:47,522] INFO [reasoning.auto_rag] Context length: 1080 characters
[2025-03-09 10:17:47,524] INFO [reasoning.auto_rag] Input tokens: 923
[2025-03-09 10:17:53,068] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:17:53,071] INFO [reasoning.auto_rag] Output tokens: 779
[2025-03-09 10:17:53,072] INFO [reasoning.auto_rag] Decision: [Cần thêm thông tin]
[2025-03-09 10:17:53,072] INFO [reasoning.auto_rag] Need more information, next query: Tìm hiểu về mức phạt khi lái xe SH mà quên mang giấy tờ
[2025-03-09 10:17:53,072] INFO [reasoning.auto_rag] Iteration 2: Retrieving documents for query: Tìm hiểu về mức phạt khi lái xe SH mà quên mang giấy tờ
[2025-03-09 10:17:53,073] INFO [reasoning.auto_rag] Tokenized query: tìm_hiểu về mức phạt khi lái_xe sh mà quên mang giấy_tờ
[2025-03-09 10:17:53,073] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 10:17:53,074] INFO [retrieval.retriever] Original query: 'Tìm hiểu về mức phạt khi lái xe SH mà quên mang giấy tờ'
[2025-03-09 10:17:53,074] INFO [retrieval.retriever] Tokenized query: 'tìm_hiểu về mức phạt khi lái_xe sh mà quên mang giấy_tờ'
[2025-03-09 10:17:53,700] INFO [retrieval.retriever] Retrieved 5 documents for query
[2025-03-09 10:17:53,701] INFO [retrieval.retriever] Top result score: 0.9839463233947754
[2025-03-09 10:17:53,701] INFO [retrieval.retriever] Score range: 0.7874625325202942 to 0.9839463233947754
[2025-03-09 10:17:53,701] INFO [reasoning.auto_rag] DocumentRetriever returned 5 documents
[2025-03-09 10:17:53,701] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 10:17:53,702] INFO [reasoning.auto_rag] Doc 1 score: 0.9839463233947754
[2025-03-09 10:17:53,702] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo chứng nhận đăng ký xe'}
[2025-03-09 10:17:53,702] INFO [reasoning.auto_rag] Doc 2 score: 0.9026489853858948
[2025-03-09 10:17:53,702] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo giấy phép lái xe'}
[2025-03-09 10:17:53,703] INFO [reasoning.auto_rag] Doc 3 score: 0.8451886177062988
[2025-03-09 10:17:53,703] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 400.000 đồng đến 600.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 400.000 đồng đến 600.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo chứng nhận bảo hiểm bắt buộc trách nhiệm dân sự của chủ xe cơ giới còn hiệu lực'}
[2025-03-09 10:17:53,704] INFO [reasoning.auto_rag] Context length: 2117 characters
[2025-03-09 10:17:53,706] INFO [reasoning.auto_rag] Input tokens: 1435
[2025-03-09 10:17:59,314] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:17:59,319] INFO [reasoning.auto_rag] Output tokens: 747
[2025-03-09 10:17:59,319] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 10:17:59,320] INFO [reasoning.auto_rag] Need more information, next query: Tìm hiểu về mức phạt khi lái xe SH mà quên mang giấy tờ
[2025-03-09 10:17:59,321] WARNING [reasoning.auto_rag] Exiting loop without sufficient information
[2025-03-09 10:17:59,322] INFO [utils] Function process_question completed in 12.65 seconds
[2025-03-09 10:17:59,324] INFO [__main__] Question processed in 12.65 seconds
[2025-03-09 10:17:59,326] INFO [__main__] Needs web search: True
[2025-03-09 10:17:59,328] INFO [__main__] Web search prompt triggered
[2025-03-09 10:17:59,328] INFO [__main__] Displaying results
[2025-03-09 10:17:59,331] INFO [__main__] Response generated using: Qwen2.5-14B (vLLM)
[2025-03-09 10:17:59,341] INFO [__main__] Cleaning up components
[2025-03-09 10:17:59,342] INFO [retrieval.vector_store] Closing Weaviate client connection
[2025-03-09 10:17:59,351] INFO [retrieval.vector_store] Weaviate client connection closed
[2025-03-09 10:17:59,351] INFO [__main__] Displaying web search prompt
[2025-03-09 10:18:10,022] INFO [__main__] Starting application
[2025-03-09 10:18:10,023] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:18:10,023] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:18:10,024] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:18:10,024] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:18:10,024] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:18:10,146] INFO [__main__] Starting application
[2025-03-09 10:18:10,148] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:18:10,148] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:18:10,148] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:18:10,148] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:18:10,148] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:18:10,681] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:18:10,692] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:18:10,988] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:18:10,990] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:18:10,991] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:18:10,991] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:18:10,993] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:18:11,087] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:18:11,092] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:18:11,092] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:18:11,092] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:18:11,093] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:18:15,802] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:18:16,059] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:18:16,061] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:18:16,061] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:18:17,461] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:18:18,053] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:18:18,057] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:18:18,057] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:18:18,474] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:18:18,475] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:18:18,475] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:18:18,475] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:18:18,537] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:18:18,537] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:18:18,537] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:18:18,537] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:18:18,537] INFO [__main__] Initializing web search integration
[2025-03-09 10:18:18,537] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:18:18,537] INFO [__main__] Components initialized successfully
[2025-03-09 10:18:18,538] INFO [__main__] Processing new question: Đạt chạy xe gắn máy chở người yêu đi chơi nhưng quên mang giấy tờ, thì sẽ bị phạt những gì ?
[2025-03-09 10:18:18,539] INFO [__main__] Processing question: Đạt chạy xe gắn máy chở người yêu đi chơi nhưng quên mang giấy tờ, thì sẽ bị phạt những gì ?
[2025-03-09 10:18:18,539] INFO [reasoning.auto_rag] Question validated as traffic-related via keyword: phạt
[2025-03-09 10:18:18,539] INFO [reasoning.auto_rag] Iteration 1: Retrieving documents for query: Đạt chạy xe gắn máy chở người yêu đi chơi nhưng quên mang giấy tờ, thì sẽ bị phạt những gì ?
[2025-03-09 10:18:18,539] INFO [reasoning.auto_rag] Tokenized query: đạt chạy xe gắn_máy chở người_yêu đi chơi nhưng quên mang giấy_tờ , thì sẽ bị phạt những gì ?
[2025-03-09 10:18:18,539] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 10:18:18,540] INFO [retrieval.retriever] Original query: 'Đạt chạy xe gắn máy chở người yêu đi chơi nhưng quên mang giấy tờ, thì sẽ bị phạt những gì ?'
[2025-03-09 10:18:18,540] INFO [retrieval.retriever] Tokenized query: 'đạt chạy xe gắn_máy chở người_yêu đi chơi nhưng quên mang giấy_tờ , thì sẽ bị phạt những gì ?'
[2025-03-09 10:18:19,341] INFO [retrieval.retriever] Retrieved 5 documents for query
[2025-03-09 10:18:19,342] INFO [retrieval.retriever] Top result score: 0.8168169260025024
[2025-03-09 10:18:19,342] INFO [retrieval.retriever] Score range: 0.5700664520263672 to 0.8168169260025024
[2025-03-09 10:18:19,342] INFO [reasoning.auto_rag] DocumentRetriever returned 5 documents
[2025-03-09 10:18:19,342] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 10:18:19,343] INFO [reasoning.auto_rag] Doc 1 score: 0.8168169260025024
[2025-03-09 10:18:19,343] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'ô tô chở khách', 'fine_amount': 'Phạt tiền từ 1.000.000 đồng đến 2.000.000 đồng', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô chở khách\nMức phạt: Phạt tiền từ 1.000.000 đồng đến 2.000.000 đồng\nNội dung vi phạm: Sử dụng hợp đồng vận tải bằng văn bản giấy không có/không mang theo danh sách hành khách'}
[2025-03-09 10:18:19,344] INFO [reasoning.auto_rag] Doc 2 score: 0.7493516802787781
[2025-03-09 10:18:19,344] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'ô tô chở hàng', 'fine_amount': 'Phạt tiền từ 800.000 đồng đến 1.000.000 đồng', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô chở hàng\nMức phạt: Phạt tiền từ 800.000 đồng đến 1.000.000 đồng\nNội dung vi phạm: Không có/không mang theo giấy vận tải, không có thiết bị truy cập giấy vận tải điện tử'}
[2025-03-09 10:18:19,344] INFO [reasoning.auto_rag] Doc 3 score: 0.7238535284996033
[2025-03-09 10:18:19,344] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'ô tô chở khách', 'fine_amount': 'Phạt tiền từ 5.000.000 đồng đến 7.000.000 đồng', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô chở khách\nMức phạt: Phạt tiền từ 5.000.000 đồng đến 7.000.000 đồng\nNội dung vi phạm: Điều khiển xe chở hành khách không có/không gắn phù hiệu theo quy định hoặc phù hiệu hết hạn hoặc không do cơ quan có thẩm quyền cấp'}
[2025-03-09 10:18:19,344] INFO [reasoning.auto_rag] Context length: 1140 characters
[2025-03-09 10:18:19,346] INFO [reasoning.auto_rag] Input tokens: 950
[2025-03-09 10:18:20,178] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:18:20,178] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:18:20,178] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:18:20,178] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:18:20,211] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:18:20,211] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:18:20,211] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:18:20,212] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:18:20,212] INFO [__main__] Initializing web search integration
[2025-03-09 10:18:20,212] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:18:20,212] INFO [__main__] Components initialized successfully
[2025-03-09 10:18:24,861] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:18:24,865] INFO [reasoning.auto_rag] Output tokens: 821
[2025-03-09 10:18:24,865] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 10:18:24,865] INFO [reasoning.auto_rag] Need more information, next query: Tìm hiểu về mức phạt khi lái xe máy mà không mang theo giấy tờ
[2025-03-09 10:18:24,865] INFO [reasoning.auto_rag] Iteration 2: Retrieving documents for query: Tìm hiểu về mức phạt khi lái xe máy mà không mang theo giấy tờ
[2025-03-09 10:18:24,866] INFO [reasoning.auto_rag] Tokenized query: tìm_hiểu về mức phạt khi lái xe_máy mà không mang theo giấy_tờ
[2025-03-09 10:18:24,866] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 10:18:24,867] INFO [retrieval.retriever] Original query: 'Tìm hiểu về mức phạt khi lái xe máy mà không mang theo giấy tờ'
[2025-03-09 10:18:24,867] INFO [retrieval.retriever] Tokenized query: 'tìm_hiểu về mức phạt khi lái xe_máy mà không mang theo giấy_tờ'
[2025-03-09 10:18:25,444] INFO [retrieval.retriever] Retrieved 5 documents for query
[2025-03-09 10:18:25,444] INFO [retrieval.retriever] Top result score: 0.9984922409057617
[2025-03-09 10:18:25,444] INFO [retrieval.retriever] Score range: 0.7865170240402222 to 0.9984922409057617
[2025-03-09 10:18:25,444] INFO [reasoning.auto_rag] DocumentRetriever returned 5 documents
[2025-03-09 10:18:25,445] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 10:18:25,445] INFO [reasoning.auto_rag] Doc 1 score: 0.9984922409057617
[2025-03-09 10:18:25,445] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo chứng nhận đăng ký xe'}
[2025-03-09 10:18:25,445] INFO [reasoning.auto_rag] Doc 2 score: 0.9189875721931458
[2025-03-09 10:18:25,445] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo giấy phép lái xe'}
[2025-03-09 10:18:25,445] INFO [reasoning.auto_rag] Doc 3 score: 0.8416574001312256
[2025-03-09 10:18:25,446] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 400.000 đồng đến 600.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 400.000 đồng đến 600.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo chứng nhận bảo hiểm bắt buộc trách nhiệm dân sự của chủ xe cơ giới còn hiệu lực'}
[2025-03-09 10:18:25,446] INFO [reasoning.auto_rag] Context length: 2176 characters
[2025-03-09 10:18:25,448] INFO [reasoning.auto_rag] Input tokens: 1457
[2025-03-09 10:18:31,058] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:18:31,061] INFO [reasoning.auto_rag] Output tokens: 819
[2025-03-09 10:18:31,061] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 10:18:31,061] INFO [reasoning.auto_rag] Need more information, next query: Tìm hiểu về mức phạt khi lái xe gắn máy mà không mang theo giấy tờ
[2025-03-09 10:18:31,062] WARNING [reasoning.auto_rag] Exiting loop without sufficient information
[2025-03-09 10:18:31,062] INFO [utils] Function process_question completed in 12.52 seconds
[2025-03-09 10:18:31,063] INFO [__main__] Question processed in 12.52 seconds
[2025-03-09 10:18:31,065] INFO [__main__] Needs web search: True
[2025-03-09 10:18:31,066] INFO [__main__] Web search prompt triggered
[2025-03-09 10:18:31,067] INFO [__main__] Displaying results
[2025-03-09 10:18:31,069] INFO [__main__] Response generated using: Qwen2.5-14B (vLLM)
[2025-03-09 10:18:31,079] INFO [__main__] Cleaning up components
[2025-03-09 10:18:31,079] INFO [retrieval.vector_store] Closing Weaviate client connection
[2025-03-09 10:18:31,086] INFO [retrieval.vector_store] Weaviate client connection closed
[2025-03-09 10:18:31,086] INFO [__main__] Displaying web search prompt
[2025-03-09 10:22:50,872] INFO [__main__] Starting application
[2025-03-09 10:22:50,873] INFO [__main__] Selected LLM provider: openai
[2025-03-09 10:22:50,873] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 10:22:50,874] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:22:50,874] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:22:50,874] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:22:51,680] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:22:51,918] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:22:51,923] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:22:51,923] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:22:51,923] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:22:51,924] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:22:56,864] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:22:57,091] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:22:57,099] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:22:57,099] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:22:59,217] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:22:59,217] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:22:59,217] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 10:22:59,217] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 10:22:59,217] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:22:59,217] INFO [__main__] Initializing web search integration
[2025-03-09 10:22:59,217] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:22:59,217] INFO [__main__] Components initialized successfully
[2025-03-09 10:27:26,055] INFO [__main__] Starting application
[2025-03-09 10:27:26,056] INFO [__main__] Selected LLM provider: openai
[2025-03-09 10:27:26,056] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 10:27:26,057] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:27:26,057] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:27:26,057] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:27:26,829] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:27:27,068] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:27:27,074] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:27:27,075] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:27:27,075] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:27:27,078] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:27:32,349] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:27:32,761] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:27:32,765] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:27:32,765] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:27:34,574] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:27:34,574] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:27:34,574] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 10:27:34,574] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 10:27:34,574] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:27:34,574] INFO [__main__] Initializing web search integration
[2025-03-09 10:27:34,575] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:27:34,575] INFO [__main__] Components initialized successfully
[2025-03-09 10:33:04,540] INFO [__main__] Starting application
[2025-03-09 10:33:04,542] INFO [__main__] Initializing configurations
[2025-03-09 10:33:04,543] INFO [__main__] Configurations initialized successfully
[2025-03-09 10:33:04,543] INFO [__main__] Selected LLM provider: openai
[2025-03-09 10:33:04,543] INFO [__main__] Query simplification enabled: True
[2025-03-09 10:33:04,544] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 10:33:04,544] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:33:04,544] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:33:04,544] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:33:05,145] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:33:05,461] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:33:05,463] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:33:05,463] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:33:05,463] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:33:05,466] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:33:07,660] INFO [__main__] Starting application
[2025-03-09 10:33:07,663] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:33:07,663] INFO [__main__] Query simplification enabled: True
[2025-03-09 10:33:07,663] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:33:07,663] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:33:07,664] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:33:07,664] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:33:08,032] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:33:08,269] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:33:08,275] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:33:08,276] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:33:08,276] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:33:08,279] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:33:11,412] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:33:12,015] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:33:12,177] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:33:12,178] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:33:13,550] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:33:13,897] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:33:13,901] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:33:13,901] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:33:14,332] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:33:14,333] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:33:14,333] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 10:33:14,546] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 10:33:14,547] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:33:14,547] INFO [retrieval.query_simplifier] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 10:33:14,547] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.OPENAI
[2025-03-09 10:33:14,547] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 10:33:14,547] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 10:33:14,547] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:33:14,547] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query simplification
[2025-03-09 10:33:14,547] INFO [__main__] Initializing web search integration
[2025-03-09 10:33:14,547] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:33:14,547] INFO [__main__] Components initialized successfully
[2025-03-09 10:33:16,149] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:33:16,149] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:33:16,149] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:33:16,149] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:33:16,185] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:33:16,185] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:33:16,185] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:33:16,185] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:33:16,185] INFO [retrieval.query_simplifier] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:33:16,185] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:33:16,218] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:33:16,218] INFO [retrieval.query_simplifier] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:33:16,219] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.VLLM
[2025-03-09 10:33:16,219] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:33:16,219] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:33:16,269] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:33:16,269] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:33:16,269] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:33:16,269] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:33:16,269] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query simplification
[2025-03-09 10:33:16,269] INFO [__main__] Initializing web search integration
[2025-03-09 10:33:16,270] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:33:16,270] INFO [__main__] Components initialized successfully
[2025-03-09 10:33:21,032] INFO [__main__] Starting application
[2025-03-09 10:33:21,039] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:33:21,041] INFO [__main__] Query simplification enabled: True
[2025-03-09 10:33:21,042] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:33:21,043] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:33:21,046] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:33:21,047] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:33:21,157] INFO [__main__] Starting application
[2025-03-09 10:33:21,160] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:33:21,161] INFO [__main__] Query simplification enabled: True
[2025-03-09 10:33:21,161] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:33:21,162] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:33:21,162] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:33:21,162] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:33:21,496] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:33:21,522] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:33:21,728] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:33:21,733] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:33:21,733] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:33:21,734] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:33:21,736] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:33:21,754] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:33:21,759] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:33:21,760] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:33:21,761] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:33:21,765] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:33:26,971] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:33:26,976] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:33:27,478] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:33:27,481] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:33:27,485] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:33:27,486] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:33:27,486] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:33:27,486] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:33:29,677] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:33:29,677] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:33:29,677] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:33:29,677] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:33:29,679] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:33:29,679] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:33:29,679] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:33:29,679] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:33:29,727] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:33:29,727] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:33:29,728] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:33:29,728] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:33:29,728] INFO [retrieval.query_simplifier] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:33:29,728] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:33:29,734] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:33:29,734] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:33:29,734] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:33:29,734] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:33:29,735] INFO [retrieval.query_simplifier] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:33:29,735] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:33:29,782] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:33:29,783] INFO [retrieval.query_simplifier] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:33:29,783] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.VLLM
[2025-03-09 10:33:29,783] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:33:29,783] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:33:29,793] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:33:29,793] INFO [retrieval.query_simplifier] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:33:29,794] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.VLLM
[2025-03-09 10:33:29,794] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:33:29,794] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:33:29,831] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:33:29,831] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:33:29,831] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:33:29,831] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:33:29,831] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query simplification
[2025-03-09 10:33:29,831] INFO [__main__] Initializing web search integration
[2025-03-09 10:33:29,832] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:33:29,832] INFO [__main__] Components initialized successfully
[2025-03-09 10:33:29,980] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:33:30,126] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:33:30,127] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:33:30,127] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:33:30,127] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query simplification
[2025-03-09 10:33:30,127] INFO [__main__] Initializing web search integration
[2025-03-09 10:33:30,128] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:33:30,128] INFO [__main__] Components initialized successfully
[2025-03-09 10:33:30,128] INFO [__main__] Processing new question: Vào 1 ngày đẹp trời chủ nhất, bạn Đạt đi uống 1 thùng bia và lái xe máy SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?
[2025-03-09 10:33:30,278] INFO [__main__] Using enhanced AutoRAG with query simplification
[2025-03-09 10:33:30,278] INFO [__main__] Processing question: Vào 1 ngày đẹp trời chủ nhất, bạn Đạt đi uống 1 thùng bia và lái xe máy SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?
[2025-03-09 10:33:30,279] INFO [reasoning.enhanced_autorag] Processing question via simplified flow: Vào 1 ngày đẹp trời chủ nhất, bạn Đạt đi uống 1 thùng bia và lái xe máy SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?
[2025-03-09 10:33:30,279] INFO [retrieval.query_simplifier] Simplifying query: Vào 1 ngày đẹp trời chủ nhất, bạn Đạt đi uống 1 thùng bia và lái xe máy SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?
[2025-03-09 10:33:31,266] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:33:31,269] INFO [retrieval.query_simplifier] Successfully simplified query: 'Người lái xe máy bị phạt khi vi phạm nồng độ cồn và không mang giấy tờ?'
[2025-03-09 10:33:31,269] INFO [retrieval.query_simplifier] Detected violations: ['nồng độ cồn', 'không mang giấy tờ']
[2025-03-09 10:33:31,270] INFO [retrieval.query_simplifier] Vehicle type: xe máy
[2025-03-09 10:33:31,270] INFO [reasoning.enhanced_autorag] Original query: 'Vào 1 ngày đẹp trời chủ nhất, bạn Đạt đi uống 1 thùng bia và lái xe máy SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?'
[2025-03-09 10:33:31,271] INFO [reasoning.enhanced_autorag] Simplified query: 'Người lái xe máy bị phạt khi vi phạm nồng độ cồn và không mang giấy tờ?'
[2025-03-09 10:33:31,271] INFO [reasoning.enhanced_autorag] Query metadata: {'violations': ['nồng độ cồn', 'không mang giấy tờ'], 'vehicle_type': 'xe máy'}
[2025-03-09 10:33:31,272] INFO [reasoning.auto_rag] Question validated as traffic-related via keyword: phạt
[2025-03-09 10:33:31,272] INFO [reasoning.auto_rag] Iteration 1: Retrieving documents for query: Người lái xe máy bị phạt khi vi phạm nồng độ cồn và không mang giấy tờ?
[2025-03-09 10:33:31,275] INFO [reasoning.auto_rag] Tokenized query: người lái xe_máy bị phạt khi vi_phạm nồng_độ cồn và không mang giấy_tờ ?
[2025-03-09 10:33:31,275] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 10:33:31,276] INFO [retrieval.retriever] Original query: 'Người lái xe máy bị phạt khi vi phạm nồng độ cồn và không mang giấy tờ?'
[2025-03-09 10:33:31,276] INFO [retrieval.retriever] Tokenized query: 'người lái xe_máy bị phạt khi vi_phạm nồng_độ cồn và không mang giấy_tờ ?'
[2025-03-09 10:33:32,304] INFO [retrieval.retriever] Retrieved 3 documents for query
[2025-03-09 10:33:32,304] INFO [retrieval.retriever] Top result score: 0.9112776517868042
[2025-03-09 10:33:32,304] INFO [retrieval.retriever] Score range: 0.8123548030853271 to 0.9112776517868042
[2025-03-09 10:33:32,304] INFO [reasoning.auto_rag] DocumentRetriever returned 3 documents
[2025-03-09 10:33:32,305] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 10:33:32,305] INFO [reasoning.auto_rag] Doc 1 score: 0.9112776517868042
[2025-03-09 10:33:32,306] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'ô tô', 'fine_amount': 'Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng\nNội dung vi phạm: Không chấp hành yêu cầu kiểm tra về chất ma túy hoặc chất kích thích khác mà pháp luật cấm sử dụng'}
[2025-03-09 10:33:32,306] INFO [reasoning.auto_rag] Doc 2 score: 0.8279856443405151
[2025-03-09 10:33:32,306] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng\nNội dung vi phạm: Không chấp hành yêu cầu kiểm tra về chất ma túy hoặc chất kích thích khác mà pháp luật cấm sử dụng'}
[2025-03-09 10:33:32,306] INFO [reasoning.auto_rag] Doc 3 score: 0.8123548030853271
[2025-03-09 10:33:32,306] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 30.000.000 đồng đến 40.000.000 đồng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 30.000.000 đồng đến 40.000.000 đồng\nNội dung vi phạm: Không chấp hành yêu cầu kiểm tra về chất ma túy hoặc chất kích thích khác mà pháp luật cấm sử dụng của người thi hành công vụ'}
[2025-03-09 10:33:32,306] INFO [reasoning.auto_rag] Context length: 695 characters
[2025-03-09 10:33:32,309] INFO [reasoning.auto_rag] Input tokens: 727
[2025-03-09 10:33:37,922] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:33:37,926] INFO [reasoning.auto_rag] Output tokens: 864
[2025-03-09 10:33:37,926] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 10:33:37,926] INFO [reasoning.auto_rag] Need more information, next query: Tìm thông tin về việc người lái xe máy bị phạt khi vi phạm nồng độ cồn và không mang giấy tờ
[2025-03-09 10:33:37,927] INFO [reasoning.auto_rag] Iteration 2: Retrieving documents for query: Tìm thông tin về việc người lái xe máy bị phạt khi vi phạm nồng độ cồn và không mang giấy tờ
[2025-03-09 10:33:37,927] INFO [reasoning.auto_rag] Tokenized query: tìm thông_tin về việc người lái xe_máy bị phạt khi vi_phạm nồng_độ cồn và không mang giấy_tờ
[2025-03-09 10:33:37,927] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 10:33:37,928] INFO [retrieval.retriever] Original query: 'Tìm thông tin về việc người lái xe máy bị phạt khi vi phạm nồng độ cồn và không mang giấy tờ'
[2025-03-09 10:33:37,928] INFO [retrieval.retriever] Tokenized query: 'tìm thông_tin về việc người lái xe_máy bị phạt khi vi_phạm nồng_độ cồn và không mang giấy_tờ'
[2025-03-09 10:33:38,508] INFO [retrieval.retriever] Retrieved 3 documents for query
[2025-03-09 10:33:38,508] INFO [retrieval.retriever] Top result score: 0.9216059446334839
[2025-03-09 10:33:38,509] INFO [retrieval.retriever] Score range: 0.8256400227546692 to 0.9216059446334839
[2025-03-09 10:33:38,510] INFO [reasoning.auto_rag] DocumentRetriever returned 3 documents
[2025-03-09 10:33:38,510] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 10:33:38,510] INFO [reasoning.auto_rag] Doc 1 score: 0.9216059446334839
[2025-03-09 10:33:38,511] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'ô tô', 'fine_amount': 'Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng\nNội dung vi phạm: Không chấp hành yêu cầu kiểm tra về chất ma túy hoặc chất kích thích khác mà pháp luật cấm sử dụng'}
[2025-03-09 10:33:38,512] INFO [reasoning.auto_rag] Doc 2 score: 0.8476989269256592
[2025-03-09 10:33:38,512] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng\nNội dung vi phạm: Không chấp hành yêu cầu kiểm tra về chất ma túy hoặc chất kích thích khác mà pháp luật cấm sử dụng'}
[2025-03-09 10:33:38,513] INFO [reasoning.auto_rag] Doc 3 score: 0.8256400227546692
[2025-03-09 10:33:38,513] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 30.000.000 đồng đến 40.000.000 đồng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 30.000.000 đồng đến 40.000.000 đồng\nNội dung vi phạm: Không chấp hành yêu cầu kiểm tra về chất ma túy hoặc chất kích thích khác mà pháp luật cấm sử dụng của người thi hành công vụ'}
[2025-03-09 10:33:38,513] INFO [reasoning.auto_rag] Context length: 1392 characters
[2025-03-09 10:33:38,516] INFO [reasoning.auto_rag] Input tokens: 1081
[2025-03-09 10:33:44,168] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:33:44,171] INFO [reasoning.auto_rag] Output tokens: 863
[2025-03-09 10:33:44,171] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 10:33:44,171] INFO [reasoning.auto_rag] Need more information, next query: Tìm thông tin về mức phạt đối với người lái xe máy vi phạm nồng độ cồn và không mang giấy tờ
[2025-03-09 10:33:44,171] WARNING [reasoning.auto_rag] Exiting loop without sufficient information
[2025-03-09 10:33:44,171] INFO [utils] Function process_question completed in 13.89 seconds
[2025-03-09 10:33:44,172] INFO [__main__] Question processed in 14.04 seconds
[2025-03-09 10:33:44,173] INFO [__main__] Needs web search: True
[2025-03-09 10:33:44,173] INFO [__main__] Web search prompt triggered
[2025-03-09 10:33:44,173] INFO [__main__] Displaying results
[2025-03-09 10:33:44,173] INFO [__main__] Response generated using: Qwen2.5-14B (vLLM)
[2025-03-09 10:33:44,180] INFO [__main__] Query simplified from 'Vào 1 ngày đẹp trời chủ nhất, bạn Đạt đi uống 1 thùng bia và lái xe máy SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?' to 'Người lái xe máy bị phạt khi vi phạm nồng độ cồn và không mang giấy tờ?'
[2025-03-09 10:33:44,184] INFO [__main__] Cleaning up components
[2025-03-09 10:33:44,184] INFO [retrieval.vector_store] Closing Weaviate client connection
[2025-03-09 10:33:44,199] INFO [retrieval.vector_store] Weaviate client connection closed
[2025-03-09 10:33:44,200] INFO [__main__] Displaying web search prompt
[2025-03-09 10:34:49,151] INFO [__main__] Starting application
[2025-03-09 10:34:49,153] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:34:49,153] INFO [__main__] Query simplification enabled: True
[2025-03-09 10:34:49,153] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:34:49,153] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:34:49,153] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:34:49,153] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:34:49,238] INFO [__main__] Starting application
[2025-03-09 10:34:49,239] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:34:49,240] INFO [__main__] Query simplification enabled: True
[2025-03-09 10:34:49,241] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:34:49,241] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:34:49,241] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:34:49,241] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:34:49,597] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:34:49,750] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:34:49,831] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:34:49,836] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:34:49,836] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:34:49,837] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:34:49,838] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:34:49,990] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:34:49,995] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:34:49,995] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:34:49,995] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:34:49,996] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:34:54,751] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:34:54,982] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:34:54,987] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:34:54,987] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:34:55,358] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:34:55,677] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:34:55,681] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:34:55,681] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=5
[2025-03-09 10:34:57,031] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:34:57,031] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:34:57,031] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:34:57,031] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:34:57,081] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:34:57,081] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:34:57,082] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:34:57,082] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:34:57,082] INFO [retrieval.query_simplifier] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:34:57,082] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:34:57,117] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:34:57,117] INFO [retrieval.query_simplifier] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:34:57,117] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.VLLM
[2025-03-09 10:34:57,117] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:34:57,117] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:34:57,153] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:34:57,153] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:34:57,153] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:34:57,153] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:34:57,154] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query simplification
[2025-03-09 10:34:57,154] INFO [__main__] Initializing web search integration
[2025-03-09 10:34:57,154] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:34:57,154] INFO [__main__] Components initialized successfully
[2025-03-09 10:34:57,886] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:34:57,886] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:34:57,886] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:34:57,886] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:34:58,050] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:34:58,050] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:34:58,050] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:34:58,050] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:34:58,051] INFO [retrieval.query_simplifier] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:34:58,051] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:34:58,200] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:34:58,200] INFO [retrieval.query_simplifier] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:34:58,200] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.VLLM
[2025-03-09 10:34:58,200] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:34:58,200] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:34:58,241] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:34:58,241] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:34:58,241] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:34:58,241] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:34:58,241] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query simplification
[2025-03-09 10:34:58,241] INFO [__main__] Initializing web search integration
[2025-03-09 10:34:58,242] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:34:58,242] INFO [__main__] Components initialized successfully
[2025-03-09 10:34:58,242] INFO [__main__] Processing new question: Hôm qua tôi chạy xe máy 70km/h trên đường nội thành, vượt đèn đỏ và có nồng độ cồn 0.3mg/L thì bị phạt bao nhiêu?
[2025-03-09 10:34:58,243] INFO [__main__] Using enhanced AutoRAG with query simplification
[2025-03-09 10:34:58,243] INFO [__main__] Processing question: Hôm qua tôi chạy xe máy 70km/h trên đường nội thành, vượt đèn đỏ và có nồng độ cồn 0.3mg/L thì bị phạt bao nhiêu?
[2025-03-09 10:34:58,244] INFO [reasoning.enhanced_autorag] Processing question via simplified flow: Hôm qua tôi chạy xe máy 70km/h trên đường nội thành, vượt đèn đỏ và có nồng độ cồn 0.3mg/L thì bị phạt bao nhiêu?
[2025-03-09 10:34:58,244] INFO [retrieval.query_simplifier] Simplifying query: Hôm qua tôi chạy xe máy 70km/h trên đường nội thành, vượt đèn đỏ và có nồng độ cồn 0.3mg/L thì bị phạt bao nhiêu?
[2025-03-09 10:35:03,614] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:35:03,616] INFO [retrieval.query_simplifier] Successfully simplified query: 'Tôi bị phạt bao nhiêu khi chạy xe máy 70km/h, vượt đèn đỏ và có nồng độ cồn 0.3mg/L?'
[2025-03-09 10:35:03,616] INFO [retrieval.query_simplifier] Detected violations: ['Đi quá tốc độ cho phép', 'Vượt đèn đỏ', 'Đi xe có nồng độ cồn']
[2025-03-09 10:35:03,617] INFO [retrieval.query_simplifier] Vehicle type: xe máy
[2025-03-09 10:35:03,617] INFO [reasoning.enhanced_autorag] Original query: 'Hôm qua tôi chạy xe máy 70km/h trên đường nội thành, vượt đèn đỏ và có nồng độ cồn 0.3mg/L thì bị phạt bao nhiêu?'
[2025-03-09 10:35:03,617] INFO [reasoning.enhanced_autorag] Simplified query: 'Tôi bị phạt bao nhiêu khi chạy xe máy 70km/h, vượt đèn đỏ và có nồng độ cồn 0.3mg/L?'
[2025-03-09 10:35:03,617] INFO [reasoning.enhanced_autorag] Query metadata: {'violations': ['Đi quá tốc độ cho phép', 'Vượt đèn đỏ', 'Đi xe có nồng độ cồn'], 'vehicle_type': 'xe máy'}
[2025-03-09 10:35:03,617] INFO [reasoning.auto_rag] Question validated as traffic-related via keyword: phạt
[2025-03-09 10:35:03,618] INFO [reasoning.auto_rag] Iteration 1: Retrieving documents for query: Tôi bị phạt bao nhiêu khi chạy xe máy 70km/h, vượt đèn đỏ và có nồng độ cồn 0.3mg/L?
[2025-03-09 10:35:03,618] INFO [reasoning.auto_rag] Tokenized query: tôi bị phạt bao_nhiêu khi chạy xe_máy 70km / h , vượt đèn_đỏ và có nồng_độ cồn 0.3 mg / l ?
[2025-03-09 10:35:03,619] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 10:35:03,619] INFO [retrieval.retriever] Original query: 'Tôi bị phạt bao nhiêu khi chạy xe máy 70km/h, vượt đèn đỏ và có nồng độ cồn 0.3mg/L?'
[2025-03-09 10:35:03,620] INFO [retrieval.retriever] Tokenized query: 'tôi bị phạt bao_nhiêu khi chạy xe_máy 70km / h , vượt đèn_đỏ và có nồng_độ cồn 0.3 mg / l ?'
[2025-03-09 10:35:04,466] INFO [retrieval.retriever] Retrieved 3 documents for query
[2025-03-09 10:35:04,467] INFO [retrieval.retriever] Top result score: 0.9233344793319702
[2025-03-09 10:35:04,467] INFO [retrieval.retriever] Score range: 0.8719886541366577 to 0.9233344793319702
[2025-03-09 10:35:04,468] INFO [reasoning.auto_rag] DocumentRetriever returned 3 documents
[2025-03-09 10:35:04,469] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 10:35:04,469] INFO [reasoning.auto_rag] Doc 1 score: 0.9233344793319702
[2025-03-09 10:35:04,469] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'ô tô', 'fine_amount': 'Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng\nNội dung vi phạm: Không chấp hành yêu cầu kiểm tra về chất ma túy hoặc chất kích thích khác mà pháp luật cấm sử dụng'}
[2025-03-09 10:35:04,470] INFO [reasoning.auto_rag] Doc 2 score: 0.9222135543823242
[2025-03-09 10:35:04,470] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 30.000.000 đồng đến 40.000.000 đồng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 30.000.000 đồng đến 40.000.000 đồng\nNội dung vi phạm: Không chấp hành yêu cầu kiểm tra về chất ma túy hoặc chất kích thích khác mà pháp luật cấm sử dụng của người thi hành công vụ'}
[2025-03-09 10:35:04,471] INFO [reasoning.auto_rag] Doc 3 score: 0.8719886541366577
[2025-03-09 10:35:04,472] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Phạt tiền từ 2.000.000 đồng đến 3.000.000 đồng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Phạt tiền từ 2.000.000 đồng đến 3.000.000 đồng\nNội dung vi phạm: Điều khiển xe trên đường mà trong máu hoặc hơi thở có nồng độ cồn nhưng chưa vượt quá 50 miligam/100 mililít máu'}
[2025-03-09 10:35:04,472] INFO [reasoning.auto_rag] Context length: 695 characters
[2025-03-09 10:35:04,474] INFO [reasoning.auto_rag] Input tokens: 744
[2025-03-09 10:35:09,891] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:35:09,894] INFO [reasoning.auto_rag] Output tokens: 892
[2025-03-09 10:35:09,894] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 10:35:09,895] INFO [reasoning.auto_rag] Need more information, next query: Tìm mức phạt khi chạy xe máy 70km/h, vượt đèn đỏ và có nồng độ cồn 0.3mg/L
[2025-03-09 10:35:09,895] INFO [reasoning.auto_rag] Iteration 2: Retrieving documents for query: Tìm mức phạt khi chạy xe máy 70km/h, vượt đèn đỏ và có nồng độ cồn 0.3mg/L
[2025-03-09 10:35:09,896] INFO [reasoning.auto_rag] Tokenized query: tìm mức phạt khi chạy xe_máy 70km / h , vượt đèn_đỏ và có nồng_độ cồn 0.3 mg / l
[2025-03-09 10:35:09,896] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 10:35:09,897] INFO [retrieval.retriever] Original query: 'Tìm mức phạt khi chạy xe máy 70km/h, vượt đèn đỏ và có nồng độ cồn 0.3mg/L'
[2025-03-09 10:35:09,897] INFO [retrieval.retriever] Tokenized query: 'tìm mức phạt khi chạy xe_máy 70km / h , vượt đèn_đỏ và có nồng_độ cồn 0.3 mg / l'
[2025-03-09 10:35:10,475] INFO [retrieval.retriever] Retrieved 3 documents for query
[2025-03-09 10:35:10,475] INFO [retrieval.retriever] Top result score: 0.9323498010635376
[2025-03-09 10:35:10,475] INFO [retrieval.retriever] Score range: 0.8799012899398804 to 0.9323498010635376
[2025-03-09 10:35:10,475] INFO [reasoning.auto_rag] DocumentRetriever returned 3 documents
[2025-03-09 10:35:10,475] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 10:35:10,475] INFO [reasoning.auto_rag] Doc 1 score: 0.9323498010635376
[2025-03-09 10:35:10,476] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 30.000.000 đồng đến 40.000.000 đồng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 30.000.000 đồng đến 40.000.000 đồng\nNội dung vi phạm: Không chấp hành yêu cầu kiểm tra về chất ma túy hoặc chất kích thích khác mà pháp luật cấm sử dụng của người thi hành công vụ'}
[2025-03-09 10:35:10,476] INFO [reasoning.auto_rag] Doc 2 score: 0.8993498086929321
[2025-03-09 10:35:10,477] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'ô tô', 'fine_amount': 'Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng\nNội dung vi phạm: Không chấp hành yêu cầu kiểm tra về chất ma túy hoặc chất kích thích khác mà pháp luật cấm sử dụng'}
[2025-03-09 10:35:10,477] INFO [reasoning.auto_rag] Doc 3 score: 0.8799012899398804
[2025-03-09 10:35:10,477] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Phạt tiền từ 2.000.000 đồng đến 3.000.000 đồng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Phạt tiền từ 2.000.000 đồng đến 3.000.000 đồng\nNội dung vi phạm: Điều khiển xe trên đường mà trong máu hoặc hơi thở có nồng độ cồn nhưng chưa vượt quá 50 miligam/100 mililít máu'}
[2025-03-09 10:35:10,478] INFO [reasoning.auto_rag] Context length: 1392 characters
[2025-03-09 10:35:10,479] INFO [reasoning.auto_rag] Input tokens: 1097
[2025-03-09 10:35:15,931] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:35:15,934] INFO [reasoning.auto_rag] Output tokens: 849
[2025-03-09 10:35:15,934] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 10:35:15,935] INFO [reasoning.auto_rag] Need more information, next query: Tìm hiểu về mức phạt khi vượt đèn đỏ và vi phạm tốc độ khi điều khiển xe máy
[2025-03-09 10:35:15,935] WARNING [reasoning.auto_rag] Exiting loop without sufficient information
[2025-03-09 10:35:15,935] INFO [utils] Function process_question completed in 17.69 seconds
[2025-03-09 10:35:15,935] INFO [__main__] Question processed in 17.69 seconds
[2025-03-09 10:35:15,936] INFO [__main__] Needs web search: True
[2025-03-09 10:35:15,936] INFO [__main__] Web search prompt triggered
[2025-03-09 10:35:15,936] INFO [__main__] Displaying results
[2025-03-09 10:35:15,938] INFO [__main__] Response generated using: Qwen2.5-14B (vLLM)
[2025-03-09 10:35:15,943] INFO [__main__] Query simplified from 'Hôm qua tôi chạy xe máy 70km/h trên đường nội thành, vượt đèn đỏ và có nồng độ cồn 0.3mg/L thì bị phạt bao nhiêu?' to 'Tôi bị phạt bao nhiêu khi chạy xe máy 70km/h, vượt đèn đỏ và có nồng độ cồn 0.3mg/L?'
[2025-03-09 10:35:15,948] INFO [__main__] Cleaning up components
[2025-03-09 10:35:15,948] INFO [retrieval.vector_store] Closing Weaviate client connection
[2025-03-09 10:35:15,960] INFO [retrieval.vector_store] Weaviate client connection closed
[2025-03-09 10:35:15,961] INFO [__main__] Displaying web search prompt
[2025-03-09 10:36:56,772] INFO [__main__] Starting application
[2025-03-09 10:36:56,774] INFO [__main__] Initializing configurations
[2025-03-09 10:36:56,774] INFO [__main__] Configurations initialized successfully
[2025-03-09 10:36:56,775] INFO [__main__] Selected LLM provider: openai
[2025-03-09 10:36:56,775] INFO [__main__] Query simplification enabled: True
[2025-03-09 10:36:56,775] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 10:36:56,775] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:36:56,775] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:36:56,775] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:36:57,193] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:36:57,457] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:36:57,459] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:36:57,459] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:36:57,460] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:36:57,462] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:37:02,380] INFO [__main__] Starting application
[2025-03-09 10:37:02,388] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:37:02,389] INFO [__main__] Query simplification enabled: True
[2025-03-09 10:37:02,389] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:37:02,391] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:37:02,391] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:37:02,392] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:37:02,433] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:37:03,032] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:37:03,034] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:37:03,167] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:37:03,167] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=10
[2025-03-09 10:37:03,263] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:37:03,266] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:37:03,266] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:37:03,267] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:37:03,269] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:37:05,207] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:37:05,207] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:37:05,207] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 10:37:05,391] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 10:37:05,391] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:37:05,391] INFO [retrieval.query_simplifier] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 10:37:05,391] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.OPENAI
[2025-03-09 10:37:05,392] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 10:37:05,392] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 10:37:05,392] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:37:05,392] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query simplification
[2025-03-09 10:37:05,392] INFO [__main__] Initializing web search integration
[2025-03-09 10:37:05,392] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:37:05,392] INFO [__main__] Components initialized successfully
[2025-03-09 10:37:08,975] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:37:09,585] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:37:09,589] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:37:09,589] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=10
[2025-03-09 10:37:11,596] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:37:11,596] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:37:11,596] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:37:11,596] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:37:11,629] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:37:11,630] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:37:11,630] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:37:11,630] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:37:11,630] INFO [retrieval.query_simplifier] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:37:11,630] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:37:11,673] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:37:11,673] INFO [retrieval.query_simplifier] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:37:11,673] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.VLLM
[2025-03-09 10:37:11,673] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:37:11,673] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:37:11,707] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:37:11,707] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:37:11,707] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:37:11,707] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:37:11,708] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query simplification
[2025-03-09 10:37:11,708] INFO [__main__] Initializing web search integration
[2025-03-09 10:37:11,708] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:37:11,708] INFO [__main__] Components initialized successfully
[2025-03-09 10:37:14,481] INFO [__main__] Starting application
[2025-03-09 10:37:14,483] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:37:14,483] INFO [__main__] Query simplification enabled: True
[2025-03-09 10:37:14,483] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:37:14,484] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:37:14,484] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:37:14,485] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:37:14,591] INFO [__main__] Starting application
[2025-03-09 10:37:14,592] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:37:14,592] INFO [__main__] Query simplification enabled: True
[2025-03-09 10:37:14,592] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:37:14,592] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:37:14,592] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:37:14,592] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:37:15,114] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:37:15,126] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:37:15,422] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:37:15,428] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:37:15,431] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:37:15,431] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:37:15,432] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:37:15,433] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:37:15,433] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:37:15,434] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:37:15,439] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:37:15,446] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:37:20,133] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:37:20,439] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:37:20,441] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:37:20,441] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=10
[2025-03-09 10:37:21,885] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:37:22,602] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:37:22,603] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:37:22,603] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=10
[2025-03-09 10:37:22,605] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:37:22,605] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:37:22,605] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:37:22,605] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:37:22,647] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:37:22,647] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:37:22,647] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:37:22,647] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:37:22,648] INFO [retrieval.query_simplifier] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:37:22,648] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:37:22,685] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:37:22,685] INFO [retrieval.query_simplifier] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:37:22,685] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.VLLM
[2025-03-09 10:37:22,685] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:37:22,685] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:37:22,734] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:37:22,734] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:37:22,734] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:37:22,734] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:37:22,735] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query simplification
[2025-03-09 10:37:22,735] INFO [__main__] Initializing web search integration
[2025-03-09 10:37:22,735] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:37:22,735] INFO [__main__] Components initialized successfully
[2025-03-09 10:37:22,736] INFO [__main__] Processing new question: Hôm qua tôi chạy xe máy 70km/h trên đường nội thành, vượt đèn đỏ và có nồng độ cồn 0.3mg/L thì bị phạt bao nhiêu?
[2025-03-09 10:37:22,737] INFO [__main__] Using enhanced AutoRAG with query simplification
[2025-03-09 10:37:22,737] INFO [__main__] Processing question: Hôm qua tôi chạy xe máy 70km/h trên đường nội thành, vượt đèn đỏ và có nồng độ cồn 0.3mg/L thì bị phạt bao nhiêu?
[2025-03-09 10:37:22,737] INFO [reasoning.enhanced_autorag] Processing question via simplified flow: Hôm qua tôi chạy xe máy 70km/h trên đường nội thành, vượt đèn đỏ và có nồng độ cồn 0.3mg/L thì bị phạt bao nhiêu?
[2025-03-09 10:37:22,738] INFO [retrieval.query_simplifier] Simplifying query: Hôm qua tôi chạy xe máy 70km/h trên đường nội thành, vượt đèn đỏ và có nồng độ cồn 0.3mg/L thì bị phạt bao nhiêu?
[2025-03-09 10:37:28,222] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:37:28,224] INFO [retrieval.query_simplifier] Successfully simplified query: 'Tôi bị phạt bao nhiêu khi chạy xe máy 70km/h, vượt đèn đỏ và có nồng độ cồn 0.3mg/L?'
[2025-03-09 10:37:28,225] INFO [retrieval.query_simplifier] Detected violations: ['vượt đèn đỏ', 'nồng độ cồn', 'vi phạm tốc độ']
[2025-03-09 10:37:28,225] INFO [retrieval.query_simplifier] Vehicle type: xe máy
[2025-03-09 10:37:28,225] INFO [reasoning.enhanced_autorag] Original query: 'Hôm qua tôi chạy xe máy 70km/h trên đường nội thành, vượt đèn đỏ và có nồng độ cồn 0.3mg/L thì bị phạt bao nhiêu?'
[2025-03-09 10:37:28,225] INFO [reasoning.enhanced_autorag] Simplified query: 'Tôi bị phạt bao nhiêu khi chạy xe máy 70km/h, vượt đèn đỏ và có nồng độ cồn 0.3mg/L?'
[2025-03-09 10:37:28,225] INFO [reasoning.enhanced_autorag] Query metadata: {'violations': ['vượt đèn đỏ', 'nồng độ cồn', 'vi phạm tốc độ'], 'vehicle_type': 'xe máy'}
[2025-03-09 10:37:28,226] INFO [reasoning.auto_rag] Question validated as traffic-related via keyword: phạt
[2025-03-09 10:37:28,227] INFO [reasoning.auto_rag] Iteration 1: Retrieving documents for query: Tôi bị phạt bao nhiêu khi chạy xe máy 70km/h, vượt đèn đỏ và có nồng độ cồn 0.3mg/L?
[2025-03-09 10:37:28,230] INFO [reasoning.auto_rag] Tokenized query: tôi bị phạt bao_nhiêu khi chạy xe_máy 70km / h , vượt đèn_đỏ và có nồng_độ cồn 0.3 mg / l ?
[2025-03-09 10:37:28,231] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 10:37:28,231] INFO [retrieval.retriever] Original query: 'Tôi bị phạt bao nhiêu khi chạy xe máy 70km/h, vượt đèn đỏ và có nồng độ cồn 0.3mg/L?'
[2025-03-09 10:37:28,231] INFO [retrieval.retriever] Tokenized query: 'tôi bị phạt bao_nhiêu khi chạy xe_máy 70km / h , vượt đèn_đỏ và có nồng_độ cồn 0.3 mg / l ?'
[2025-03-09 10:37:29,141] INFO [retrieval.retriever] Retrieved 6 documents for query
[2025-03-09 10:37:29,141] INFO [retrieval.retriever] Top result score: 0.929669976234436
[2025-03-09 10:37:29,141] INFO [retrieval.retriever] Score range: 0.7910237908363342 to 0.929669976234436
[2025-03-09 10:37:29,141] INFO [reasoning.auto_rag] DocumentRetriever returned 6 documents
[2025-03-09 10:37:29,141] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 10:37:29,141] INFO [reasoning.auto_rag] Doc 1 score: 0.929669976234436
[2025-03-09 10:37:29,141] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'ô tô', 'fine_amount': 'Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng\nNội dung vi phạm: Không chấp hành yêu cầu kiểm tra về chất ma túy hoặc chất kích thích khác mà pháp luật cấm sử dụng'}
[2025-03-09 10:37:29,141] INFO [reasoning.auto_rag] Doc 2 score: 0.9096359610557556
[2025-03-09 10:37:29,141] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 30.000.000 đồng đến 40.000.000 đồng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 30.000.000 đồng đến 40.000.000 đồng\nNội dung vi phạm: Không chấp hành yêu cầu kiểm tra về chất ma túy hoặc chất kích thích khác mà pháp luật cấm sử dụng của người thi hành công vụ'}
[2025-03-09 10:37:29,141] INFO [reasoning.auto_rag] Doc 3 score: 0.9043007493019104
[2025-03-09 10:37:29,142] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Phạt tiền từ 2.000.000 đồng đến 3.000.000 đồng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Phạt tiền từ 2.000.000 đồng đến 3.000.000 đồng\nNội dung vi phạm: Điều khiển xe trên đường mà trong máu hoặc hơi thở có nồng độ cồn nhưng chưa vượt quá 50 miligam/100 mililít máu'}
[2025-03-09 10:37:29,142] INFO [reasoning.auto_rag] Context length: 1417 characters
[2025-03-09 10:37:29,143] INFO [reasoning.auto_rag] Input tokens: 1118
[2025-03-09 10:37:29,144] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:37:29,144] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:37:29,144] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:37:29,145] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:37:29,186] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:37:29,187] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:37:29,187] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:37:29,187] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:37:29,187] INFO [retrieval.query_simplifier] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:37:29,187] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:37:29,229] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:37:29,229] INFO [retrieval.query_simplifier] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:37:29,229] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.VLLM
[2025-03-09 10:37:29,229] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:37:29,229] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:37:29,273] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:37:29,273] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:37:29,273] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:37:29,273] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:37:29,273] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query simplification
[2025-03-09 10:37:29,274] INFO [__main__] Initializing web search integration
[2025-03-09 10:37:29,274] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:37:29,274] INFO [__main__] Components initialized successfully
[2025-03-09 10:37:34,672] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:37:34,675] INFO [reasoning.auto_rag] Output tokens: 846
[2025-03-09 10:37:34,675] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 10:37:34,675] INFO [reasoning.auto_rag] Need more information, next query: Tìm mức phạt khi vượt đèn đỏ và vi phạm tốc độ
[2025-03-09 10:37:34,676] INFO [reasoning.auto_rag] Iteration 2: Retrieving documents for query: Tìm mức phạt khi vượt đèn đỏ và vi phạm tốc độ
[2025-03-09 10:37:34,677] INFO [reasoning.auto_rag] Tokenized query: tìm mức phạt khi vượt đèn_đỏ và vi_phạm tốc_độ
[2025-03-09 10:37:34,677] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 10:37:34,677] INFO [retrieval.retriever] Original query: 'Tìm mức phạt khi vượt đèn đỏ và vi phạm tốc độ'
[2025-03-09 10:37:34,677] INFO [retrieval.retriever] Tokenized query: 'tìm mức phạt khi vượt đèn_đỏ và vi_phạm tốc_độ'
[2025-03-09 10:37:35,377] INFO [retrieval.retriever] Retrieved 6 documents for query
[2025-03-09 10:37:35,377] INFO [retrieval.retriever] Top result score: 0.7724458575248718
[2025-03-09 10:37:35,378] INFO [retrieval.retriever] Score range: 0.579396665096283 to 0.7724458575248718
[2025-03-09 10:37:35,378] INFO [reasoning.auto_rag] DocumentRetriever returned 6 documents
[2025-03-09 10:37:35,378] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 10:37:35,379] INFO [reasoning.auto_rag] Doc 1 score: 0.7724458575248718
[2025-03-09 10:37:35,379] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Phạt tiền từ 200.000 đồng đến 400.000 đồng', 'violation_type': 'đèn_tín_hiệu', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Phạt tiền từ 200.000 đồng đến 400.000 đồng\nNội dung vi phạm: Không có tín hiệu trước khi vượt hoặc có tín hiệu vượt xe nhưng không sử dụng trong suốt quá trình vượt xe'}
[2025-03-09 10:37:35,379] INFO [reasoning.auto_rag] Doc 2 score: 0.728181779384613
[2025-03-09 10:37:35,379] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 3.000.000 đồng đến 4.000.000 đồng', 'violation_type': 'tốc_độ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 3.000.000 đồng đến 4.000.000 đồng\nNội dung vi phạm: Lắp đặt, sử dụng còi vượt quá âm lượng quy định'}
[2025-03-09 10:37:35,379] INFO [reasoning.auto_rag] Doc 3 score: 0.699999988079071
[2025-03-09 10:37:35,379] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 10.000.000 đồng đến 12.000.000 đồng', 'violation_type': 'tốc_độ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 10.000.000 đồng đến 12.000.000 đồng\nNội dung vi phạm: Điều khiển xe đăng ký tạm thời, xe có phạm vi hoạt động hạn chế vượt quá phạm vi, tuyến đường, thời hạn'}
[2025-03-09 10:37:35,380] INFO [reasoning.auto_rag] Context length: 2670 characters
[2025-03-09 10:37:35,381] INFO [reasoning.auto_rag] Input tokens: 1742
[2025-03-09 10:37:41,022] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:37:41,025] INFO [reasoning.auto_rag] Output tokens: 773
[2025-03-09 10:37:41,026] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 10:37:41,026] INFO [reasoning.auto_rag] Need more information, next query: Tìm mức phạt cho hành vi chạy xe máy 70km/h và vượt đèn đỏ
[2025-03-09 10:37:41,026] WARNING [reasoning.auto_rag] Exiting loop without sufficient information
[2025-03-09 10:37:41,026] INFO [utils] Function process_question completed in 18.29 seconds
[2025-03-09 10:37:41,027] INFO [__main__] Question processed in 18.29 seconds
[2025-03-09 10:37:41,027] INFO [__main__] Needs web search: True
[2025-03-09 10:37:41,028] INFO [__main__] Web search prompt triggered
[2025-03-09 10:37:41,028] INFO [__main__] Displaying results
[2025-03-09 10:37:41,028] INFO [__main__] Response generated using: Qwen2.5-14B (vLLM)
[2025-03-09 10:37:41,036] INFO [__main__] Query simplified from 'Hôm qua tôi chạy xe máy 70km/h trên đường nội thành, vượt đèn đỏ và có nồng độ cồn 0.3mg/L thì bị phạt bao nhiêu?' to 'Tôi bị phạt bao nhiêu khi chạy xe máy 70km/h, vượt đèn đỏ và có nồng độ cồn 0.3mg/L?'
[2025-03-09 10:37:41,040] INFO [__main__] Cleaning up components
[2025-03-09 10:37:41,040] INFO [retrieval.vector_store] Closing Weaviate client connection
[2025-03-09 10:37:41,044] INFO [retrieval.vector_store] Weaviate client connection closed
[2025-03-09 10:37:41,046] INFO [__main__] Displaying web search prompt
[2025-03-09 10:40:25,488] INFO [__main__] Starting application
[2025-03-09 10:40:25,498] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:40:25,500] INFO [__main__] Query simplification enabled: True
[2025-03-09 10:40:25,501] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:40:25,502] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:40:25,503] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:40:25,503] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:40:25,596] INFO [__main__] Starting application
[2025-03-09 10:40:25,598] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:40:25,598] INFO [__main__] Query simplification enabled: True
[2025-03-09 10:40:25,598] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:40:25,598] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:40:25,598] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:40:25,598] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:40:26,134] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:40:26,304] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:40:26,370] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:40:26,379] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:40:26,379] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:40:26,379] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:40:26,381] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:40:26,544] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:40:26,550] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:40:26,550] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:40:26,551] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:40:26,554] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:40:30,952] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:40:31,215] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:40:31,221] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:40:31,221] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=10
[2025-03-09 10:40:31,535] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:40:32,058] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:40:32,063] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:40:32,063] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=10
[2025-03-09 10:40:33,285] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:40:33,286] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:40:33,286] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:40:33,287] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:40:33,334] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:40:33,334] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:40:33,334] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:40:33,334] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:40:33,334] INFO [retrieval.query_simplifier] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:40:33,335] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:40:33,374] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:40:33,374] INFO [retrieval.query_simplifier] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:40:33,374] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.VLLM
[2025-03-09 10:40:33,374] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:40:33,374] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:40:33,405] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:40:33,405] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:40:33,406] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:40:33,406] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:40:33,406] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query simplification
[2025-03-09 10:40:33,406] INFO [__main__] Initializing web search integration
[2025-03-09 10:40:33,406] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:40:33,406] INFO [__main__] Components initialized successfully
[2025-03-09 10:40:34,348] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:40:34,348] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:40:34,348] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:40:34,348] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:40:34,380] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:40:34,380] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:40:34,380] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:40:34,380] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:40:34,380] INFO [retrieval.query_simplifier] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:40:34,380] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:40:34,411] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:40:34,411] INFO [retrieval.query_simplifier] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:40:34,411] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.VLLM
[2025-03-09 10:40:34,411] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:40:34,411] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:40:34,442] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:40:34,442] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:40:34,442] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:40:34,442] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:40:34,442] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query simplification
[2025-03-09 10:40:34,442] INFO [__main__] Initializing web search integration
[2025-03-09 10:40:34,442] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:40:34,442] INFO [__main__] Components initialized successfully
[2025-03-09 10:40:34,443] INFO [__main__] Processing new question: Vào 1 ngày đẹp trời chủ nhất, bạn Đạt đi uống 1 thùng bia và lái xe máy SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?
[2025-03-09 10:40:34,444] INFO [__main__] Using enhanced AutoRAG with query simplification
[2025-03-09 10:40:34,444] INFO [__main__] Processing question: Vào 1 ngày đẹp trời chủ nhất, bạn Đạt đi uống 1 thùng bia và lái xe máy SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?
[2025-03-09 10:40:34,444] INFO [reasoning.enhanced_autorag] Processing question via simplified flow: Vào 1 ngày đẹp trời chủ nhất, bạn Đạt đi uống 1 thùng bia và lái xe máy SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?
[2025-03-09 10:40:34,444] INFO [retrieval.query_simplifier] Simplifying query: Vào 1 ngày đẹp trời chủ nhất, bạn Đạt đi uống 1 thùng bia và lái xe máy SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?
[2025-03-09 10:40:39,919] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:40:39,920] INFO [retrieval.query_simplifier] Successfully simplified query: 'Người lái xe máy bị phạt khi vi phạm nồng độ cồn và không mang giấy tờ?'
[2025-03-09 10:40:39,920] INFO [retrieval.query_simplifier] Detected violations: ['nồng độ cồn', 'không mang giấy tờ']
[2025-03-09 10:40:39,921] INFO [retrieval.query_simplifier] Vehicle type: xe máy
[2025-03-09 10:40:39,921] INFO [reasoning.enhanced_autorag] Original query: 'Vào 1 ngày đẹp trời chủ nhất, bạn Đạt đi uống 1 thùng bia và lái xe máy SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?'
[2025-03-09 10:40:39,921] INFO [reasoning.enhanced_autorag] Simplified query: 'Người lái xe máy bị phạt khi vi phạm nồng độ cồn và không mang giấy tờ?'
[2025-03-09 10:40:39,921] INFO [reasoning.enhanced_autorag] Query metadata: {'violations': ['nồng độ cồn', 'không mang giấy tờ'], 'vehicle_type': 'xe máy'}
[2025-03-09 10:40:39,921] INFO [reasoning.auto_rag] Question validated as traffic-related via keyword: phạt
[2025-03-09 10:40:39,921] INFO [reasoning.auto_rag] Iteration 1: Retrieving documents for query: Người lái xe máy bị phạt khi vi phạm nồng độ cồn và không mang giấy tờ?
[2025-03-09 10:40:39,921] INFO [reasoning.auto_rag] Tokenized query: người lái xe_máy bị phạt khi vi_phạm nồng_độ cồn và không mang giấy_tờ ?
[2025-03-09 10:40:39,922] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 10:40:39,922] INFO [retrieval.retriever] Original query: 'Người lái xe máy bị phạt khi vi phạm nồng độ cồn và không mang giấy tờ?'
[2025-03-09 10:40:39,922] INFO [retrieval.retriever] Tokenized query: 'người lái xe_máy bị phạt khi vi_phạm nồng_độ cồn và không mang giấy_tờ ?'
[2025-03-09 10:40:41,168] INFO [retrieval.retriever] Retrieved 6 documents for query
[2025-03-09 10:40:41,168] INFO [retrieval.retriever] Top result score: 0.9246653318405151
[2025-03-09 10:40:41,168] INFO [retrieval.retriever] Score range: 0.6030904650688171 to 0.9246653318405151
[2025-03-09 10:40:41,168] INFO [reasoning.auto_rag] DocumentRetriever returned 6 documents
[2025-03-09 10:40:41,168] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 10:40:41,168] INFO [reasoning.auto_rag] Doc 1 score: 0.9246653318405151
[2025-03-09 10:40:41,168] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'ô tô', 'fine_amount': 'Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng\nNội dung vi phạm: Không chấp hành yêu cầu kiểm tra về chất ma túy hoặc chất kích thích khác mà pháp luật cấm sử dụng'}
[2025-03-09 10:40:41,168] INFO [reasoning.auto_rag] Doc 2 score: 0.896791398525238
[2025-03-09 10:40:41,169] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng\nNội dung vi phạm: Không chấp hành yêu cầu kiểm tra về chất ma túy hoặc chất kích thích khác mà pháp luật cấm sử dụng'}
[2025-03-09 10:40:41,169] INFO [reasoning.auto_rag] Doc 3 score: 0.8288605809211731
[2025-03-09 10:40:41,169] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 30.000.000 đồng đến 40.000.000 đồng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 30.000.000 đồng đến 40.000.000 đồng\nNội dung vi phạm: Không chấp hành yêu cầu kiểm tra về chất ma túy hoặc chất kích thích khác mà pháp luật cấm sử dụng của người thi hành công vụ'}
[2025-03-09 10:40:41,169] INFO [reasoning.auto_rag] Context length: 1298 characters
[2025-03-09 10:40:41,170] INFO [reasoning.auto_rag] Input tokens: 1027
[2025-03-09 10:40:46,680] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:40:46,681] INFO [reasoning.auto_rag] Output tokens: 864
[2025-03-09 10:40:46,681] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 10:40:46,681] INFO [reasoning.auto_rag] Need more information, next query: Tìm mức phạt đối với người lái xe máy khi vi phạm nồng độ cồn và không mang giấy tờ
[2025-03-09 10:40:46,681] INFO [reasoning.auto_rag] Iteration 2: Retrieving documents for query: Tìm mức phạt đối với người lái xe máy khi vi phạm nồng độ cồn và không mang giấy tờ
[2025-03-09 10:40:46,682] INFO [reasoning.auto_rag] Tokenized query: tìm mức phạt đối_với người lái xe_máy khi vi_phạm nồng_độ cồn và không mang giấy_tờ
[2025-03-09 10:40:46,682] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 10:40:46,682] INFO [retrieval.retriever] Original query: 'Tìm mức phạt đối với người lái xe máy khi vi phạm nồng độ cồn và không mang giấy tờ'
[2025-03-09 10:40:46,682] INFO [retrieval.retriever] Tokenized query: 'tìm mức phạt đối_với người lái xe_máy khi vi_phạm nồng_độ cồn và không mang giấy_tờ'
[2025-03-09 10:40:47,421] INFO [retrieval.retriever] Retrieved 6 documents for query
[2025-03-09 10:40:47,421] INFO [retrieval.retriever] Top result score: 0.9123052358627319
[2025-03-09 10:40:47,421] INFO [retrieval.retriever] Score range: 0.5983137488365173 to 0.9123052358627319
[2025-03-09 10:40:47,422] INFO [reasoning.auto_rag] DocumentRetriever returned 6 documents
[2025-03-09 10:40:47,422] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 10:40:47,422] INFO [reasoning.auto_rag] Doc 1 score: 0.9123052358627319
[2025-03-09 10:40:47,422] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'ô tô', 'fine_amount': 'Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng\nNội dung vi phạm: Không chấp hành yêu cầu kiểm tra về chất ma túy hoặc chất kích thích khác mà pháp luật cấm sử dụng'}
[2025-03-09 10:40:47,422] INFO [reasoning.auto_rag] Doc 2 score: 0.89793860912323
[2025-03-09 10:40:47,423] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng\nNội dung vi phạm: Không chấp hành yêu cầu kiểm tra về chất ma túy hoặc chất kích thích khác mà pháp luật cấm sử dụng'}
[2025-03-09 10:40:47,423] INFO [reasoning.auto_rag] Doc 3 score: 0.8415741920471191
[2025-03-09 10:40:47,423] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 30.000.000 đồng đến 40.000.000 đồng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 30.000.000 đồng đến 40.000.000 đồng\nNội dung vi phạm: Không chấp hành yêu cầu kiểm tra về chất ma túy hoặc chất kích thích khác mà pháp luật cấm sử dụng của người thi hành công vụ'}
[2025-03-09 10:40:47,423] INFO [reasoning.auto_rag] Context length: 2601 characters
[2025-03-09 10:40:47,425] INFO [reasoning.auto_rag] Input tokens: 1681
[2025-03-09 10:40:53,029] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:40:53,032] INFO [reasoning.auto_rag] Output tokens: 857
[2025-03-09 10:40:53,033] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 10:40:53,034] INFO [reasoning.auto_rag] Need more information, next query: Tìm thông tin về mức phạt đối với người lái xe máy khi vi phạm nồng độ cồn và không mang giấy tờ
[2025-03-09 10:40:53,035] WARNING [reasoning.auto_rag] Exiting loop without sufficient information
[2025-03-09 10:40:53,035] INFO [utils] Function process_question completed in 18.59 seconds
[2025-03-09 10:40:53,036] INFO [__main__] Question processed in 18.59 seconds
[2025-03-09 10:40:53,038] INFO [__main__] Needs web search: True
[2025-03-09 10:40:53,039] INFO [__main__] Web search prompt triggered
[2025-03-09 10:40:53,041] INFO [__main__] Displaying results
[2025-03-09 10:40:53,042] INFO [__main__] Response generated using: Qwen2.5-14B (vLLM)
[2025-03-09 10:40:53,054] INFO [__main__] Query simplified from 'Vào 1 ngày đẹp trời chủ nhất, bạn Đạt đi uống 1 thùng bia và lái xe máy SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?' to 'Người lái xe máy bị phạt khi vi phạm nồng độ cồn và không mang giấy tờ?'
[2025-03-09 10:40:53,056] INFO [__main__] Cleaning up components
[2025-03-09 10:40:53,056] INFO [retrieval.vector_store] Closing Weaviate client connection
[2025-03-09 10:40:53,062] INFO [retrieval.vector_store] Weaviate client connection closed
[2025-03-09 10:40:53,063] INFO [__main__] Displaying web search prompt
[2025-03-09 10:41:21,569] INFO [__main__] Starting application
[2025-03-09 10:41:21,575] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:41:21,577] INFO [__main__] Query simplification enabled: True
[2025-03-09 10:41:21,578] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:41:21,580] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:41:21,583] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:41:21,583] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:41:21,703] INFO [__main__] Starting application
[2025-03-09 10:41:21,705] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:41:21,705] INFO [__main__] Query simplification enabled: True
[2025-03-09 10:41:21,706] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:41:21,706] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:41:21,706] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:41:21,706] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:41:22,225] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:41:22,249] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:41:22,522] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:41:22,526] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:41:22,528] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:41:22,528] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:41:22,528] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:41:22,529] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:41:22,531] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:41:22,531] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:41:22,534] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:41:22,541] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:41:26,946] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:41:27,233] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:41:27,237] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:41:27,237] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=10
[2025-03-09 10:41:27,851] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:41:28,361] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:41:28,371] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:41:28,371] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=10
[2025-03-09 10:41:29,397] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:41:29,397] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:41:29,397] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:41:29,397] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:41:29,440] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:41:29,441] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:41:29,441] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:41:29,441] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:41:29,441] INFO [retrieval.query_simplifier] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:41:29,441] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:41:29,473] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:41:29,473] INFO [retrieval.query_simplifier] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:41:29,473] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.VLLM
[2025-03-09 10:41:29,473] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:41:29,473] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:41:29,514] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:41:29,514] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:41:29,514] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:41:29,514] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:41:29,515] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query simplification
[2025-03-09 10:41:29,515] INFO [__main__] Initializing web search integration
[2025-03-09 10:41:29,515] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:41:29,515] INFO [__main__] Components initialized successfully
[2025-03-09 10:41:29,516] INFO [__main__] Processing new question: Các mức phạt khi uống rượu bia khi lái xe gắn máy
[2025-03-09 10:41:29,518] INFO [__main__] Using enhanced AutoRAG with query simplification
[2025-03-09 10:41:29,518] INFO [__main__] Processing question: Các mức phạt khi uống rượu bia khi lái xe gắn máy
[2025-03-09 10:41:29,518] INFO [reasoning.enhanced_autorag] Processing question via simplified flow: Các mức phạt khi uống rượu bia khi lái xe gắn máy
[2025-03-09 10:41:29,518] INFO [retrieval.query_simplifier] Simplifying query: Các mức phạt khi uống rượu bia khi lái xe gắn máy
[2025-03-09 10:41:30,407] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:41:30,408] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:41:30,408] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:41:30,408] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:41:30,447] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:41:30,447] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:41:30,447] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:41:30,447] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:41:30,447] INFO [retrieval.query_simplifier] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:41:30,447] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:41:30,484] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:41:30,484] INFO [retrieval.query_simplifier] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:41:30,484] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.VLLM
[2025-03-09 10:41:30,484] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:41:30,484] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:41:30,527] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:41:30,527] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:41:30,527] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:41:30,527] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:41:30,527] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query simplification
[2025-03-09 10:41:30,527] INFO [__main__] Initializing web search integration
[2025-03-09 10:41:30,528] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:41:30,528] INFO [__main__] Components initialized successfully
[2025-03-09 10:41:34,913] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:41:34,916] INFO [retrieval.query_simplifier] Successfully simplified query: 'Phạt bao nhiêu khi lái xe máy sau khi uống rượu bia?'
[2025-03-09 10:41:34,916] INFO [retrieval.query_simplifier] Detected violations: ['nồng độ cồn']
[2025-03-09 10:41:34,916] INFO [retrieval.query_simplifier] Vehicle type: xe máy
[2025-03-09 10:41:34,917] INFO [reasoning.enhanced_autorag] Original query: 'Các mức phạt khi uống rượu bia khi lái xe gắn máy'
[2025-03-09 10:41:34,917] INFO [reasoning.enhanced_autorag] Simplified query: 'Phạt bao nhiêu khi lái xe máy sau khi uống rượu bia?'
[2025-03-09 10:41:34,917] INFO [reasoning.enhanced_autorag] Query metadata: {'violations': ['nồng độ cồn'], 'vehicle_type': 'xe máy'}
[2025-03-09 10:41:34,917] INFO [reasoning.auto_rag] Question validated as traffic-related via keyword: phạt
[2025-03-09 10:41:34,917] INFO [reasoning.auto_rag] Iteration 1: Retrieving documents for query: Phạt bao nhiêu khi lái xe máy sau khi uống rượu bia?
[2025-03-09 10:41:34,917] INFO [reasoning.auto_rag] Tokenized query: phạt bao_nhiêu khi lái xe_máy sau khi uống rượu_bia ?
[2025-03-09 10:41:34,917] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 10:41:34,918] INFO [retrieval.retriever] Original query: 'Phạt bao nhiêu khi lái xe máy sau khi uống rượu bia?'
[2025-03-09 10:41:34,919] INFO [retrieval.retriever] Tokenized query: 'phạt bao_nhiêu khi lái xe_máy sau khi uống rượu_bia ?'
[2025-03-09 10:41:35,834] INFO [retrieval.retriever] Retrieved 5 documents for query
[2025-03-09 10:41:35,835] INFO [retrieval.retriever] Top result score: 0.699999988079071
[2025-03-09 10:41:35,835] INFO [retrieval.retriever] Score range: 0.34596526622772217 to 0.699999988079071
[2025-03-09 10:41:35,835] INFO [reasoning.auto_rag] DocumentRetriever returned 5 documents
[2025-03-09 10:41:35,835] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 10:41:35,836] INFO [reasoning.auto_rag] Doc 1 score: 0.699999988079071
[2025-03-09 10:41:35,836] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Phạt tiền từ 6.000.000 đồng đến 8.000.000 đồng', 'violation_type': 'lái_xe_nguy_hiểm', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Phạt tiền từ 6.000.000 đồng đến 8.000.000 đồng\nNội dung vi phạm:  Buông cả hai tay khi đang điều khiển xe; dùng chân điều khiển xe; ngồi về một bên điều khiển xe; nằm trên yên xe điều khiển xe; thay người điều khiển khi xe đang chạy; quay người về phía sau để điều khiển xe hoặc bịt mắt điều khiển xe'}
[2025-03-09 10:41:35,836] INFO [reasoning.auto_rag] Doc 2 score: 0.6878118515014648
[2025-03-09 10:41:35,837] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Tịch thu phương tiện', 'violation_type': 'lái_xe_nguy_hiểm', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Tịch thu phương tiện\nNội dung vi phạm: Nằm trên yên xe điều khiển xe; thay người điều khiển khi xe đang chạy; quay người về phía sau để điều khiển xe hoặc bịt mắt điều khiển xe'}
[2025-03-09 10:41:35,837] INFO [reasoning.auto_rag] Doc 3 score: 0.5094509720802307
[2025-03-09 10:41:35,837] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng', 'violation_type': 'lái_xe_nguy_hiểm', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng\nNội dung vi phạm: Nằm trên yên xe điều khiển xe; thay người điều khiển khi xe đang chạy; quay người về phía sau để điều khiển xe'}
[2025-03-09 10:41:35,838] INFO [reasoning.auto_rag] Context length: 1187 characters
[2025-03-09 10:41:35,839] INFO [reasoning.auto_rag] Input tokens: 941
[2025-03-09 10:41:41,365] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:41:41,368] INFO [reasoning.auto_rag] Output tokens: 843
[2025-03-09 10:41:41,369] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 10:41:41,369] INFO [reasoning.auto_rag] Need more information, next query: Tìm mức phạt khi lái xe máy sau khi uống rượu bia
[2025-03-09 10:41:41,369] INFO [reasoning.auto_rag] Iteration 2: Retrieving documents for query: Tìm mức phạt khi lái xe máy sau khi uống rượu bia
[2025-03-09 10:41:41,369] INFO [reasoning.auto_rag] Tokenized query: tìm mức phạt khi lái xe_máy sau khi uống rượu_bia
[2025-03-09 10:41:41,369] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 10:41:41,370] INFO [retrieval.retriever] Original query: 'Tìm mức phạt khi lái xe máy sau khi uống rượu bia'
[2025-03-09 10:41:41,370] INFO [retrieval.retriever] Tokenized query: 'tìm mức phạt khi lái xe_máy sau khi uống rượu_bia'
[2025-03-09 10:41:42,012] INFO [retrieval.retriever] Retrieved 4 documents for query
[2025-03-09 10:41:42,013] INFO [retrieval.retriever] Top result score: 0.7129461765289307
[2025-03-09 10:41:42,013] INFO [retrieval.retriever] Score range: 0.34598979353904724 to 0.7129461765289307
[2025-03-09 10:41:42,013] INFO [reasoning.auto_rag] DocumentRetriever returned 4 documents
[2025-03-09 10:41:42,013] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 10:41:42,013] INFO [reasoning.auto_rag] Doc 1 score: 0.7129461765289307
[2025-03-09 10:41:42,013] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Phạt tiền từ 6.000.000 đồng đến 8.000.000 đồng', 'violation_type': 'lái_xe_nguy_hiểm', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Phạt tiền từ 6.000.000 đồng đến 8.000.000 đồng\nNội dung vi phạm:  Buông cả hai tay khi đang điều khiển xe; dùng chân điều khiển xe; ngồi về một bên điều khiển xe; nằm trên yên xe điều khiển xe; thay người điều khiển khi xe đang chạy; quay người về phía sau để điều khiển xe hoặc bịt mắt điều khiển xe'}
[2025-03-09 10:41:42,014] INFO [reasoning.auto_rag] Doc 2 score: 0.6878359913825989
[2025-03-09 10:41:42,014] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Tịch thu phương tiện', 'violation_type': 'lái_xe_nguy_hiểm', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Tịch thu phương tiện\nNội dung vi phạm: Nằm trên yên xe điều khiển xe; thay người điều khiển khi xe đang chạy; quay người về phía sau để điều khiển xe hoặc bịt mắt điều khiển xe'}
[2025-03-09 10:41:42,015] INFO [reasoning.auto_rag] Doc 3 score: 0.5094569325447083
[2025-03-09 10:41:42,015] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng', 'violation_type': 'lái_xe_nguy_hiểm', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng\nNội dung vi phạm: Nằm trên yên xe điều khiển xe; thay người điều khiển khi xe đang chạy; quay người về phía sau để điều khiển xe'}
[2025-03-09 10:41:42,015] INFO [reasoning.auto_rag] Context length: 2214 characters
[2025-03-09 10:41:42,017] INFO [reasoning.auto_rag] Input tokens: 1436
[2025-03-09 10:41:47,610] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:41:47,612] INFO [reasoning.auto_rag] Output tokens: 801
[2025-03-09 10:41:47,613] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 10:41:47,613] INFO [reasoning.auto_rag] Need more information, next query: Tìm mức phạt khi lái xe máy sau khi uống rượu bia
[2025-03-09 10:41:47,613] WARNING [reasoning.auto_rag] Exiting loop without sufficient information
[2025-03-09 10:41:47,614] INFO [utils] Function process_question completed in 18.10 seconds
[2025-03-09 10:41:47,615] INFO [__main__] Question processed in 18.10 seconds
[2025-03-09 10:41:47,616] INFO [__main__] Needs web search: True
[2025-03-09 10:41:47,616] INFO [__main__] Web search prompt triggered
[2025-03-09 10:41:47,617] INFO [__main__] Displaying results
[2025-03-09 10:41:47,618] INFO [__main__] Response generated using: Qwen2.5-14B (vLLM)
[2025-03-09 10:41:47,622] INFO [__main__] Query simplified from 'Các mức phạt khi uống rượu bia khi lái xe gắn máy' to 'Phạt bao nhiêu khi lái xe máy sau khi uống rượu bia?'
[2025-03-09 10:41:47,624] INFO [__main__] Cleaning up components
[2025-03-09 10:41:47,625] INFO [retrieval.vector_store] Closing Weaviate client connection
[2025-03-09 10:41:47,626] INFO [retrieval.vector_store] Weaviate client connection closed
[2025-03-09 10:41:47,627] INFO [__main__] Displaying web search prompt
[2025-03-09 10:42:49,830] INFO [__main__] Starting application
[2025-03-09 10:42:49,834] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:42:49,835] INFO [__main__] Query simplification enabled: True
[2025-03-09 10:42:49,835] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:42:49,836] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:42:49,837] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:42:49,837] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:42:50,394] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:42:50,632] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:42:50,636] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:42:50,637] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:42:50,637] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:42:50,638] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:42:55,075] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:42:55,405] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:42:55,408] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:42:55,408] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=10
[2025-03-09 10:42:57,460] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:42:57,460] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:42:57,460] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:42:57,460] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:42:57,492] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:42:57,492] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:42:57,492] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:42:57,492] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:42:57,492] INFO [retrieval.query_simplifier] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:42:57,492] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:42:57,532] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:42:57,532] INFO [retrieval.query_simplifier] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:42:57,532] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.VLLM
[2025-03-09 10:42:57,532] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:42:57,532] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:42:57,576] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:42:57,576] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:42:57,576] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:42:57,576] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:42:57,576] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query simplification
[2025-03-09 10:42:57,576] INFO [__main__] Initializing web search integration
[2025-03-09 10:42:57,577] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:42:57,577] INFO [__main__] Components initialized successfully
[2025-03-09 10:42:57,578] INFO [__main__] Displaying web search prompt
[2025-03-09 10:43:19,821] INFO [__main__] Starting application
[2025-03-09 10:43:19,827] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:43:19,828] INFO [__main__] Query simplification enabled: True
[2025-03-09 10:43:19,830] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:43:19,830] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:43:19,830] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:43:19,831] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:43:19,940] INFO [__main__] Starting application
[2025-03-09 10:43:19,941] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:43:19,942] INFO [__main__] Query simplification enabled: True
[2025-03-09 10:43:19,942] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:43:19,942] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:43:19,942] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:43:19,942] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:43:20,307] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:43:20,460] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:43:20,528] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:43:20,538] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:43:20,538] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:43:20,539] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:43:20,541] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:43:20,716] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:43:20,722] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:43:20,722] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:43:20,723] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:43:20,726] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:43:25,622] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:43:25,976] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:43:25,979] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:43:25,979] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=10
[2025-03-09 10:43:26,656] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:43:27,148] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:43:27,153] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:43:27,153] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=10
[2025-03-09 10:43:28,036] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:43:28,036] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:43:28,036] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:43:28,036] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:43:28,068] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:43:28,068] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:43:28,068] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:43:28,068] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:43:28,068] INFO [retrieval.query_simplifier] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:43:28,068] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:43:28,116] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:43:28,116] INFO [retrieval.query_simplifier] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:43:28,116] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.VLLM
[2025-03-09 10:43:28,116] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:43:28,116] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:43:28,157] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:43:28,157] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:43:28,157] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:43:28,157] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:43:28,157] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query simplification
[2025-03-09 10:43:28,158] INFO [__main__] Initializing web search integration
[2025-03-09 10:43:28,158] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:43:28,158] INFO [__main__] Components initialized successfully
[2025-03-09 10:43:29,884] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:43:29,884] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:43:29,884] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:43:29,884] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:43:29,923] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:43:29,923] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:43:29,923] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:43:29,923] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:43:29,924] INFO [retrieval.query_simplifier] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:43:29,924] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:43:29,957] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:43:29,957] INFO [retrieval.query_simplifier] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:43:29,957] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.VLLM
[2025-03-09 10:43:29,958] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:43:29,958] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:43:29,991] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:43:29,991] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:43:29,991] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:43:29,992] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:43:29,992] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query simplification
[2025-03-09 10:43:29,992] INFO [__main__] Initializing web search integration
[2025-03-09 10:43:29,992] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:43:29,992] INFO [__main__] Components initialized successfully
[2025-03-09 10:43:29,993] INFO [__main__] Processing new question: Điều khiển xe ô tô không có chứng nhận đăng ký xe hoặc sử dụng chứng nhận đăng ký xe ô tô đã hết hạn sử dụng, hết hiệu lực (kể cả rơ moóc và sơ mi rơ moóc)
[2025-03-09 10:43:29,994] INFO [__main__] Using enhanced AutoRAG with query simplification
[2025-03-09 10:43:29,995] INFO [__main__] Processing question: Điều khiển xe ô tô không có chứng nhận đăng ký xe hoặc sử dụng chứng nhận đăng ký xe ô tô đã hết hạn sử dụng, hết hiệu lực (kể cả rơ moóc và sơ mi rơ moóc)
[2025-03-09 10:43:29,995] INFO [reasoning.enhanced_autorag] Processing question via simplified flow: Điều khiển xe ô tô không có chứng nhận đăng ký xe hoặc sử dụng chứng nhận đăng ký xe ô tô đã hết hạn sử dụng, hết hiệu lực (kể cả rơ moóc và sơ mi rơ moóc)
[2025-03-09 10:43:29,995] INFO [retrieval.query_simplifier] Simplifying query: Điều khiển xe ô tô không có chứng nhận đăng ký xe hoặc sử dụng chứng nhận đăng ký xe ô tô đã hết hạn sử dụng, hết hiệu lực (kể cả rơ moóc và sơ mi rơ moóc)
[2025-03-09 10:43:30,837] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:43:30,840] INFO [retrieval.query_simplifier] Successfully simplified query: 'Điều khiển xe ô tô không có chứng nhận đăng ký hoặc chứng nhận hết hạn'
[2025-03-09 10:43:30,840] INFO [retrieval.query_simplifier] Detected violations: ['Không có chứng nhận đăng ký', 'Chứng nhận hết hạn']
[2025-03-09 10:43:30,841] INFO [retrieval.query_simplifier] Vehicle type: ô tô
[2025-03-09 10:43:30,841] INFO [reasoning.enhanced_autorag] Original query: 'Điều khiển xe ô tô không có chứng nhận đăng ký xe hoặc sử dụng chứng nhận đăng ký xe ô tô đã hết hạn sử dụng, hết hiệu lực (kể cả rơ moóc và sơ mi rơ moóc)'
[2025-03-09 10:43:30,842] INFO [reasoning.enhanced_autorag] Simplified query: 'Điều khiển xe ô tô không có chứng nhận đăng ký hoặc chứng nhận hết hạn'
[2025-03-09 10:43:30,842] INFO [reasoning.enhanced_autorag] Query metadata: {'violations': ['Không có chứng nhận đăng ký', 'Chứng nhận hết hạn'], 'vehicle_type': 'ô tô'}
[2025-03-09 10:43:30,843] INFO [reasoning.auto_rag] Question validated as traffic-related via keyword: ô tô
[2025-03-09 10:43:30,844] INFO [reasoning.auto_rag] Iteration 1: Retrieving documents for query: Điều khiển xe ô tô không có chứng nhận đăng ký hoặc chứng nhận hết hạn
[2025-03-09 10:43:30,845] INFO [reasoning.auto_rag] Tokenized query: điều_khiển xe ô_tô không có chứng_nhận đăng_ký hoặc chứng_nhận hết hạn
[2025-03-09 10:43:30,846] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 10:43:30,847] INFO [retrieval.retriever] Original query: 'Điều khiển xe ô tô không có chứng nhận đăng ký hoặc chứng nhận hết hạn'
[2025-03-09 10:43:30,848] INFO [retrieval.retriever] Tokenized query: 'điều_khiển xe ô_tô không có chứng_nhận đăng_ký hoặc chứng_nhận hết hạn'
[2025-03-09 10:43:31,712] INFO [retrieval.retriever] Retrieved 8 documents for query
[2025-03-09 10:43:31,712] INFO [retrieval.retriever] Top result score: 0.8627218008041382
[2025-03-09 10:43:31,712] INFO [retrieval.retriever] Score range: 0.5415924787521362 to 0.8627218008041382
[2025-03-09 10:43:31,713] INFO [reasoning.auto_rag] DocumentRetriever returned 8 documents
[2025-03-09 10:43:31,713] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 10:43:31,714] INFO [reasoning.auto_rag] Doc 1 score: 0.8627218008041382
[2025-03-09 10:43:31,714] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 2.000.000 đồng đến 3.000.000 đồng', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 2.000.000 đồng đến 3.000.000 đồng\nNội dung vi phạm: Không có chứng nhận đăng ký xe hoặc hết hạn sử dụng, hết hiệu lực'}
[2025-03-09 10:43:31,714] INFO [reasoning.auto_rag] Doc 2 score: 0.8366778492927551
[2025-03-09 10:43:31,714] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'ô tô', 'fine_amount': 'Trừ 2 điểm giấy phép lái xe - Điều kiện phương tiện', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Trừ 2 điểm giấy phép lái xe - Điều kiện phương tiện\nNội dung vi phạm: Không có chứng nhận đăng ký xe/hết hạn/hết hiệu lực'}
[2025-03-09 10:43:31,714] INFO [reasoning.auto_rag] Doc 3 score: 0.7791829705238342
[2025-03-09 10:43:31,714] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Phạt tiền từ 2.000.000 đồng đến 3.000.000 đồng', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Phạt tiền từ 2.000.000 đồng đến 3.000.000 đồng\nNội dung vi phạm: Điều khiển xe không có chứng nhận đăng ký xe hoặc sử dụng chứng nhận đăng ký xe đã hết hạn sử dụng'}
[2025-03-09 10:43:31,714] INFO [reasoning.auto_rag] Context length: 1595 characters
[2025-03-09 10:43:31,716] INFO [reasoning.auto_rag] Input tokens: 1176
[2025-03-09 10:43:37,339] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:43:37,342] INFO [reasoning.auto_rag] Output tokens: 793
[2025-03-09 10:43:37,342] INFO [reasoning.auto_rag] Decision: Đã đủ thông tin
[2025-03-09 10:43:37,343] INFO [reasoning.auto_rag] Found sufficient information, returning final answer
[2025-03-09 10:43:37,343] INFO [utils] Function process_question completed in 7.35 seconds
[2025-03-09 10:43:37,344] INFO [__main__] Question processed in 7.35 seconds
[2025-03-09 10:43:37,345] INFO [__main__] Needs web search: False
[2025-03-09 10:43:37,345] INFO [__main__] Displaying results
[2025-03-09 10:43:37,346] INFO [__main__] Response generated using: Qwen2.5-14B (vLLM)
[2025-03-09 10:43:37,352] INFO [__main__] Query simplified from 'Điều khiển xe ô tô không có chứng nhận đăng ký xe hoặc sử dụng chứng nhận đăng ký xe ô tô đã hết hạn sử dụng, hết hiệu lực (kể cả rơ moóc và sơ mi rơ moóc)' to 'Điều khiển xe ô tô không có chứng nhận đăng ký hoặc chứng nhận hết hạn'
[2025-03-09 10:43:37,358] INFO [__main__] Cleaning up components
[2025-03-09 10:43:37,360] INFO [retrieval.vector_store] Closing Weaviate client connection
[2025-03-09 10:43:37,368] INFO [retrieval.vector_store] Weaviate client connection closed
[2025-03-09 10:44:40,127] INFO [__main__] Starting application
[2025-03-09 10:44:40,132] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:44:40,133] INFO [__main__] Query simplification enabled: True
[2025-03-09 10:44:40,134] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:44:40,134] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:44:40,135] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:44:40,136] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:44:40,257] INFO [__main__] Starting application
[2025-03-09 10:44:40,260] INFO [__main__] Selected LLM provider: vllm
[2025-03-09 10:44:40,260] INFO [__main__] Query simplification enabled: True
[2025-03-09 10:44:40,260] INFO [__main__] Initializing components with LLM provider: vllm
[2025-03-09 10:44:40,260] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 10:44:40,260] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 10:44:40,260] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 10:44:40,577] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:44:40,646] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 10:44:40,809] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:44:40,818] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:44:40,818] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:44:40,819] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:44:40,823] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:44:40,878] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:44:40,883] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 10:44:40,885] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 10:44:40,886] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:44:40,888] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:44:45,715] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:44:45,953] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:44:45,959] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:44:45,959] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=10
[2025-03-09 10:44:46,003] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 10:44:46,619] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 10:44:46,624] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 10:44:46,626] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=10
[2025-03-09 10:44:48,094] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:44:48,094] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:44:48,094] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:44:48,094] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:44:48,125] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:44:48,126] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:44:48,126] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:44:48,126] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:44:48,126] INFO [retrieval.query_simplifier] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:44:48,126] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:44:48,158] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:44:48,158] INFO [retrieval.query_simplifier] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:44:48,158] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.VLLM
[2025-03-09 10:44:48,158] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:44:48,158] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:44:48,195] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:44:48,195] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:44:48,195] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:44:48,195] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:44:48,195] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query simplification
[2025-03-09 10:44:48,195] INFO [__main__] Initializing web search integration
[2025-03-09 10:44:48,196] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:44:48,196] INFO [__main__] Components initialized successfully
[2025-03-09 10:44:48,196] INFO [__main__] Processing new question: Em Bảo chạy xe máy và có hành vi nằm trên yên xe khi đang điều khiển thì bị phạt ra làm sao ?
[2025-03-09 10:44:48,198] INFO [__main__] Using enhanced AutoRAG with query simplification
[2025-03-09 10:44:48,198] INFO [__main__] Processing question: Em Bảo chạy xe máy và có hành vi nằm trên yên xe khi đang điều khiển thì bị phạt ra làm sao ?
[2025-03-09 10:44:48,198] INFO [reasoning.enhanced_autorag] Processing question via simplified flow: Em Bảo chạy xe máy và có hành vi nằm trên yên xe khi đang điều khiển thì bị phạt ra làm sao ?
[2025-03-09 10:44:48,200] INFO [retrieval.query_simplifier] Simplifying query: Em Bảo chạy xe máy và có hành vi nằm trên yên xe khi đang điều khiển thì bị phạt ra làm sao ?
[2025-03-09 10:44:49,033] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 10:44:49,033] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 10:44:49,033] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:44:49,033] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:44:49,066] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:44:49,066] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:44:49,066] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:44:49,066] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:44:49,067] INFO [retrieval.query_simplifier] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:44:49,067] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:44:49,116] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:44:49,116] INFO [retrieval.query_simplifier] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:44:49,116] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.VLLM
[2025-03-09 10:44:49,116] INFO [reasoning.auto_rag] Setting up vLLM client with model: Qwen/Qwen2.5-14B-Instruct-AWQ
[2025-03-09 10:44:49,117] INFO [llm.vllm_client] Creating VLLMClient with config: {'api_url': 'http://192.168.100.125:8000', 'model_name': 'Qwen/Qwen2.5-14B-Instruct-AWQ', 'temperature': 0.2, 'max_tokens': 512, 'top_p': 0.95, 'timeout': 500, 'request_timeout': 500}
[2025-03-09 10:44:49,151] INFO [llm.vllm_client] Initialized vLLM client for model: Qwen/Qwen2.5-14B-Instruct-AWQ at http://192.168.100.125:8000
[2025-03-09 10:44:49,151] INFO [reasoning.auto_rag] Successfully initialized vLLM client with API URL: http://192.168.100.125:8000
[2025-03-09 10:44:49,151] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.VLLM
[2025-03-09 10:44:49,151] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 10:44:49,151] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query simplification
[2025-03-09 10:44:49,151] INFO [__main__] Initializing web search integration
[2025-03-09 10:44:49,151] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 10:44:49,151] INFO [__main__] Components initialized successfully
[2025-03-09 10:44:53,682] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:44:53,684] INFO [retrieval.query_simplifier] Successfully simplified query: 'Phạt như thế nào khi điều khiển xe máy mà nằm trên yên xe?'
[2025-03-09 10:44:53,685] INFO [retrieval.query_simplifier] Detected violations: ['nằm trên yên xe']
[2025-03-09 10:44:53,685] INFO [retrieval.query_simplifier] Vehicle type: xe máy
[2025-03-09 10:44:53,686] INFO [reasoning.enhanced_autorag] Original query: 'Em Bảo chạy xe máy và có hành vi nằm trên yên xe khi đang điều khiển thì bị phạt ra làm sao ?'
[2025-03-09 10:44:53,686] INFO [reasoning.enhanced_autorag] Simplified query: 'Phạt như thế nào khi điều khiển xe máy mà nằm trên yên xe?'
[2025-03-09 10:44:53,686] INFO [reasoning.enhanced_autorag] Query metadata: {'violations': ['nằm trên yên xe'], 'vehicle_type': 'xe máy'}
[2025-03-09 10:44:53,687] INFO [reasoning.auto_rag] Question validated as traffic-related via keyword: phạt
[2025-03-09 10:44:53,687] INFO [reasoning.auto_rag] Iteration 1: Retrieving documents for query: Phạt như thế nào khi điều khiển xe máy mà nằm trên yên xe?
[2025-03-09 10:44:53,688] INFO [reasoning.auto_rag] Tokenized query: phạt như thế_nào khi điều_khiển xe_máy mà nằm trên yên xe ?
[2025-03-09 10:44:53,689] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 10:44:53,690] INFO [retrieval.retriever] Original query: 'Phạt như thế nào khi điều khiển xe máy mà nằm trên yên xe?'
[2025-03-09 10:44:53,690] INFO [retrieval.retriever] Tokenized query: 'phạt như thế_nào khi điều_khiển xe_máy mà nằm trên yên xe ?'
[2025-03-09 10:44:54,587] INFO [retrieval.retriever] Retrieved 4 documents for query
[2025-03-09 10:44:54,588] INFO [retrieval.retriever] Top result score: 1.0
[2025-03-09 10:44:54,588] INFO [retrieval.retriever] Score range: 0.2705855369567871 to 1.0
[2025-03-09 10:44:54,588] INFO [reasoning.auto_rag] DocumentRetriever returned 4 documents
[2025-03-09 10:44:54,589] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 10:44:54,589] INFO [reasoning.auto_rag] Doc 1 score: 1.0
[2025-03-09 10:44:54,589] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Tịch thu phương tiện', 'violation_type': 'lái_xe_nguy_hiểm', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Tịch thu phương tiện\nNội dung vi phạm: Nằm trên yên xe điều khiển xe; thay người điều khiển khi xe đang chạy; quay người về phía sau để điều khiển xe hoặc bịt mắt điều khiển xe'}
[2025-03-09 10:44:54,589] INFO [reasoning.auto_rag] Doc 2 score: 0.882865309715271
[2025-03-09 10:44:54,589] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Phạt tiền từ 6.000.000 đồng đến 8.000.000 đồng', 'violation_type': 'lái_xe_nguy_hiểm', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Phạt tiền từ 6.000.000 đồng đến 8.000.000 đồng\nNội dung vi phạm:  Buông cả hai tay khi đang điều khiển xe; dùng chân điều khiển xe; ngồi về một bên điều khiển xe; nằm trên yên xe điều khiển xe; thay người điều khiển khi xe đang chạy; quay người về phía sau để điều khiển xe hoặc bịt mắt điều khiển xe'}
[2025-03-09 10:44:54,589] INFO [reasoning.auto_rag] Doc 3 score: 0.8184170126914978
[2025-03-09 10:44:54,590] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng', 'violation_type': 'lái_xe_nguy_hiểm', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng\nNội dung vi phạm: Nằm trên yên xe điều khiển xe; thay người điều khiển khi xe đang chạy; quay người về phía sau để điều khiển xe'}
[2025-03-09 10:44:54,590] INFO [reasoning.auto_rag] Context length: 1063 characters
[2025-03-09 10:44:54,591] INFO [reasoning.auto_rag] Input tokens: 893
[2025-03-09 10:45:00,011] INFO [httpx] HTTP Request: POST http://192.168.100.125:8000/v1/completions "HTTP/1.1 200 OK"
[2025-03-09 10:45:00,014] INFO [reasoning.auto_rag] Output tokens: 809
[2025-03-09 10:45:00,014] INFO [reasoning.auto_rag] Decision: Đã đủ thông tin
[2025-03-09 10:45:00,014] INFO [reasoning.auto_rag] Found sufficient information, returning final answer
[2025-03-09 10:45:00,015] INFO [utils] Function process_question completed in 11.82 seconds
[2025-03-09 10:45:00,015] INFO [__main__] Question processed in 11.82 seconds
[2025-03-09 10:45:00,016] INFO [__main__] Needs web search: False
[2025-03-09 10:45:00,016] INFO [__main__] Displaying results
[2025-03-09 10:45:00,017] INFO [__main__] Response generated using: Qwen2.5-14B (vLLM)
[2025-03-09 10:45:00,023] INFO [__main__] Query simplified from 'Em Bảo chạy xe máy và có hành vi nằm trên yên xe khi đang điều khiển thì bị phạt ra làm sao ?' to 'Phạt như thế nào khi điều khiển xe máy mà nằm trên yên xe?'
[2025-03-09 10:45:00,024] INFO [__main__] Cleaning up components
[2025-03-09 10:45:00,024] INFO [retrieval.vector_store] Closing Weaviate client connection
[2025-03-09 10:45:00,026] INFO [retrieval.vector_store] Weaviate client connection closed
[2025-03-09 13:52:09,483] ERROR [__main__] Error importing modules: No module named 'enhanced_autorag'
[2025-03-09 13:53:00,012] INFO [__main__] Starting application
[2025-03-09 13:53:00,013] INFO [__main__] Initializing configurations
[2025-03-09 13:53:00,013] INFO [__main__] Configurations initialized successfully
[2025-03-09 13:53:00,015] INFO [__main__] Selected LLM provider: openai
[2025-03-09 13:53:00,015] INFO [__main__] Query simplification enabled: True
[2025-03-09 13:53:00,015] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 13:53:00,016] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 13:53:00,016] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 13:53:00,016] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 13:53:00,715] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 13:53:01,022] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 13:53:01,023] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 13:53:01,024] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 13:53:01,024] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 13:53:01,026] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 13:55:42,822] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 13:55:43,430] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 13:55:43,562] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 13:55:43,562] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=10
[2025-03-09 13:55:45,752] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 13:55:45,752] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 13:55:45,752] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 13:56:19,593] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 13:56:19,593] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 13:56:19,593] INFO [retrieval.query_simplifier] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 13:56:19,593] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.OPENAI
[2025-03-09 13:56:19,593] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 13:56:19,593] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 13:56:19,593] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 13:56:19,593] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query simplification
[2025-03-09 13:56:19,593] INFO [__main__] Initializing web search integration
[2025-03-09 13:56:19,593] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 13:56:19,594] INFO [__main__] Components initialized successfully
[2025-03-09 13:56:36,771] INFO [__main__] Starting application
[2025-03-09 13:56:36,779] INFO [__main__] Selected LLM provider: openai
[2025-03-09 13:56:36,779] INFO [__main__] Query simplification enabled: True
[2025-03-09 13:56:36,780] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 13:56:36,781] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 13:56:36,781] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 13:56:36,782] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 13:56:36,889] INFO [__main__] Starting application
[2025-03-09 13:56:36,892] INFO [__main__] Selected LLM provider: openai
[2025-03-09 13:56:36,892] INFO [__main__] Query simplification enabled: True
[2025-03-09 13:56:36,892] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 13:56:36,893] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 13:56:36,893] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 13:56:36,893] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 13:56:37,392] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 13:56:37,442] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 13:56:37,625] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 13:56:37,630] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 13:56:37,630] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 13:56:37,631] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 13:56:37,634] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 13:56:37,701] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 13:56:37,704] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 13:56:37,705] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 13:56:37,705] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 13:56:37,708] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 13:56:43,137] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 13:56:43,443] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 13:56:43,457] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 13:56:43,460] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 13:56:43,460] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=10
[2025-03-09 13:56:43,950] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 13:56:43,955] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 13:56:43,955] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=10
[2025-03-09 13:56:45,719] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 13:56:45,719] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 13:56:45,719] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 13:56:45,719] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 13:56:45,719] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 13:56:45,719] INFO [retrieval.query_simplifier] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 13:56:45,719] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.OPENAI
[2025-03-09 13:56:45,719] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 13:56:45,719] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 13:56:45,719] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 13:56:45,719] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query simplification
[2025-03-09 13:56:45,719] INFO [__main__] Initializing web search integration
[2025-03-09 13:56:45,719] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 13:56:45,719] INFO [__main__] Components initialized successfully
[2025-03-09 13:56:46,427] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 13:56:46,428] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 13:56:46,428] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 13:56:46,429] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 13:56:46,429] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 13:56:46,429] INFO [retrieval.query_simplifier] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 13:56:46,430] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.OPENAI
[2025-03-09 13:56:46,430] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 13:56:46,431] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 13:56:46,431] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 13:56:46,431] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query simplification
[2025-03-09 13:56:46,432] INFO [__main__] Initializing web search integration
[2025-03-09 13:56:46,432] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 13:56:46,432] INFO [__main__] Components initialized successfully
[2025-03-09 13:56:46,435] INFO [__main__] Processing new question: Vào 1 ngày đẹp trời chủ nhất, bạn Đạt đi uống 1 thùng bia và lái xe máy SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?
[2025-03-09 13:56:46,439] INFO [__main__] Using enhanced AutoRAG with query simplification
[2025-03-09 13:56:46,441] INFO [__main__] Processing question: Vào 1 ngày đẹp trời chủ nhất, bạn Đạt đi uống 1 thùng bia và lái xe máy SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?
[2025-03-09 13:56:46,442] ERROR [reasoning.enhanced_autorag] Error in EnhancedAutoRAG: name 'standardized_query' is not defined
[2025-03-09 13:56:46,442] INFO [utils] Function process_question completed in 0.00 seconds
[2025-03-09 13:56:46,443] INFO [__main__] Question processed in 0.01 seconds
[2025-03-09 13:56:46,444] ERROR [__main__] Error in response: Error processing question: name 'standardized_query' is not defined
[2025-03-09 13:56:46,445] INFO [__main__] Cleaning up components
[2025-03-09 13:56:46,445] INFO [retrieval.vector_store] Closing Weaviate client connection
[2025-03-09 13:56:46,458] INFO [retrieval.vector_store] Weaviate client connection closed
[2025-03-09 14:06:38,429] INFO [__main__] Starting application
[2025-03-09 14:06:38,431] INFO [__main__] Initializing configurations
[2025-03-09 14:06:38,431] INFO [__main__] Configurations initialized successfully
[2025-03-09 14:06:38,432] INFO [__main__] Selected LLM provider: openai
[2025-03-09 14:06:38,432] INFO [__main__] Query simplification enabled: True
[2025-03-09 14:06:38,432] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 14:06:38,432] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 14:06:38,432] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 14:06:38,432] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 14:06:39,288] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 14:06:39,592] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 14:06:39,597] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 14:06:39,597] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 14:06:39,598] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:06:39,600] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:06:47,715] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 14:06:48,323] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 14:06:48,430] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 14:06:48,430] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=10
[2025-03-09 14:06:50,347] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:06:50,347] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 14:06:50,347] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:06:50,503] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:06:50,503] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 14:06:50,503] INFO [retrieval.query_simplifier] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:06:50,503] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:06:50,503] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:06:50,503] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:06:50,504] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 14:06:50,504] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query standardization
[2025-03-09 14:06:50,504] INFO [__main__] Initializing web search integration
[2025-03-09 14:06:50,504] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 14:06:50,504] INFO [__main__] Components initialized successfully
[2025-03-09 14:06:54,366] INFO [__main__] Starting application
[2025-03-09 14:06:54,371] INFO [__main__] Selected LLM provider: openai
[2025-03-09 14:06:54,372] INFO [__main__] Query simplification enabled: True
[2025-03-09 14:06:54,374] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 14:06:54,376] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 14:06:54,377] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 14:06:54,378] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 14:06:54,478] INFO [__main__] Starting application
[2025-03-09 14:06:54,483] INFO [__main__] Selected LLM provider: openai
[2025-03-09 14:06:54,483] INFO [__main__] Query simplification enabled: True
[2025-03-09 14:06:54,483] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 14:06:54,484] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 14:06:54,484] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 14:06:54,484] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 14:06:54,806] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 14:06:55,075] INFO [__main__] Starting application
[2025-03-09 14:06:55,088] INFO [__main__] Selected LLM provider: openai
[2025-03-09 14:06:55,089] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 14:06:55,089] INFO [__main__] Query simplification enabled: True
[2025-03-09 14:06:55,092] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 14:06:55,093] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 14:06:55,094] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 14:06:55,095] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 14:06:55,098] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 14:06:55,102] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 14:06:55,103] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 14:06:55,105] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:06:55,109] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:06:55,318] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 14:06:55,324] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 14:06:55,325] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 14:06:55,326] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:06:55,329] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:06:55,530] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 14:06:55,775] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 14:06:55,781] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 14:06:55,782] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 14:06:55,782] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:06:55,785] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:07:01,177] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 14:07:01,736] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 14:07:01,737] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 14:07:01,737] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=10
[2025-03-09 14:07:01,833] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 14:07:02,380] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 14:07:02,382] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 14:07:02,382] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=10
[2025-03-09 14:07:03,841] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:07:03,841] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 14:07:03,841] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:07:03,842] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:07:03,843] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 14:07:03,844] INFO [retrieval.query_simplifier] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:07:03,845] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:07:03,845] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:07:03,845] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:07:03,846] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 14:07:03,846] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query standardization
[2025-03-09 14:07:03,846] INFO [__main__] Initializing web search integration
[2025-03-09 14:07:03,846] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 14:07:03,846] INFO [__main__] Components initialized successfully
[2025-03-09 14:07:03,847] INFO [__main__] Processing new question: Vào 1 ngày đẹp trời chủ nhất, bạn Đạt đi uống 1 thùng bia và lái xe máy SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?
[2025-03-09 14:07:03,848] INFO [__main__] Using enhanced AutoRAG with query simplification
[2025-03-09 14:07:03,849] INFO [__main__] Processing question: Vào 1 ngày đẹp trời chủ nhất, bạn Đạt đi uống 1 thùng bia và lái xe máy SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?
[2025-03-09 14:07:03,850] INFO [reasoning.enhanced_autorag] Processing question via standardized flow: Vào 1 ngày đẹp trời chủ nhất, bạn Đạt đi uống 1 thùng bia và lái xe máy SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?
[2025-03-09 14:07:03,850] INFO [retrieval.query_simplifier] Standardizing query: Vào 1 ngày đẹp trời chủ nhất, bạn Đạt đi uống 1 thùng bia và lái xe máy SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?
[2025-03-09 14:07:04,600] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:07:04,600] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 14:07:04,601] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:07:04,601] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:07:04,601] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 14:07:04,602] INFO [retrieval.query_simplifier] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:07:04,602] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:07:04,602] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:07:04,602] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:07:04,602] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 14:07:04,602] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query standardization
[2025-03-09 14:07:04,602] INFO [__main__] Initializing web search integration
[2025-03-09 14:07:04,602] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 14:07:04,603] INFO [__main__] Components initialized successfully
[2025-03-09 14:07:04,603] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 14:07:05,627] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 14:07:05,631] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 14:07:05,631] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=10
[2025-03-09 14:07:06,340] INFO [httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-03-09 14:07:06,365] INFO [retrieval.query_simplifier] Successfully standardized query: 'Đối với xe máy, vi phạm không mang giấy tờ và vi phạm nồng độ cồn sẽ bị xử phạt như thế nào?'
[2025-03-09 14:07:06,366] INFO [retrieval.query_simplifier] Detected violations: ['không mang giấy tờ', 'nồng độ cồn']
[2025-03-09 14:07:06,367] INFO [retrieval.query_simplifier] Vehicle type: xe máy
[2025-03-09 14:07:06,368] INFO [retrieval.query_simplifier] Penalty types: ['tiền phạt']
[2025-03-09 14:07:06,368] INFO [reasoning.enhanced_autorag] Original query: 'Vào 1 ngày đẹp trời chủ nhất, bạn Đạt đi uống 1 thùng bia và lái xe máy SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?'
[2025-03-09 14:07:06,369] INFO [reasoning.enhanced_autorag] Standardized query: 'Đối với xe máy, vi phạm không mang giấy tờ và vi phạm nồng độ cồn sẽ bị xử phạt như thế nào?'
[2025-03-09 14:07:06,370] INFO [reasoning.enhanced_autorag] Query metadata: {'violations': ['không mang giấy tờ', 'nồng độ cồn'], 'vehicle_type': 'xe máy', 'penalty_types': ['tiền phạt']}
[2025-03-09 14:07:06,370] INFO [reasoning.auto_rag] Question validated as traffic-related via keyword: phạt
[2025-03-09 14:07:06,370] INFO [reasoning.auto_rag] Iteration 1: Retrieving documents for query: Đối với xe máy, vi phạm không mang giấy tờ và vi phạm nồng độ cồn sẽ bị xử phạt như thế nào?
[2025-03-09 14:07:06,376] INFO [reasoning.auto_rag] Tokenized query: đối_với xe_máy , vi_phạm không mang giấy_tờ và vi_phạm nồng_độ cồn sẽ bị xử_phạt như thế_nào ?
[2025-03-09 14:07:06,376] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 14:07:06,377] INFO [retrieval.retriever] Original query: 'Đối với xe máy, vi phạm không mang giấy tờ và vi phạm nồng độ cồn sẽ bị xử phạt như thế nào?'
[2025-03-09 14:07:06,378] INFO [retrieval.retriever] Tokenized query: 'đối_với xe_máy , vi_phạm không mang giấy_tờ và vi_phạm nồng_độ cồn sẽ bị xử_phạt như thế_nào ?'
[2025-03-09 14:07:07,776] INFO [retrieval.retriever] Retrieved 6 documents for query
[2025-03-09 14:07:07,777] INFO [retrieval.retriever] Top result score: 0.8935350775718689
[2025-03-09 14:07:07,777] INFO [retrieval.retriever] Score range: 0.4787999093532562 to 0.8935350775718689
[2025-03-09 14:07:07,777] INFO [reasoning.auto_rag] DocumentRetriever returned 6 documents
[2025-03-09 14:07:07,778] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 14:07:07,778] INFO [reasoning.auto_rag] Doc 1 score: 0.8935350775718689
[2025-03-09 14:07:07,778] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng\nNội dung vi phạm: Không chấp hành yêu cầu kiểm tra về chất ma túy hoặc chất kích thích khác mà pháp luật cấm sử dụng'}
[2025-03-09 14:07:07,778] INFO [reasoning.auto_rag] Doc 2 score: 0.8692053556442261
[2025-03-09 14:07:07,778] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'ô tô', 'fine_amount': 'Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng\nNội dung vi phạm: Không chấp hành yêu cầu kiểm tra về chất ma túy hoặc chất kích thích khác mà pháp luật cấm sử dụng'}
[2025-03-09 14:07:07,778] INFO [reasoning.auto_rag] Doc 3 score: 0.8536984324455261
[2025-03-09 14:07:07,778] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:07:07,778] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 30.000.000 đồng đến 40.000.000 đồng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 30.000.000 đồng đến 40.000.000 đồng\nNội dung vi phạm: Không chấp hành yêu cầu kiểm tra về chất ma túy hoặc chất kích thích khác mà pháp luật cấm sử dụng của người thi hành công vụ'}
[2025-03-09 14:07:07,778] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 14:07:07,779] INFO [reasoning.auto_rag] Context length: 1333 characters
[2025-03-09 14:07:07,779] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:07:07,779] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:07:07,779] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 14:07:07,779] INFO [retrieval.query_simplifier] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:07:07,780] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:07:07,780] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:07:07,780] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:07:07,780] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 14:07:07,780] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query standardization
[2025-03-09 14:07:07,780] INFO [__main__] Initializing web search integration
[2025-03-09 14:07:07,780] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 14:07:07,780] INFO [__main__] Components initialized successfully
[2025-03-09 14:07:07,780] INFO [reasoning.auto_rag] Input tokens: 682
[2025-03-09 14:07:11,321] INFO [httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-03-09 14:07:11,329] INFO [reasoning.auto_rag] Output tokens: 200
[2025-03-09 14:07:11,329] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 14:07:11,330] INFO [reasoning.auto_rag] Need more information, next query: Tìm kiếm thông tin về mức phạt cho xe máy khi không mang giấy tờ và vi phạm nồng độ cồn.
[2025-03-09 14:07:11,330] INFO [reasoning.auto_rag] Iteration 2: Retrieving documents for query: Tìm kiếm thông tin về mức phạt cho xe máy khi không mang giấy tờ và vi phạm nồng độ cồn.
[2025-03-09 14:07:11,331] INFO [reasoning.auto_rag] Tokenized query: tìm_kiếm thông_tin về mức phạt cho xe_máy khi không mang giấy_tờ và vi_phạm nồng_độ cồn .
[2025-03-09 14:07:11,331] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 14:07:11,332] INFO [retrieval.retriever] Original query: 'Tìm kiếm thông tin về mức phạt cho xe máy khi không mang giấy tờ và vi phạm nồng độ cồn.'
[2025-03-09 14:07:11,332] INFO [retrieval.retriever] Tokenized query: 'tìm_kiếm thông_tin về mức phạt cho xe_máy khi không mang giấy_tờ và vi_phạm nồng_độ cồn .'
[2025-03-09 14:07:12,087] INFO [retrieval.retriever] Retrieved 6 documents for query
[2025-03-09 14:07:12,088] INFO [retrieval.retriever] Top result score: 0.909721851348877
[2025-03-09 14:07:12,089] INFO [retrieval.retriever] Score range: 0.5595769286155701 to 0.909721851348877
[2025-03-09 14:07:12,090] INFO [reasoning.auto_rag] DocumentRetriever returned 6 documents
[2025-03-09 14:07:12,090] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 14:07:12,090] INFO [reasoning.auto_rag] Doc 1 score: 0.909721851348877
[2025-03-09 14:07:12,090] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'ô tô', 'fine_amount': 'Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng\nNội dung vi phạm: Không chấp hành yêu cầu kiểm tra về chất ma túy hoặc chất kích thích khác mà pháp luật cấm sử dụng'}
[2025-03-09 14:07:12,091] INFO [reasoning.auto_rag] Doc 2 score: 0.8923325538635254
[2025-03-09 14:07:12,091] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng\nNội dung vi phạm: Không chấp hành yêu cầu kiểm tra về chất ma túy hoặc chất kích thích khác mà pháp luật cấm sử dụng'}
[2025-03-09 14:07:12,091] INFO [reasoning.auto_rag] Doc 3 score: 0.8740582466125488
[2025-03-09 14:07:12,092] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 30.000.000 đồng đến 40.000.000 đồng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 30.000.000 đồng đến 40.000.000 đồng\nNội dung vi phạm: Không chấp hành yêu cầu kiểm tra về chất ma túy hoặc chất kích thích khác mà pháp luật cấm sử dụng của người thi hành công vụ'}
[2025-03-09 14:07:12,092] INFO [reasoning.auto_rag] Context length: 2637 characters
[2025-03-09 14:07:12,095] INFO [reasoning.auto_rag] Input tokens: 1094
[2025-03-09 14:07:15,048] INFO [httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-03-09 14:07:15,053] INFO [reasoning.auto_rag] Output tokens: 205
[2025-03-09 14:07:15,054] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 14:07:15,055] INFO [reasoning.auto_rag] Need more information, next query: Tìm kiếm thông tin về mức phạt cho việc không mang giấy tờ đối với xe máy.
[2025-03-09 14:07:15,056] WARNING [reasoning.auto_rag] Exiting loop without sufficient information
[2025-03-09 14:07:15,057] INFO [utils] Function process_question completed in 11.21 seconds
[2025-03-09 14:07:15,059] INFO [__main__] Question processed in 11.21 seconds
[2025-03-09 14:07:15,060] INFO [__main__] Needs web search: True
[2025-03-09 14:07:15,060] INFO [__main__] Web search prompt triggered
[2025-03-09 14:07:15,060] INFO [__main__] Displaying results
[2025-03-09 14:07:15,061] INFO [__main__] Response generated using: OpenAI GPT-4o mini
[2025-03-09 14:07:15,067] INFO [__main__] Query standardized from 'Vào 1 ngày đẹp trời chủ nhất, bạn Đạt đi uống 1 thùng bia và lái xe máy SH 350i của Ý không mang theo giấy tờ thì bị phạt như thế nào?' to 'Đối với xe máy, vi phạm không mang giấy tờ và vi phạm nồng độ cồn sẽ bị xử phạt như thế nào?'
[2025-03-09 14:07:15,075] INFO [__main__] Cleaning up components
[2025-03-09 14:07:15,076] INFO [retrieval.vector_store] Closing Weaviate client connection
[2025-03-09 14:07:15,081] INFO [retrieval.vector_store] Weaviate client connection closed
[2025-03-09 14:07:15,083] INFO [__main__] Displaying web search prompt
[2025-03-09 14:08:45,210] INFO [__main__] Starting application
[2025-03-09 14:08:45,214] INFO [__main__] Selected LLM provider: openai
[2025-03-09 14:08:45,215] INFO [__main__] Query simplification enabled: True
[2025-03-09 14:08:45,216] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 14:08:45,217] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 14:08:45,217] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 14:08:45,219] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 14:08:45,357] INFO [__main__] Starting application
[2025-03-09 14:08:45,361] INFO [__main__] Selected LLM provider: openai
[2025-03-09 14:08:45,361] INFO [__main__] Query simplification enabled: True
[2025-03-09 14:08:45,362] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 14:08:45,363] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 14:08:45,363] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 14:08:45,363] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 14:08:45,764] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 14:08:45,871] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 14:08:46,005] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 14:08:46,010] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 14:08:46,010] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 14:08:46,010] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:08:46,013] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:08:46,115] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 14:08:46,120] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 14:08:46,120] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 14:08:46,120] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:08:46,121] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:08:51,617] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 14:08:51,954] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 14:08:51,958] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 14:08:51,958] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=10
[2025-03-09 14:08:52,942] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 14:08:53,259] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 14:08:53,261] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 14:08:53,262] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=10
[2025-03-09 14:08:54,171] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:08:54,171] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 14:08:54,171] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:08:54,171] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:08:54,171] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 14:08:54,171] INFO [retrieval.query_simplifier] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:08:54,172] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:08:54,172] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:08:54,172] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:08:54,172] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 14:08:54,172] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query standardization
[2025-03-09 14:08:54,172] INFO [__main__] Initializing web search integration
[2025-03-09 14:08:54,172] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 14:08:54,172] INFO [__main__] Components initialized successfully
[2025-03-09 14:08:55,718] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:08:55,718] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 14:08:55,718] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:08:55,718] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:08:55,719] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 14:08:55,719] INFO [retrieval.query_simplifier] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:08:55,719] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:08:55,719] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:08:55,720] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:08:55,720] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 14:08:55,720] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query standardization
[2025-03-09 14:08:55,720] INFO [__main__] Initializing web search integration
[2025-03-09 14:08:55,720] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 14:08:55,720] INFO [__main__] Components initialized successfully
[2025-03-09 14:08:55,722] INFO [__main__] Processing new question: Đạt lái xe SH rất sang chở bạn gái nhưng xe này không có giấy tờ thì sẽ bị phạt bao nhiêu tiền?
[2025-03-09 14:08:55,723] INFO [__main__] Using enhanced AutoRAG with query simplification
[2025-03-09 14:08:55,723] INFO [__main__] Processing question: Đạt lái xe SH rất sang chở bạn gái nhưng xe này không có giấy tờ thì sẽ bị phạt bao nhiêu tiền?
[2025-03-09 14:08:55,724] INFO [reasoning.enhanced_autorag] Processing question via standardized flow: Đạt lái xe SH rất sang chở bạn gái nhưng xe này không có giấy tờ thì sẽ bị phạt bao nhiêu tiền?
[2025-03-09 14:08:55,724] INFO [retrieval.query_simplifier] Standardizing query: Đạt lái xe SH rất sang chở bạn gái nhưng xe này không có giấy tờ thì sẽ bị phạt bao nhiêu tiền?
[2025-03-09 14:08:57,118] INFO [httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-03-09 14:08:57,123] INFO [retrieval.query_simplifier] Successfully standardized query: 'Đối với xe máy, vi phạm không có giấy tờ sẽ bị xử phạt như thế nào?'
[2025-03-09 14:08:57,124] INFO [retrieval.query_simplifier] Detected violations: ['không có giấy tờ']
[2025-03-09 14:08:57,124] INFO [retrieval.query_simplifier] Vehicle type: xe máy
[2025-03-09 14:08:57,124] INFO [retrieval.query_simplifier] Penalty types: ['tiền phạt']
[2025-03-09 14:08:57,124] INFO [reasoning.enhanced_autorag] Original query: 'Đạt lái xe SH rất sang chở bạn gái nhưng xe này không có giấy tờ thì sẽ bị phạt bao nhiêu tiền?'
[2025-03-09 14:08:57,124] INFO [reasoning.enhanced_autorag] Standardized query: 'Đối với xe máy, vi phạm không có giấy tờ sẽ bị xử phạt như thế nào?'
[2025-03-09 14:08:57,125] INFO [reasoning.enhanced_autorag] Query metadata: {'violations': ['không có giấy tờ'], 'vehicle_type': 'xe máy', 'penalty_types': ['tiền phạt']}
[2025-03-09 14:08:57,125] INFO [reasoning.auto_rag] Question validated as traffic-related via keyword: phạt
[2025-03-09 14:08:57,125] INFO [reasoning.auto_rag] Iteration 1: Retrieving documents for query: Đối với xe máy, vi phạm không có giấy tờ sẽ bị xử phạt như thế nào?
[2025-03-09 14:08:57,126] INFO [reasoning.auto_rag] Tokenized query: đối_với xe_máy , vi_phạm không có giấy_tờ sẽ bị xử_phạt như thế_nào ?
[2025-03-09 14:08:57,127] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 14:08:57,128] INFO [retrieval.retriever] Original query: 'Đối với xe máy, vi phạm không có giấy tờ sẽ bị xử phạt như thế nào?'
[2025-03-09 14:08:57,128] INFO [retrieval.retriever] Tokenized query: 'đối_với xe_máy , vi_phạm không có giấy_tờ sẽ bị xử_phạt như thế_nào ?'
[2025-03-09 14:08:58,199] INFO [retrieval.retriever] Retrieved 6 documents for query
[2025-03-09 14:08:58,199] INFO [retrieval.retriever] Top result score: 0.8444406986236572
[2025-03-09 14:08:58,199] INFO [retrieval.retriever] Score range: 0.6874221563339233 to 0.8444406986236572
[2025-03-09 14:08:58,199] INFO [reasoning.auto_rag] DocumentRetriever returned 6 documents
[2025-03-09 14:08:58,200] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 14:08:58,200] INFO [reasoning.auto_rag] Doc 1 score: 0.8444406986236572
[2025-03-09 14:08:58,200] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Phạt tiền từ 4.000.000 đồng đến 6.000.000 đồng', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Phạt tiền từ 4.000.000 đồng đến 6.000.000 đồng\nNội dung vi phạm: Gắn biển số không đúng với chứng nhận đăng ký xe hoặc gắn biển số không do cơ quan có thẩm quyền cấp'}
[2025-03-09 14:08:58,200] INFO [reasoning.auto_rag] Doc 2 score: 0.7836532592773438
[2025-03-09 14:08:58,200] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 18.000.000 đồng đến 20.000.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 18.000.000 đồng đến 20.000.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không có giấy phép lái xe hoặc sử dụng giấy phép lái xe đã bị trừ hết điểm'}
[2025-03-09 14:08:58,200] INFO [reasoning.auto_rag] Doc 3 score: 0.6939559578895569
[2025-03-09 14:08:58,200] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Trừ điểm giấy phép lái xe 06 điểm', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Trừ điểm giấy phép lái xe 06 điểm\nNội dung vi phạm: Gắn biển số không đúng với chứng nhận đăng ký xe hoặc gắn biển số không do cơ quan có thẩm quyền cấp'}
[2025-03-09 14:08:58,201] INFO [reasoning.auto_rag] Context length: 1388 characters
[2025-03-09 14:08:58,203] INFO [reasoning.auto_rag] Input tokens: 715
[2025-03-09 14:09:00,970] INFO [httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-03-09 14:09:00,974] INFO [reasoning.auto_rag] Output tokens: 210
[2025-03-09 14:09:00,974] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 14:09:00,975] INFO [reasoning.auto_rag] Need more information, next query: Tìm kiếm thông tin về mức phạt đối với xe máy khi không có giấy tờ (giấy đăng ký xe hoặc giấy phép lái xe).
[2025-03-09 14:09:00,975] INFO [reasoning.auto_rag] Iteration 2: Retrieving documents for query: Tìm kiếm thông tin về mức phạt đối với xe máy khi không có giấy tờ (giấy đăng ký xe hoặc giấy phép lái xe).
[2025-03-09 14:09:00,976] INFO [reasoning.auto_rag] Tokenized query: tìm_kiếm thông_tin về mức phạt đối_với xe_máy khi không có giấy_tờ ( giấy đăng_ký xe hoặc giấy_phép lái_xe ) .
[2025-03-09 14:09:00,976] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 14:09:00,977] INFO [retrieval.retriever] Original query: 'Tìm kiếm thông tin về mức phạt đối với xe máy khi không có giấy tờ (giấy đăng ký xe hoặc giấy phép lái xe).'
[2025-03-09 14:09:00,977] INFO [retrieval.retriever] Tokenized query: 'tìm_kiếm thông_tin về mức phạt đối_với xe_máy khi không có giấy_tờ ( giấy đăng_ký xe hoặc giấy_phép lái_xe ) .'
[2025-03-09 14:09:01,809] INFO [retrieval.retriever] Retrieved 6 documents for query
[2025-03-09 14:09:01,809] INFO [retrieval.retriever] Top result score: 0.7725182771682739
[2025-03-09 14:09:01,810] INFO [retrieval.retriever] Score range: 0.6628807187080383 to 0.7725182771682739
[2025-03-09 14:09:01,810] INFO [reasoning.auto_rag] DocumentRetriever returned 6 documents
[2025-03-09 14:09:01,811] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 14:09:01,811] INFO [reasoning.auto_rag] Doc 1 score: 0.7725182771682739
[2025-03-09 14:09:01,811] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'ô tô', 'fine_amount': 'Trừ 2 điểm giấy phép lái xe - Điều kiện phương tiện', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Trừ 2 điểm giấy phép lái xe - Điều kiện phương tiện\nNội dung vi phạm: Không có chứng nhận đăng ký xe/hết hạn/hết hiệu lực'}
[2025-03-09 14:09:01,811] INFO [reasoning.auto_rag] Doc 2 score: 0.768312931060791
[2025-03-09 14:09:01,811] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 300.000 đồng đến 400.000 đồng - Điều kiện người lái xe\nNội dung vi phạm: Không mang theo chứng nhận đăng ký xe'}
[2025-03-09 14:09:01,812] INFO [reasoning.auto_rag] Doc 3 score: 0.7068467736244202
[2025-03-09 14:09:01,812] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Phạt tiền từ 2.000.000 đồng đến 3.000.000 đồng', 'violation_type': 'giấy_tờ', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Phạt tiền từ 2.000.000 đồng đến 3.000.000 đồng\nNội dung vi phạm: Điều khiển xe không có chứng nhận đăng ký xe hoặc sử dụng chứng nhận đăng ký xe đã hết hạn sử dụng'}
[2025-03-09 14:09:01,812] INFO [reasoning.auto_rag] Context length: 2578 characters
[2025-03-09 14:09:01,815] INFO [reasoning.auto_rag] Input tokens: 1095
[2025-03-09 14:09:05,232] INFO [httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-03-09 14:09:05,237] INFO [reasoning.auto_rag] Output tokens: 198
[2025-03-09 14:09:05,237] INFO [reasoning.auto_rag] Decision: Đã đủ thông tin
[2025-03-09 14:09:05,238] INFO [reasoning.auto_rag] Found sufficient information, returning final answer
[2025-03-09 14:09:05,239] INFO [utils] Function process_question completed in 9.52 seconds
[2025-03-09 14:09:05,241] INFO [__main__] Question processed in 9.52 seconds
[2025-03-09 14:09:05,242] INFO [__main__] Needs web search: False
[2025-03-09 14:09:05,243] INFO [__main__] Displaying results
[2025-03-09 14:09:05,245] INFO [__main__] Response generated using: OpenAI GPT-4o mini
[2025-03-09 14:09:05,256] INFO [__main__] Query standardized from 'Đạt lái xe SH rất sang chở bạn gái nhưng xe này không có giấy tờ thì sẽ bị phạt bao nhiêu tiền?' to 'Đối với xe máy, vi phạm không có giấy tờ sẽ bị xử phạt như thế nào?'
[2025-03-09 14:09:05,268] INFO [__main__] Cleaning up components
[2025-03-09 14:09:05,269] INFO [retrieval.vector_store] Closing Weaviate client connection
[2025-03-09 14:09:05,279] INFO [retrieval.vector_store] Weaviate client connection closed
[2025-03-09 14:10:05,949] INFO [__main__] Starting application
[2025-03-09 14:10:05,956] INFO [__main__] Selected LLM provider: openai
[2025-03-09 14:10:05,957] INFO [__main__] Query simplification enabled: True
[2025-03-09 14:10:05,958] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 14:10:05,961] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 14:10:05,963] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 14:10:05,964] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 14:10:06,091] INFO [__main__] Starting application
[2025-03-09 14:10:06,093] INFO [__main__] Selected LLM provider: openai
[2025-03-09 14:10:06,093] INFO [__main__] Query simplification enabled: True
[2025-03-09 14:10:06,093] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 14:10:06,093] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 14:10:06,093] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 14:10:06,093] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 14:10:06,469] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 14:10:06,591] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 14:10:06,697] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 14:10:06,702] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 14:10:06,703] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 14:10:06,703] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:10:06,704] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:10:06,833] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 14:10:06,837] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 14:10:06,838] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 14:10:06,838] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:10:06,841] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:10:11,218] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 14:10:11,486] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 14:10:11,491] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 14:10:11,491] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=10
[2025-03-09 14:10:11,515] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 14:10:11,793] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 14:10:11,802] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 14:10:11,802] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=10
[2025-03-09 14:10:13,486] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:10:13,486] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 14:10:13,486] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:10:13,486] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:10:13,486] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 14:10:13,486] INFO [retrieval.query_simplifier] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:10:13,487] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:10:13,487] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:10:13,487] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:10:13,487] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 14:10:13,487] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query standardization
[2025-03-09 14:10:13,487] INFO [__main__] Initializing web search integration
[2025-03-09 14:10:13,487] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 14:10:13,487] INFO [__main__] Components initialized successfully
[2025-03-09 14:10:16,957] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:10:16,957] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 14:10:16,957] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:10:16,957] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:10:16,957] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 14:10:16,957] INFO [retrieval.query_simplifier] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:10:16,957] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:10:16,958] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:10:16,958] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:10:16,958] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 14:10:16,958] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query standardization
[2025-03-09 14:10:16,958] INFO [__main__] Initializing web search integration
[2025-03-09 14:10:16,958] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 14:10:16,958] INFO [__main__] Components initialized successfully
[2025-03-09 14:10:16,959] INFO [__main__] Processing new question: Hôm qua tôi chạy xe máy 70km/h trên đường nội thành, vượt đèn đỏ và có nồng độ cồn 0.3mg/L thì bị phạt bao nhiêu?
[2025-03-09 14:10:16,959] INFO [__main__] Using enhanced AutoRAG with query simplification
[2025-03-09 14:10:16,959] INFO [__main__] Processing question: Hôm qua tôi chạy xe máy 70km/h trên đường nội thành, vượt đèn đỏ và có nồng độ cồn 0.3mg/L thì bị phạt bao nhiêu?
[2025-03-09 14:10:16,959] INFO [reasoning.enhanced_autorag] Processing question via standardized flow: Hôm qua tôi chạy xe máy 70km/h trên đường nội thành, vượt đèn đỏ và có nồng độ cồn 0.3mg/L thì bị phạt bao nhiêu?
[2025-03-09 14:10:16,959] INFO [retrieval.query_simplifier] Standardizing query: Hôm qua tôi chạy xe máy 70km/h trên đường nội thành, vượt đèn đỏ và có nồng độ cồn 0.3mg/L thì bị phạt bao nhiêu?
[2025-03-09 14:10:18,552] INFO [httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-03-09 14:10:18,557] INFO [retrieval.query_simplifier] Successfully standardized query: 'Đối với xe máy, vi phạm vượt đèn đỏ và nồng độ cồn sẽ bị xử phạt như thế nào?'
[2025-03-09 14:10:18,557] INFO [retrieval.query_simplifier] Detected violations: ['vượt đèn đỏ', 'nồng độ cồn']
[2025-03-09 14:10:18,558] INFO [retrieval.query_simplifier] Vehicle type: xe máy
[2025-03-09 14:10:18,558] INFO [retrieval.query_simplifier] Penalty types: ['tiền phạt']
[2025-03-09 14:10:18,559] INFO [reasoning.enhanced_autorag] Original query: 'Hôm qua tôi chạy xe máy 70km/h trên đường nội thành, vượt đèn đỏ và có nồng độ cồn 0.3mg/L thì bị phạt bao nhiêu?'
[2025-03-09 14:10:18,559] INFO [reasoning.enhanced_autorag] Standardized query: 'Đối với xe máy, vi phạm vượt đèn đỏ và nồng độ cồn sẽ bị xử phạt như thế nào?'
[2025-03-09 14:10:18,560] INFO [reasoning.enhanced_autorag] Query metadata: {'violations': ['vượt đèn đỏ', 'nồng độ cồn'], 'vehicle_type': 'xe máy', 'penalty_types': ['tiền phạt']}
[2025-03-09 14:10:18,560] INFO [reasoning.auto_rag] Question validated as traffic-related via keyword: phạt
[2025-03-09 14:10:18,561] INFO [reasoning.auto_rag] Iteration 1: Retrieving documents for query: Đối với xe máy, vi phạm vượt đèn đỏ và nồng độ cồn sẽ bị xử phạt như thế nào?
[2025-03-09 14:10:18,562] INFO [reasoning.auto_rag] Tokenized query: đối_với xe_máy , vi_phạm vượt đèn_đỏ và nồng_độ cồn sẽ bị xử_phạt như thế_nào ?
[2025-03-09 14:10:18,563] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 14:10:18,564] INFO [retrieval.retriever] Original query: 'Đối với xe máy, vi phạm vượt đèn đỏ và nồng độ cồn sẽ bị xử phạt như thế nào?'
[2025-03-09 14:10:18,565] INFO [retrieval.retriever] Tokenized query: 'đối_với xe_máy , vi_phạm vượt đèn_đỏ và nồng_độ cồn sẽ bị xử_phạt như thế_nào ?'
[2025-03-09 14:10:19,772] INFO [retrieval.retriever] Retrieved 6 documents for query
[2025-03-09 14:10:19,772] INFO [retrieval.retriever] Top result score: 0.8975030183792114
[2025-03-09 14:10:19,773] INFO [retrieval.retriever] Score range: 0.7178314924240112 to 0.8975030183792114
[2025-03-09 14:10:19,773] INFO [reasoning.auto_rag] DocumentRetriever returned 6 documents
[2025-03-09 14:10:19,773] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 14:10:19,773] INFO [reasoning.auto_rag] Doc 1 score: 0.8975030183792114
[2025-03-09 14:10:19,773] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 30.000.000 đồng đến 40.000.000 đồng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 30.000.000 đồng đến 40.000.000 đồng\nNội dung vi phạm: Không chấp hành yêu cầu kiểm tra về chất ma túy hoặc chất kích thích khác mà pháp luật cấm sử dụng của người thi hành công vụ'}
[2025-03-09 14:10:19,773] INFO [reasoning.auto_rag] Doc 2 score: 0.8826077580451965
[2025-03-09 14:10:19,773] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Phạt tiền từ 8.000.000 đồng đến 10.000.000 đồng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Phạt tiền từ 8.000.000 đồng đến 10.000.000 đồng\nNội dung vi phạm: Không chấp hành yêu cầu kiểm tra về chất ma túy hoặc chất kích thích khác mà pháp luật cấm sử dụng'}
[2025-03-09 14:10:19,773] INFO [reasoning.auto_rag] Doc 3 score: 0.8298786878585815
[2025-03-09 14:10:19,774] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'ô tô', 'fine_amount': 'Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng\nNội dung vi phạm: Không chấp hành yêu cầu kiểm tra về chất ma túy hoặc chất kích thích khác mà pháp luật cấm sử dụng'}
[2025-03-09 14:10:19,774] INFO [reasoning.auto_rag] Context length: 1441 characters
[2025-03-09 14:10:19,778] INFO [reasoning.auto_rag] Input tokens: 741
[2025-03-09 14:10:23,364] INFO [httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-03-09 14:10:23,367] INFO [reasoning.auto_rag] Output tokens: 208
[2025-03-09 14:10:23,367] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 14:10:23,367] INFO [reasoning.auto_rag] Need more information, next query: Tìm kiếm thông tin về mức phạt đối với xe máy khi vi phạm vượt đèn đỏ.
[2025-03-09 14:10:23,367] INFO [reasoning.auto_rag] Iteration 2: Retrieving documents for query: Tìm kiếm thông tin về mức phạt đối với xe máy khi vi phạm vượt đèn đỏ.
[2025-03-09 14:10:23,368] INFO [reasoning.auto_rag] Tokenized query: tìm_kiếm thông_tin về mức phạt đối_với xe_máy khi vi_phạm vượt đèn_đỏ .
[2025-03-09 14:10:23,368] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 14:10:23,369] INFO [retrieval.retriever] Original query: 'Tìm kiếm thông tin về mức phạt đối với xe máy khi vi phạm vượt đèn đỏ.'
[2025-03-09 14:10:23,369] INFO [retrieval.retriever] Tokenized query: 'tìm_kiếm thông_tin về mức phạt đối_với xe_máy khi vi_phạm vượt đèn_đỏ .'
[2025-03-09 14:10:24,138] INFO [retrieval.retriever] Retrieved 4 documents for query
[2025-03-09 14:10:24,138] INFO [retrieval.retriever] Top result score: 0.7732236385345459
[2025-03-09 14:10:24,139] INFO [retrieval.retriever] Score range: 0.6999841332435608 to 0.7732236385345459
[2025-03-09 14:10:24,140] INFO [reasoning.auto_rag] DocumentRetriever returned 4 documents
[2025-03-09 14:10:24,140] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 14:10:24,141] INFO [reasoning.auto_rag] Doc 1 score: 0.7732236385345459
[2025-03-09 14:10:24,141] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 4.000.000 đồng đến 6.000.000 đồng', 'violation_type': 'đèn_tín_hiệu', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 4.000.000 đồng đến 6.000.000 đồng\nNội dung vi phạm: Đi vào khu vực cấm, đường có biển báo hiệu có nội dung cấm đi vào đối với loại phương tiện đang điều khiển'}
[2025-03-09 14:10:24,141] INFO [reasoning.auto_rag] Doc 2 score: 0.7007184624671936
[2025-03-09 14:10:24,141] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Trừ điểm giấy phép lái xe 02 điểm', 'violation_type': 'đèn_tín_hiệu', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Trừ điểm giấy phép lái xe 02 điểm\nNội dung vi phạm: Đi vào khu vực cấm, đường có biển báo hiệu có nội dung cấm đi vào đối với loại phương tiện đang điều khiển'}
[2025-03-09 14:10:24,142] INFO [reasoning.auto_rag] Doc 3 score: 0.699999988079071
[2025-03-09 14:10:24,142] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Tịch thu phương tiện', 'violation_type': 'lái_xe_nguy_hiểm', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Tịch thu phương tiện\nNội dung vi phạm: Điều khiển xe chạy bằng một bánh đối với xe hai bánh, chạy bằng hai bánh đối với xe ba bánh'}
[2025-03-09 14:10:24,142] INFO [reasoning.auto_rag] Context length: 2286 characters
[2025-03-09 14:10:24,144] INFO [reasoning.auto_rag] Input tokens: 1006
[2025-03-09 14:10:27,358] INFO [httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-03-09 14:10:27,361] INFO [reasoning.auto_rag] Output tokens: 187
[2025-03-09 14:10:27,362] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 14:10:27,362] INFO [reasoning.auto_rag] Need more information, next query: Tìm kiếm thông tin về mức phạt cho vi phạm vượt đèn đỏ đối với xe máy.
[2025-03-09 14:10:27,362] WARNING [reasoning.auto_rag] Exiting loop without sufficient information
[2025-03-09 14:10:27,362] INFO [utils] Function process_question completed in 10.40 seconds
[2025-03-09 14:10:27,363] INFO [__main__] Question processed in 10.40 seconds
[2025-03-09 14:10:27,364] INFO [__main__] Needs web search: True
[2025-03-09 14:10:27,364] INFO [__main__] Web search prompt triggered
[2025-03-09 14:10:27,365] INFO [__main__] Displaying results
[2025-03-09 14:10:27,366] INFO [__main__] Response generated using: OpenAI GPT-4o mini
[2025-03-09 14:10:27,371] INFO [__main__] Query standardized from 'Hôm qua tôi chạy xe máy 70km/h trên đường nội thành, vượt đèn đỏ và có nồng độ cồn 0.3mg/L thì bị phạt bao nhiêu?' to 'Đối với xe máy, vi phạm vượt đèn đỏ và nồng độ cồn sẽ bị xử phạt như thế nào?'
[2025-03-09 14:10:27,373] INFO [__main__] Cleaning up components
[2025-03-09 14:10:27,373] INFO [retrieval.vector_store] Closing Weaviate client connection
[2025-03-09 14:10:27,400] INFO [retrieval.vector_store] Weaviate client connection closed
[2025-03-09 14:10:27,401] INFO [__main__] Displaying web search prompt
[2025-03-09 14:16:04,529] INFO [__main__] Starting application
[2025-03-09 14:16:04,531] INFO [__main__] Initializing configurations
[2025-03-09 14:16:04,532] INFO [__main__] Configurations initialized successfully
[2025-03-09 14:16:04,533] INFO [__main__] Selected LLM provider: openai
[2025-03-09 14:16:04,533] INFO [__main__] Query simplification enabled: True
[2025-03-09 14:16:04,533] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 14:16:04,534] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 14:16:04,534] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 14:16:04,534] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 14:16:05,333] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 14:16:05,592] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 14:16:05,594] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 14:16:05,594] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 14:16:05,595] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:16:05,597] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:16:11,945] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 14:16:12,556] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 14:16:12,712] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 14:16:12,713] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=10
[2025-03-09 14:16:14,853] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:16:14,854] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 14:16:14,854] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:16:15,013] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:16:15,013] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 14:16:15,013] INFO [retrieval.query_simplifier] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:16:15,013] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:16:15,013] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:16:15,013] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:16:15,013] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 14:16:15,013] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query standardization
[2025-03-09 14:16:15,013] INFO [__main__] Initializing web search integration
[2025-03-09 14:16:15,013] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 14:16:15,013] INFO [__main__] Components initialized successfully
[2025-03-09 14:16:31,356] INFO [__main__] Starting application
[2025-03-09 14:16:31,357] INFO [__main__] Selected LLM provider: openai
[2025-03-09 14:16:31,357] INFO [__main__] Query simplification enabled: True
[2025-03-09 14:16:31,358] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 14:16:31,358] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 14:16:31,358] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 14:16:31,358] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 14:16:31,424] INFO [__main__] Starting application
[2025-03-09 14:16:31,425] INFO [__main__] Selected LLM provider: openai
[2025-03-09 14:16:31,426] INFO [__main__] Query simplification enabled: True
[2025-03-09 14:16:31,426] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 14:16:31,426] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 14:16:31,427] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 14:16:31,427] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 14:16:31,923] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 14:16:31,981] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 14:16:32,217] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 14:16:32,219] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 14:16:32,219] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 14:16:32,219] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:16:32,221] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:16:32,226] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 14:16:32,230] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 14:16:32,230] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 14:16:32,230] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:16:32,232] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:16:38,062] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 14:16:38,778] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 14:16:38,781] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 14:16:38,781] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=10
[2025-03-09 14:16:39,082] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 14:16:39,577] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 14:16:39,588] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 14:16:39,588] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=10
[2025-03-09 14:16:40,881] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:16:40,881] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 14:16:40,882] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:16:40,882] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:16:40,882] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 14:16:40,882] INFO [retrieval.query_simplifier] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:16:40,882] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:16:40,882] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:16:40,882] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:16:40,882] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 14:16:40,882] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query standardization
[2025-03-09 14:16:40,882] INFO [__main__] Initializing web search integration
[2025-03-09 14:16:40,882] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 14:16:40,882] INFO [__main__] Components initialized successfully
[2025-03-09 14:16:40,883] INFO [__main__] Processing new question: Hôm qua tôi chạy xe máy 70km/h trên đường nội thành, vượt đèn đỏ và có nồng độ cồn 0.3mg/L thì bị phạt bao nhiêu?
[2025-03-09 14:16:40,883] INFO [__main__] Using enhanced AutoRAG with query simplification
[2025-03-09 14:16:40,884] INFO [__main__] Processing question: Hôm qua tôi chạy xe máy 70km/h trên đường nội thành, vượt đèn đỏ và có nồng độ cồn 0.3mg/L thì bị phạt bao nhiêu?
[2025-03-09 14:16:40,884] INFO [reasoning.enhanced_autorag] Processing question via standardized flow: Hôm qua tôi chạy xe máy 70km/h trên đường nội thành, vượt đèn đỏ và có nồng độ cồn 0.3mg/L thì bị phạt bao nhiêu?
[2025-03-09 14:16:40,884] INFO [retrieval.query_simplifier] Standardizing query: Hôm qua tôi chạy xe máy 70km/h trên đường nội thành, vượt đèn đỏ và có nồng độ cồn 0.3mg/L thì bị phạt bao nhiêu?
[2025-03-09 14:16:41,701] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:16:41,701] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 14:16:41,701] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:16:41,702] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:16:41,702] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 14:16:41,702] INFO [retrieval.query_simplifier] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:16:41,702] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:16:41,702] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:16:41,702] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:16:41,702] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 14:16:41,702] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query standardization
[2025-03-09 14:16:41,702] INFO [__main__] Initializing web search integration
[2025-03-09 14:16:41,702] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 14:16:41,702] INFO [__main__] Components initialized successfully
[2025-03-09 14:16:43,172] INFO [httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-03-09 14:16:43,177] INFO [retrieval.query_simplifier] Successfully standardized query: 'Đối với xe máy, vi phạm nồng độ cồn 0.3mg/L, chạy quá tốc độ trên 20km/h và vượt đèn đỏ sẽ bị xử phạt như thế nào?'
[2025-03-09 14:16:43,178] INFO [retrieval.query_simplifier] Detected violations: ['nồng độ cồn', 'chạy quá tốc độ', 'vượt đèn đỏ']
[2025-03-09 14:16:43,179] INFO [retrieval.query_simplifier] Vehicle type: xe máy
[2025-03-09 14:16:43,179] INFO [retrieval.query_simplifier] Penalty types: ['tiền phạt']
[2025-03-09 14:16:43,179] INFO [reasoning.enhanced_autorag] Original query: 'Hôm qua tôi chạy xe máy 70km/h trên đường nội thành, vượt đèn đỏ và có nồng độ cồn 0.3mg/L thì bị phạt bao nhiêu?'
[2025-03-09 14:16:43,179] INFO [reasoning.enhanced_autorag] Standardized query: 'Đối với xe máy, vi phạm nồng độ cồn 0.3mg/L, chạy quá tốc độ trên 20km/h và vượt đèn đỏ sẽ bị xử phạt như thế nào?'
[2025-03-09 14:16:43,180] INFO [reasoning.enhanced_autorag] Query metadata: {'violations': ['nồng độ cồn', 'chạy quá tốc độ', 'vượt đèn đỏ'], 'vehicle_type': 'xe máy', 'penalty_types': ['tiền phạt']}
[2025-03-09 14:16:43,180] INFO [reasoning.auto_rag] Question validated as traffic-related via keyword: phạt
[2025-03-09 14:16:43,180] INFO [reasoning.auto_rag] Iteration 1: Retrieving documents for query: Đối với xe máy, vi phạm nồng độ cồn 0.3mg/L, chạy quá tốc độ trên 20km/h và vượt đèn đỏ sẽ bị xử phạt như thế nào?
[2025-03-09 14:16:43,181] INFO [reasoning.auto_rag] Tokenized query: đối_với xe_máy , vi_phạm nồng_độ cồn 0.3 mg / l , chạy quá tốc_độ trên 20km / h và vượt đèn_đỏ sẽ bị xử_phạt như thế_nào ?
[2025-03-09 14:16:43,182] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 14:16:43,182] INFO [retrieval.retriever] Original query: 'Đối với xe máy, vi phạm nồng độ cồn 0.3mg/L, chạy quá tốc độ trên 20km/h và vượt đèn đỏ sẽ bị xử phạt như thế nào?'
[2025-03-09 14:16:43,182] INFO [retrieval.retriever] Tokenized query: 'đối_với xe_máy , vi_phạm nồng_độ cồn 0.3 mg / l , chạy quá tốc_độ trên 20km / h và vượt đèn_đỏ sẽ bị xử_phạt như thế_nào ?'
[2025-03-09 14:16:44,376] INFO [retrieval.retriever] Retrieved 6 documents for query
[2025-03-09 14:16:44,376] INFO [retrieval.retriever] Top result score: 0.8907201290130615
[2025-03-09 14:16:44,376] INFO [retrieval.retriever] Score range: 0.8019394874572754 to 0.8907201290130615
[2025-03-09 14:16:44,376] INFO [reasoning.auto_rag] DocumentRetriever returned 6 documents
[2025-03-09 14:16:44,377] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 14:16:44,377] INFO [reasoning.auto_rag] Doc 1 score: 0.8907201290130615
[2025-03-09 14:16:44,377] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Phạt tiền từ 2.000.000 đồng đến 3.000.000 đồng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Phạt tiền từ 2.000.000 đồng đến 3.000.000 đồng\nNội dung vi phạm: Điều khiển xe trên đường mà trong máu hoặc hơi thở có nồng độ cồn nhưng chưa vượt quá 50 miligam/100 mililít máu'}
[2025-03-09 14:16:44,377] INFO [reasoning.auto_rag] Doc 2 score: 0.8530930280685425
[2025-03-09 14:16:44,378] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'ô tô', 'fine_amount': 'Phạt tiền từ 18.000.000 đồng đến 20.000.000 đồng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Phạt tiền từ 18.000.000 đồng đến 20.000.000 đồng\nNội dung vi phạm: Điều khiển xe trên đường mà trong máu hoặc hơi thở có nồng độ cồn vượt quá 50 miligam đến 80 miligam/100 mililít máu hoặc vượt quá 0,25 miligam đến 0,4 miligam/1 lít khí thở'}
[2025-03-09 14:16:44,378] INFO [reasoning.auto_rag] Doc 3 score: 0.8236775398254395
[2025-03-09 14:16:44,378] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'ô tô', 'fine_amount': 'Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng', 'violation_type': 'nồng_độ_cồn', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Tước quyền sử dụng giấy phép lái xe từ 22 tháng đến 24 tháng\nNội dung vi phạm: Không chấp hành yêu cầu kiểm tra về chất ma túy hoặc chất kích thích khác mà pháp luật cấm sử dụng'}
[2025-03-09 14:16:44,379] INFO [reasoning.auto_rag] Context length: 1471 characters
[2025-03-09 14:16:44,381] INFO [reasoning.auto_rag] Input tokens: 779
[2025-03-09 14:16:48,601] INFO [httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-03-09 14:16:48,604] INFO [reasoning.auto_rag] Output tokens: 212
[2025-03-09 14:16:48,604] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 14:16:48,604] INFO [reasoning.auto_rag] Need more information, next query: Cần tìm thông tin về mức phạt cho hành vi chạy quá tốc độ trên 20km/h và vượt đèn đỏ đối với xe máy.
[2025-03-09 14:16:48,604] INFO [reasoning.auto_rag] Iteration 2: Retrieving documents for query: Cần tìm thông tin về mức phạt cho hành vi chạy quá tốc độ trên 20km/h và vượt đèn đỏ đối với xe máy.
[2025-03-09 14:16:48,605] INFO [reasoning.auto_rag] Tokenized query: cần tìm thông_tin về mức phạt cho hành_vi chạy quá tốc_độ trên 20km / h và vượt đèn_đỏ đối_với xe_máy .
[2025-03-09 14:16:48,605] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 14:16:48,606] INFO [retrieval.retriever] Original query: 'Cần tìm thông tin về mức phạt cho hành vi chạy quá tốc độ trên 20km/h và vượt đèn đỏ đối với xe máy.'
[2025-03-09 14:16:48,606] INFO [retrieval.retriever] Tokenized query: 'cần tìm thông_tin về mức phạt cho hành_vi chạy quá tốc_độ trên 20km / h và vượt đèn_đỏ đối_với xe_máy .'
[2025-03-09 14:16:49,299] INFO [retrieval.retriever] Retrieved 4 documents for query
[2025-03-09 14:16:49,300] INFO [retrieval.retriever] Top result score: 0.699999988079071
[2025-03-09 14:16:49,300] INFO [retrieval.retriever] Score range: 0.6287956833839417 to 0.699999988079071
[2025-03-09 14:16:49,300] INFO [reasoning.auto_rag] DocumentRetriever returned 4 documents
[2025-03-09 14:16:49,300] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 14:16:49,301] INFO [reasoning.auto_rag] Doc 1 score: 0.699999988079071
[2025-03-09 14:16:49,301] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Tịch thu phương tiện', 'violation_type': 'lái_xe_nguy_hiểm', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Tịch thu phương tiện\nNội dung vi phạm: Điều khiển xe chạy bằng một bánh đối với xe hai bánh, chạy bằng hai bánh đối với xe ba bánh'}
[2025-03-09 14:16:49,301] INFO [reasoning.auto_rag] Doc 2 score: 0.6811524629592896
[2025-03-09 14:16:49,301] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Trừ điểm giấy phép lái xe 04 điểm', 'violation_type': 'tốc_độ', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Trừ điểm giấy phép lái xe 04 điểm\nNội dung vi phạm: Điều khiển xe chạy quá tốc độ quy định trên 20 km/h'}
[2025-03-09 14:16:49,301] INFO [reasoning.auto_rag] Doc 3 score: 0.6492168307304382
[2025-03-09 14:16:49,302] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'ô tô', 'fine_amount': 'Trừ 04 điểm giấy phép lái xe', 'violation_type': 'tốc_độ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Trừ 04 điểm giấy phép lái xe\nNội dung vi phạm: Điều khiển xe chạy quá tốc độ quy định trên 20 km/h đến 35 km/h'}
[2025-03-09 14:16:49,302] INFO [reasoning.auto_rag] Context length: 2149 characters
[2025-03-09 14:16:49,304] INFO [reasoning.auto_rag] Input tokens: 1009
[2025-03-09 14:16:56,485] INFO [httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-03-09 14:16:56,490] INFO [reasoning.auto_rag] Output tokens: 307
[2025-03-09 14:16:56,490] INFO [reasoning.auto_rag] Decision: Cần thêm thông tin
[2025-03-09 14:16:56,490] INFO [reasoning.auto_rag] Need more information, next query: Cần tìm thông tin về mức phạt cho vi phạm nồng độ cồn 0.3mg/L đối với xe máy và mức phạt cho hành vi vượt đèn đỏ.
[2025-03-09 14:16:56,491] WARNING [reasoning.auto_rag] Exiting loop without sufficient information
[2025-03-09 14:16:56,491] INFO [utils] Function process_question completed in 15.61 seconds
[2025-03-09 14:16:56,492] INFO [__main__] Question processed in 15.61 seconds
[2025-03-09 14:16:56,493] INFO [__main__] Needs web search: True
[2025-03-09 14:16:56,494] INFO [__main__] Web search prompt triggered
[2025-03-09 14:16:56,494] INFO [__main__] Displaying results
[2025-03-09 14:16:56,495] INFO [__main__] Response generated using: OpenAI GPT-4o mini
[2025-03-09 14:16:56,505] INFO [__main__] Query standardized from 'Hôm qua tôi chạy xe máy 70km/h trên đường nội thành, vượt đèn đỏ và có nồng độ cồn 0.3mg/L thì bị phạt bao nhiêu?' to 'Đối với xe máy, vi phạm nồng độ cồn 0.3mg/L, chạy quá tốc độ trên 20km/h và vượt đèn đỏ sẽ bị xử phạt như thế nào?'
[2025-03-09 14:16:56,512] INFO [__main__] Cleaning up components
[2025-03-09 14:16:56,512] INFO [retrieval.vector_store] Closing Weaviate client connection
[2025-03-09 14:16:56,521] INFO [retrieval.vector_store] Weaviate client connection closed
[2025-03-09 14:16:56,524] INFO [__main__] Displaying web search prompt
[2025-03-09 14:17:12,005] INFO [__main__] Starting application
[2025-03-09 14:17:12,009] INFO [__main__] Selected LLM provider: openai
[2025-03-09 14:17:12,010] INFO [__main__] Query simplification enabled: True
[2025-03-09 14:17:12,011] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 14:17:12,012] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 14:17:12,013] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 14:17:12,014] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 14:17:12,142] INFO [__main__] Starting application
[2025-03-09 14:17:12,146] INFO [__main__] Selected LLM provider: openai
[2025-03-09 14:17:12,146] INFO [__main__] Query simplification enabled: True
[2025-03-09 14:17:12,146] INFO [__main__] Initializing components with LLM provider: openai
[2025-03-09 14:17:12,146] INFO [retrieval.vector_store] Initializing connection to Weaviate at https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud
[2025-03-09 14:17:12,146] INFO [retrieval.vector_store] Using collection: ND168
[2025-03-09 14:17:12,147] INFO [retrieval.vector_store] Creating new Weaviate client connection
[2025-03-09 14:17:12,665] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 14:17:12,687] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/meta "HTTP/1.1 200 OK"
[2025-03-09 14:17:12,972] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 14:17:12,975] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 14:17:12,978] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 14:17:12,978] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 14:17:12,979] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:17:12,980] INFO [retrieval.vector_store] Collection exists: True
[2025-03-09 14:17:12,981] INFO [retrieval.vector_store] Successfully connected to Weaviate
[2025-03-09 14:17:12,982] INFO [retrieval.vector_store] Loading embedding model: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:17:12,985] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:17:12,986] INFO [sentence_transformers.SentenceTransformer] Load pretrained SentenceTransformer: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:17:17,684] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 14:17:17,990] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 14:17:17,994] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 14:17:17,994] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=10
[2025-03-09 14:17:19,121] INFO [sentence_transformers.SentenceTransformer] 2 prompts are loaded, with the keys: ['query', 'text']
[2025-03-09 14:17:19,732] INFO [httpx] HTTP Request: GET https://eypxka08rk6gbnyt57idzq.c0.us-west3.gcp.weaviate.cloud/v1/schema/ND168 "HTTP/1.1 200 OK"
[2025-03-09 14:17:19,737] INFO [retrieval.vector_store] Successfully initialized vector store and index for collection ND168
[2025-03-09 14:17:19,738] INFO [retrieval.retriever] Retriever setup complete with similarity_top_k=10
[2025-03-09 14:17:20,879] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:17:20,880] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 14:17:20,880] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:17:20,880] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:17:20,880] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 14:17:20,880] INFO [retrieval.query_simplifier] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:17:20,880] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:17:20,880] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:17:20,880] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:17:20,880] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 14:17:20,880] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query standardization
[2025-03-09 14:17:20,880] INFO [__main__] Initializing web search integration
[2025-03-09 14:17:20,880] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 14:17:20,880] INFO [__main__] Components initialized successfully
[2025-03-09 14:17:22,424] INFO [retrieval.search_pipline] Initialized CrossEncoder with model: dangvantuan/vietnamese-document-embedding
[2025-03-09 14:17:22,424] INFO [retrieval.search_pipline] Initialized SearchPipeline
[2025-03-09 14:17:22,424] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:17:22,424] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:17:22,424] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 14:17:22,424] INFO [retrieval.query_simplifier] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:17:22,424] INFO [retrieval.query_simplifier] Initialized QuerySimplifier with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:17:22,424] INFO [reasoning.auto_rag] Setting up OpenAI LLM with model: gpt-4o-mini
[2025-03-09 14:17:22,424] INFO [reasoning.auto_rag] Initialized Traffic AutoRAG with LLM provider: LLMProvider.OPENAI
[2025-03-09 14:17:22,424] INFO [reasoning.auto_rag] Using basic DocumentRetriever for document retrieval
[2025-03-09 14:17:22,424] INFO [reasoning.enhanced_autorag] Initialized EnhancedAutoRAG with query standardization
[2025-03-09 14:17:22,424] INFO [__main__] Initializing web search integration
[2025-03-09 14:17:22,424] INFO [web_handle.web_search] Initialized WebSearchIntegrator
[2025-03-09 14:17:22,424] INFO [__main__] Components initialized successfully
[2025-03-09 14:17:22,425] INFO [__main__] Processing new question: Hôm qua tôi chạy xe máy 70km/h trên đường nội thành thì bị phạt bao nhiêu?
[2025-03-09 14:17:22,426] INFO [__main__] Using enhanced AutoRAG with query simplification
[2025-03-09 14:17:22,426] INFO [__main__] Processing question: Hôm qua tôi chạy xe máy 70km/h trên đường nội thành thì bị phạt bao nhiêu?
[2025-03-09 14:17:22,426] INFO [reasoning.enhanced_autorag] Processing question via standardized flow: Hôm qua tôi chạy xe máy 70km/h trên đường nội thành thì bị phạt bao nhiêu?
[2025-03-09 14:17:22,426] INFO [retrieval.query_simplifier] Standardizing query: Hôm qua tôi chạy xe máy 70km/h trên đường nội thành thì bị phạt bao nhiêu?
[2025-03-09 14:17:23,931] INFO [httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-03-09 14:17:23,935] INFO [retrieval.query_simplifier] Successfully standardized query: 'Đối với xe máy, vi phạm chạy quá tốc độ trên 20km/h sẽ bị xử phạt như thế nào?'
[2025-03-09 14:17:23,935] INFO [retrieval.query_simplifier] Detected violations: ['chạy quá tốc độ']
[2025-03-09 14:17:23,936] INFO [retrieval.query_simplifier] Vehicle type: xe máy
[2025-03-09 14:17:23,936] INFO [retrieval.query_simplifier] Penalty types: ['tiền phạt']
[2025-03-09 14:17:23,937] INFO [reasoning.enhanced_autorag] Original query: 'Hôm qua tôi chạy xe máy 70km/h trên đường nội thành thì bị phạt bao nhiêu?'
[2025-03-09 14:17:23,938] INFO [reasoning.enhanced_autorag] Standardized query: 'Đối với xe máy, vi phạm chạy quá tốc độ trên 20km/h sẽ bị xử phạt như thế nào?'
[2025-03-09 14:17:23,938] INFO [reasoning.enhanced_autorag] Query metadata: {'violations': ['chạy quá tốc độ'], 'vehicle_type': 'xe máy', 'penalty_types': ['tiền phạt']}
[2025-03-09 14:17:23,938] INFO [reasoning.auto_rag] Question validated as traffic-related via keyword: phạt
[2025-03-09 14:17:23,939] INFO [reasoning.auto_rag] Iteration 1: Retrieving documents for query: Đối với xe máy, vi phạm chạy quá tốc độ trên 20km/h sẽ bị xử phạt như thế nào?
[2025-03-09 14:17:23,940] INFO [reasoning.auto_rag] Tokenized query: đối_với xe_máy , vi_phạm chạy quá tốc_độ trên 20km / h sẽ bị xử_phạt như thế_nào ?
[2025-03-09 14:17:23,941] INFO [reasoning.auto_rag] Using basic DocumentRetriever for retrieval
[2025-03-09 14:17:23,942] INFO [retrieval.retriever] Original query: 'Đối với xe máy, vi phạm chạy quá tốc độ trên 20km/h sẽ bị xử phạt như thế nào?'
[2025-03-09 14:17:23,943] INFO [retrieval.retriever] Tokenized query: 'đối_với xe_máy , vi_phạm chạy quá tốc_độ trên 20km / h sẽ bị xử_phạt như thế_nào ?'
[2025-03-09 14:17:25,106] INFO [retrieval.retriever] Retrieved 5 documents for query
[2025-03-09 14:17:25,106] INFO [retrieval.retriever] Top result score: 0.7939274311065674
[2025-03-09 14:17:25,106] INFO [retrieval.retriever] Score range: 0.699999988079071 to 0.7939274311065674
[2025-03-09 14:17:25,106] INFO [reasoning.auto_rag] DocumentRetriever returned 5 documents
[2025-03-09 14:17:25,107] INFO [reasoning.auto_rag] Retrieved document details:
[2025-03-09 14:17:25,107] INFO [reasoning.auto_rag] Doc 1 score: 0.7939274311065674
[2025-03-09 14:17:25,107] INFO [reasoning.auto_rag] Doc 1 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Trừ điểm giấy phép lái xe 04 điểm', 'violation_type': 'tốc_độ', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Trừ điểm giấy phép lái xe 04 điểm\nNội dung vi phạm: Điều khiển xe chạy quá tốc độ quy định trên 20 km/h'}
[2025-03-09 14:17:25,108] INFO [reasoning.auto_rag] Doc 2 score: 0.7754488587379456
[2025-03-09 14:17:25,108] INFO [reasoning.auto_rag] Doc 2 metadata: {'category': 'mô tô, gắn máy', 'fine_amount': 'Phạt tiền từ 6.000.000 đồng đến 8.000.000 đồng', 'violation_type': 'tốc_độ', 'original_text': 'Loại phương tiện: mô tô, gắn máy\nMức phạt: Phạt tiền từ 6.000.000 đồng đến 8.000.000 đồng\nNội dung vi phạm: Điều khiển xe chạy quá tốc độ quy định trên 20 km/h'}
[2025-03-09 14:17:25,108] INFO [reasoning.auto_rag] Doc 3 score: 0.7713791131973267
[2025-03-09 14:17:25,108] INFO [reasoning.auto_rag] Doc 3 metadata: {'category': 'ô tô', 'fine_amount': 'Trừ 04 điểm giấy phép lái xe', 'violation_type': 'tốc_độ', 'original_text': 'Loại phương tiện: ô tô\nMức phạt: Trừ 04 điểm giấy phép lái xe\nNội dung vi phạm: Điều khiển xe chạy quá tốc độ quy định trên 20 km/h đến 35 km/h'}
[2025-03-09 14:17:25,109] INFO [reasoning.auto_rag] Context length: 850 characters
[2025-03-09 14:17:25,110] INFO [reasoning.auto_rag] Input tokens: 553
[2025-03-09 14:17:27,923] INFO [httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-03-09 14:17:27,927] INFO [reasoning.auto_rag] Output tokens: 169
[2025-03-09 14:17:27,927] INFO [reasoning.auto_rag] Decision: Đã đủ thông tin
[2025-03-09 14:17:27,927] INFO [reasoning.auto_rag] Found sufficient information, returning final answer
[2025-03-09 14:17:27,928] INFO [utils] Function process_question completed in 5.50 seconds
[2025-03-09 14:17:27,928] INFO [__main__] Question processed in 5.50 seconds
[2025-03-09 14:17:27,929] INFO [__main__] Needs web search: False
[2025-03-09 14:17:27,930] INFO [__main__] Displaying results
[2025-03-09 14:17:27,933] INFO [__main__] Response generated using: OpenAI GPT-4o mini
[2025-03-09 14:17:27,941] INFO [__main__] Query standardized from 'Hôm qua tôi chạy xe máy 70km/h trên đường nội thành thì bị phạt bao nhiêu?' to 'Đối với xe máy, vi phạm chạy quá tốc độ trên 20km/h sẽ bị xử phạt như thế nào?'
[2025-03-09 14:17:27,954] INFO [__main__] Cleaning up components
[2025-03-09 14:17:27,954] INFO [retrieval.vector_store] Closing Weaviate client connection
[2025-03-09 14:17:27,967] INFO [retrieval.vector_store] Weaviate client connection closed
